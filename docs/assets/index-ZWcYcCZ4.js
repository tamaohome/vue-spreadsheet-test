(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const w of h)if(w.type==="childList")for(const L of w.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&s(L)}).observe(document,{childList:!0,subtree:!0});function o(h){const w={};return h.integrity&&(w.integrity=h.integrity),h.referrerPolicy&&(w.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?w.credentials="include":h.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function s(h){if(h.ep)return;h.ep=!0;const w=o(h);fetch(h.href,w)}})();/**
* @vue/shared v3.4.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(e,n){const o=new Set(e.split(","));return n?s=>o.has(s.toLowerCase()):s=>o.has(s)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),isModelListener=e=>e.startsWith("onUpdate:"),extend=Object.assign,remove=(e,n)=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(e,n)=>hasOwnProperty$1.call(e,n),isArray=Array.isArray,isMap=e=>toTypeString(e)==="[object Map]",isSet=e=>toTypeString(e)==="[object Set]",isFunction=e=>typeof e=="function",isString=e=>typeof e=="string",isSymbol=e=>typeof e=="symbol",isObject=e=>e!==null&&typeof e=="object",isPromise=e=>(isObject(e)||isFunction(e))&&isFunction(e.then)&&isFunction(e.catch),objectToString=Object.prototype.toString,toTypeString=e=>objectToString.call(e),toRawType=e=>toTypeString(e).slice(8,-1),isPlainObject=e=>toTypeString(e)==="[object Object]",isIntegerKey=e=>isString(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=e=>{const n=Object.create(null);return o=>n[o]||(n[o]=e(o))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(e=>e.replace(camelizeRE,(n,o)=>o?o.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(e=>e.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(e=>e.charAt(0).toUpperCase()+e.slice(1)),toHandlerKey=cacheStringFunction(e=>e?`on${capitalize(e)}`:""),hasChanged=(e,n)=>!Object.is(e,n),invokeArrayFns=(e,n)=>{for(let o=0;o<e.length;o++)e[o](n)},def=(e,n,o)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value:o})},looseToNumber=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(e){if(isArray(e)){const n={};for(let o=0;o<e.length;o++){const s=e[o],h=isString(s)?parseStringStyle(s):normalizeStyle(s);if(h)for(const w in h)n[w]=h[w]}return n}else if(isString(e)||isObject(e))return e}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(e){const n={};return e.replace(styleCommentRE,"").split(listDelimiterRE).forEach(o=>{if(o){const s=o.split(propertyDelimiterRE);s.length>1&&(n[s[0].trim()]=s[1].trim())}}),n}function normalizeClass(e){let n="";if(isString(e))n=e;else if(isArray(e))for(let o=0;o<e.length;o++){const s=normalizeClass(e[o]);s&&(n+=s+" ")}else if(isObject(e))for(const o in e)e[o]&&(n+=o+" ");return n.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(e){return!!e||e===""}/**
* @vue/reactivity v3.4.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!n&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const o=activeEffectScope;try{return activeEffectScope=this,n()}finally{activeEffectScope=o}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(n){if(this._active){let o,s;for(o=0,s=this.effects.length;o<s;o++)this.effects[o].stop();for(o=0,s=this.cleanups.length;o<s;o++)this.cleanups[o]();if(this.scopes)for(o=0,s=this.scopes.length;o<s;o++)this.scopes[o].stop(!0);if(!this.detached&&this.parent&&!n){const h=this.parent.scopes.pop();h&&h!==this&&(this.parent.scopes[this.index]=h,h.index=this.index)}this.parent=void 0,this._active=!1}}}function recordEffectScope(e,n=activeEffectScope){n&&n.active&&n.effects.push(e)}function getCurrentScope(){return activeEffectScope}let activeEffect;class ReactiveEffect{constructor(n,o,s,h){this.fn=n,this.trigger=o,this.scheduler=s,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,h)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let n=0;n<this._depsLength;n++){const o=this.deps[n];if(o.computed&&(triggerComputed(o.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(n){this._dirtyLevel=n?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let n=shouldTrack,o=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=o,shouldTrack=n}}stop(){var n;this.active&&(preCleanupEffect(this),postCleanupEffect(this),(n=this.onStop)==null||n.call(this),this.active=!1)}}function triggerComputed(e){return e.value}function preCleanupEffect(e){e._trackId++,e._depsLength=0}function postCleanupEffect(e){if(e.deps.length>e._depsLength){for(let n=e._depsLength;n<e.deps.length;n++)cleanupDepEffect(e.deps[n],e);e.deps.length=e._depsLength}}function cleanupDepEffect(e,n){const o=e.get(n);o!==void 0&&n._trackId!==o&&(e.delete(n),e.size===0&&e.cleanup())}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const e=trackStack.pop();shouldTrack=e===void 0?!0:e}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(e,n,o){if(n.get(e)!==e._trackId){n.set(e,e._trackId);const s=e.deps[e._depsLength];s!==n?(s&&cleanupDepEffect(s,e),e.deps[e._depsLength++]=n):e._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(e,n,o){pauseScheduling();for(const s of e.keys()){let h;s._dirtyLevel<n&&(h??(h=e.get(s)===s._trackId))&&(s._shouldSchedule||(s._shouldSchedule=s._dirtyLevel===0),s._dirtyLevel=n),s._shouldSchedule&&(h??(h=e.get(s)===s._trackId))&&(s.trigger(),(!s._runnings||s.allowRecurse)&&s._dirtyLevel!==2&&(s._shouldSchedule=!1,s.scheduler&&queueEffectSchedulers.push(s.scheduler)))}resetScheduling()}const createDep=(e,n)=>{const o=new Map;return o.cleanup=e,o.computed=n,o},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(e,n,o){if(shouldTrack&&activeEffect){let s=targetMap.get(e);s||targetMap.set(e,s=new Map);let h=s.get(o);h||s.set(o,h=createDep(()=>s.delete(o))),trackEffect(activeEffect,h)}}function trigger(e,n,o,s,h,w){const L=targetMap.get(e);if(!L)return;let c=[];if(n==="clear")c=[...L.values()];else if(o==="length"&&isArray(e)){const a=Number(s);L.forEach((g,D)=>{(D==="length"||!isSymbol(D)&&D>=a)&&c.push(g)})}else switch(o!==void 0&&c.push(L.get(o)),n){case"add":isArray(e)?isIntegerKey(o)&&c.push(L.get("length")):(c.push(L.get(ITERATE_KEY)),isMap(e)&&c.push(L.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray(e)||(c.push(L.get(ITERATE_KEY)),isMap(e)&&c.push(L.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(e)&&c.push(L.get(ITERATE_KEY));break}pauseScheduling();for(const a of c)a&&triggerEffects(a,4);resetScheduling()}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(isSymbol)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const e={};return["includes","indexOf","lastIndexOf"].forEach(n=>{e[n]=function(...o){const s=toRaw(this);for(let w=0,L=this.length;w<L;w++)track(s,"get",w+"");const h=s[n](...o);return h===-1||h===!1?s[n](...o.map(toRaw)):h}}),["push","pop","shift","unshift","splice"].forEach(n=>{e[n]=function(...o){pauseTracking(),pauseScheduling();const s=toRaw(this)[n].apply(this,o);return resetScheduling(),resetTracking(),s}}),e}function hasOwnProperty(e){isSymbol(e)||(e=String(e));const n=toRaw(this);return track(n,"has",e),n.hasOwnProperty(e)}class BaseReactiveHandler{constructor(n=!1,o=!1){this._isReadonly=n,this._isShallow=o}get(n,o,s){const h=this._isReadonly,w=this._isShallow;if(o==="__v_isReactive")return!h;if(o==="__v_isReadonly")return h;if(o==="__v_isShallow")return w;if(o==="__v_raw")return s===(h?w?shallowReadonlyMap:readonlyMap:w?shallowReactiveMap:reactiveMap).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(s)?n:void 0;const L=isArray(n);if(!h){if(L&&hasOwn(arrayInstrumentations,o))return Reflect.get(arrayInstrumentations,o,s);if(o==="hasOwnProperty")return hasOwnProperty}const c=Reflect.get(n,o,s);return(isSymbol(o)?builtInSymbols.has(o):isNonTrackableKeys(o))||(h||track(n,"get",o),w)?c:isRef(c)?L&&isIntegerKey(o)?c:c.value:isObject(c)?h?readonly(c):reactive(c):c}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(n=!1){super(!1,n)}set(n,o,s,h){let w=n[o];if(!this._isShallow){const a=isReadonly(w);if(!isShallow(s)&&!isReadonly(s)&&(w=toRaw(w),s=toRaw(s)),!isArray(n)&&isRef(w)&&!isRef(s))return a?!1:(w.value=s,!0)}const L=isArray(n)&&isIntegerKey(o)?Number(o)<n.length:hasOwn(n,o),c=Reflect.set(n,o,s,h);return n===toRaw(h)&&(L?hasChanged(s,w)&&trigger(n,"set",o,s):trigger(n,"add",o,s)),c}deleteProperty(n,o){const s=hasOwn(n,o);n[o];const h=Reflect.deleteProperty(n,o);return h&&s&&trigger(n,"delete",o,void 0),h}has(n,o){const s=Reflect.has(n,o);return(!isSymbol(o)||!builtInSymbols.has(o))&&track(n,"has",o),s}ownKeys(n){return track(n,"iterate",isArray(n)?"length":ITERATE_KEY),Reflect.ownKeys(n)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(n=!1){super(!0,n)}set(n,o){return!0}deleteProperty(n,o){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=e=>e,getProto=e=>Reflect.getPrototypeOf(e);function get(e,n,o=!1,s=!1){e=e.__v_raw;const h=toRaw(e),w=toRaw(n);o||(hasChanged(n,w)&&track(h,"get",n),track(h,"get",w));const{has:L}=getProto(h),c=s?toShallow:o?toReadonly:toReactive;if(L.call(h,n))return c(e.get(n));if(L.call(h,w))return c(e.get(w));e!==h&&e.get(n)}function has(e,n=!1){const o=this.__v_raw,s=toRaw(o),h=toRaw(e);return n||(hasChanged(e,h)&&track(s,"has",e),track(s,"has",h)),e===h?o.has(e):o.has(e)||o.has(h)}function size(e,n=!1){return e=e.__v_raw,!n&&track(toRaw(e),"iterate",ITERATE_KEY),Reflect.get(e,"size",e)}function add(e){e=toRaw(e);const n=toRaw(this);return getProto(n).has.call(n,e)||(n.add(e),trigger(n,"add",e,e)),this}function set(e,n){n=toRaw(n);const o=toRaw(this),{has:s,get:h}=getProto(o);let w=s.call(o,e);w||(e=toRaw(e),w=s.call(o,e));const L=h.call(o,e);return o.set(e,n),w?hasChanged(n,L)&&trigger(o,"set",e,n):trigger(o,"add",e,n),this}function deleteEntry(e){const n=toRaw(this),{has:o,get:s}=getProto(n);let h=o.call(n,e);h||(e=toRaw(e),h=o.call(n,e)),s&&s.call(n,e);const w=n.delete(e);return h&&trigger(n,"delete",e,void 0),w}function clear(){const e=toRaw(this),n=e.size!==0,o=e.clear();return n&&trigger(e,"clear",void 0,void 0),o}function createForEach(e,n){return function(s,h){const w=this,L=w.__v_raw,c=toRaw(L),a=n?toShallow:e?toReadonly:toReactive;return!e&&track(c,"iterate",ITERATE_KEY),L.forEach((g,D)=>s.call(h,a(g),a(D),w))}}function createIterableMethod(e,n,o){return function(...s){const h=this.__v_raw,w=toRaw(h),L=isMap(w),c=e==="entries"||e===Symbol.iterator&&L,a=e==="keys"&&L,g=h[e](...s),D=o?toShallow:n?toReadonly:toReactive;return!n&&track(w,"iterate",a?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:H,done:m}=g.next();return m?{value:H,done:m}:{value:c?[D(H[0]),D(H[1])]:D(H),done:m}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function createInstrumentations(){const e={get(w){return get(this,w)},get size(){return size(this)},has,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},n={get(w){return get(this,w,!1,!0)},get size(){return size(this)},has,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},o={get(w){return get(this,w,!0)},get size(){return size(this,!0)},has(w){return has.call(this,w,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},s={get(w){return get(this,w,!0,!0)},get size(){return size(this,!0)},has(w){return has.call(this,w,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(w=>{e[w]=createIterableMethod(w,!1,!1),o[w]=createIterableMethod(w,!0,!1),n[w]=createIterableMethod(w,!1,!0),s[w]=createIterableMethod(w,!0,!0)}),[e,o,n,s]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(e,n){const o=n?e?shallowReadonlyInstrumentations:shallowInstrumentations:e?readonlyInstrumentations:mutableInstrumentations;return(s,h,w)=>h==="__v_isReactive"?!e:h==="__v_isReadonly"?e:h==="__v_raw"?s:Reflect.get(hasOwn(o,h)&&h in s?o:s,h,w)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(e){return e.__v_skip||!Object.isExtensible(e)?0:targetTypeMap(toRawType(e))}function reactive(e){return isReadonly(e)?e:createReactiveObject(e,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(e){return createReactiveObject(e,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(e){return createReactiveObject(e,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(e){return createReactiveObject(e,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(e,n,o,s,h){if(!isObject(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const w=h.get(e);if(w)return w;const L=getTargetType(e);if(L===0)return e;const c=new Proxy(e,L===2?s:o);return h.set(e,c),c}function isReactive(e){return isReadonly(e)?isReactive(e.__v_raw):!!(e&&e.__v_isReactive)}function isReadonly(e){return!!(e&&e.__v_isReadonly)}function isShallow(e){return!!(e&&e.__v_isShallow)}function isProxy(e){return e?!!e.__v_raw:!1}function toRaw(e){const n=e&&e.__v_raw;return n?toRaw(n):e}function markRaw(e){return Object.isExtensible(e)&&def(e,"__v_skip",!0),e}const toReactive=e=>isObject(e)?reactive(e):e,toReadonly=e=>isObject(e)?readonly(e):e;class ComputedRefImpl{constructor(n,o,s,h){this.getter=n,this._setter=o,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>n(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!h,this.__v_isReadonly=s}get value(){const n=toRaw(this);return(!n._cacheable||n.effect.dirty)&&hasChanged(n._value,n._value=n.effect.run())&&triggerRefValue(n,4),trackRefValue(n),n.effect._dirtyLevel>=2&&triggerRefValue(n,2),n._value}set value(n){this._setter(n)}get _dirty(){return this.effect.dirty}set _dirty(n){this.effect.dirty=n}}function computed$1(e,n,o=!1){let s,h;const w=isFunction(e);return w?(s=e,h=NOOP):(s=e.get,h=e.set),new ComputedRefImpl(s,h,w||!h,o)}function trackRefValue(e){var n;shouldTrack&&activeEffect&&(e=toRaw(e),trackEffect(activeEffect,(n=e.dep)!=null?n:e.dep=createDep(()=>e.dep=void 0,e instanceof ComputedRefImpl?e:void 0)))}function triggerRefValue(e,n=4,o){e=toRaw(e);const s=e.dep;s&&triggerEffects(s,n)}function isRef(e){return!!(e&&e.__v_isRef===!0)}function ref(e){return createRef(e,!1)}function createRef(e,n){return isRef(e)?e:new RefImpl(e,n)}class RefImpl{constructor(n,o){this.__v_isShallow=o,this.dep=void 0,this.__v_isRef=!0,this._rawValue=o?n:toRaw(n),this._value=o?n:toReactive(n)}get value(){return trackRefValue(this),this._value}set value(n){const o=this.__v_isShallow||isShallow(n)||isReadonly(n);n=o?n:toRaw(n),hasChanged(n,this._rawValue)&&(this._rawValue=n,this._value=o?n:toReactive(n),triggerRefValue(this,4))}}function unref(e){return isRef(e)?e.value:e}const shallowUnwrapHandlers={get:(e,n,o)=>unref(Reflect.get(e,n,o)),set:(e,n,o,s)=>{const h=e[n];return isRef(h)&&!isRef(o)?(h.value=o,!0):Reflect.set(e,n,o,s)}};function proxyRefs(e){return isReactive(e)?e:new Proxy(e,shallowUnwrapHandlers)}/**
* @vue/runtime-core v3.4.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];function warn$1(e,...n){pauseTracking();const o=stack.length?stack[stack.length-1].component:null,s=o&&o.appContext.config.warnHandler,h=getComponentTrace();if(s)callWithErrorHandling(s,o,11,[e+n.map(w=>{var L,c;return(c=(L=w.toString)==null?void 0:L.call(w))!=null?c:JSON.stringify(w)}).join(""),o&&o.proxy,h.map(({vnode:w})=>`at <${formatComponentName(o,w.type)}>`).join(`
`),h]);else{const w=[`[Vue warn]: ${e}`,...n];h.length&&w.push(`
`,...formatTrace(h)),console.warn(...w)}resetTracking()}function getComponentTrace(){let e=stack[stack.length-1];if(!e)return[];const n=[];for(;e;){const o=n[0];o&&o.vnode===e?o.recurseCount++:n.push({vnode:e,recurseCount:0});const s=e.component&&e.component.parent;e=s&&s.vnode}return n}function formatTrace(e){const n=[];return e.forEach((o,s)=>{n.push(...s===0?[]:[`
`],...formatTraceEntry(o))}),n}function formatTraceEntry({vnode:e,recurseCount:n}){const o=n>0?`... (${n} recursive calls)`:"",s=e.component?e.component.parent==null:!1,h=` at <${formatComponentName(e.component,e.type,s)}`,w=">"+o;return e.props?[h,...formatProps(e.props),w]:[h+w]}function formatProps(e){const n=[],o=Object.keys(e);return o.slice(0,3).forEach(s=>{n.push(...formatProp(s,e[s]))}),o.length>3&&n.push(" ..."),n}function formatProp(e,n,o){return isString(n)?(n=JSON.stringify(n),o?n:[`${e}=${n}`]):typeof n=="number"||typeof n=="boolean"||n==null?o?n:[`${e}=${n}`]:isRef(n)?(n=formatProp(e,toRaw(n.value),!0),o?n:[`${e}=Ref<`,n,">"]):isFunction(n)?[`${e}=fn${n.name?`<${n.name}>`:""}`]:(n=toRaw(n),o?n:[`${e}=`,n])}function callWithErrorHandling(e,n,o,s){try{return s?e(...s):e()}catch(h){handleError(h,n,o)}}function callWithAsyncErrorHandling(e,n,o,s){if(isFunction(e)){const h=callWithErrorHandling(e,n,o,s);return h&&isPromise(h)&&h.catch(w=>{handleError(w,n,o)}),h}if(isArray(e)){const h=[];for(let w=0;w<e.length;w++)h.push(callWithAsyncErrorHandling(e[w],n,o,s));return h}}function handleError(e,n,o,s=!0){const h=n?n.vnode:null;if(n){let w=n.parent;const L=n.proxy,c=`https://vuejs.org/error-reference/#runtime-${o}`;for(;w;){const g=w.ec;if(g){for(let D=0;D<g.length;D++)if(g[D](e,L,c)===!1)return}w=w.parent}const a=n.appContext.config.errorHandler;if(a){pauseTracking(),callWithErrorHandling(a,null,10,[e,L,c]),resetTracking();return}}logError(e,o,h,s)}function logError(e,n,o,s=!0){console.error(e)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(e){const n=currentFlushPromise||resolvedPromise;return e?n.then(this?e.bind(this):e):n}function findInsertionIndex(e){let n=flushIndex+1,o=queue.length;for(;n<o;){const s=n+o>>>1,h=queue[s],w=getId(h);w<e||w===e&&h.pre?n=s+1:o=s}return n}function queueJob(e){(!queue.length||!queue.includes(e,isFlushing&&e.allowRecurse?flushIndex+1:flushIndex))&&(e.id==null?queue.push(e):queue.splice(findInsertionIndex(e.id),0,e),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(e){const n=queue.indexOf(e);n>flushIndex&&queue.splice(n,1)}function queuePostFlushCb(e){isArray(e)?pendingPostFlushCbs.push(...e):(!activePostFlushCbs||!activePostFlushCbs.includes(e,e.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(e),queueFlush()}function flushPreFlushCbs(e,n,o=isFlushing?flushIndex+1:0){for(;o<queue.length;o++){const s=queue[o];if(s&&s.pre){if(e&&s.id!==e.uid)continue;queue.splice(o,1),o--,s()}}}function flushPostFlushCbs(e){if(pendingPostFlushCbs.length){const n=[...new Set(pendingPostFlushCbs)].sort((o,s)=>getId(o)-getId(s));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...n);return}for(activePostFlushCbs=n,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=e=>e.id==null?1/0:e.id,comparator=(e,n)=>{const o=getId(e)-getId(n);if(o===0){if(e.pre&&!n.pre)return-1;if(n.pre&&!e.pre)return 1}return o};function flushJobs(e){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const n=queue[flushIndex];n&&n.active!==!1&&callWithErrorHandling(n,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(e,n,...o){if(e.isUnmounted)return;const s=e.vnode.props||EMPTY_OBJ;let h=o;const w=n.startsWith("update:"),L=w&&n.slice(7);if(L&&L in s){const D=`${L==="modelValue"?"model":L}Modifiers`,{number:H,trim:m}=s[D]||EMPTY_OBJ;m&&(h=o.map(f=>isString(f)?f.trim():f)),H&&(h=o.map(looseToNumber))}let c,a=s[c=toHandlerKey(n)]||s[c=toHandlerKey(camelize(n))];!a&&w&&(a=s[c=toHandlerKey(hyphenate(n))]),a&&callWithAsyncErrorHandling(a,e,6,h);const g=s[c+"Once"];if(g){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,callWithAsyncErrorHandling(g,e,6,h)}}function normalizeEmitsOptions(e,n,o=!1){const s=n.emitsCache,h=s.get(e);if(h!==void 0)return h;const w=e.emits;let L={},c=!1;if(!isFunction(e)){const a=g=>{const D=normalizeEmitsOptions(g,n,!0);D&&(c=!0,extend(L,D))};!o&&n.mixins.length&&n.mixins.forEach(a),e.extends&&a(e.extends),e.mixins&&e.mixins.forEach(a)}return!w&&!c?(isObject(e)&&s.set(e,null),null):(isArray(w)?w.forEach(a=>L[a]=null):extend(L,w),isObject(e)&&s.set(e,L),L)}function isEmitListener(e,n){return!e||!isOn(n)?!1:(n=n.slice(2).replace(/Once$/,""),hasOwn(e,n[0].toLowerCase()+n.slice(1))||hasOwn(e,hyphenate(n))||hasOwn(e,n))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(e){const n=currentRenderingInstance;return currentRenderingInstance=e,currentScopeId=e&&e.type.__scopeId||null,n}function withCtx(e,n=currentRenderingInstance,o){if(!n||e._n)return e;const s=(...h)=>{s._d&&setBlockTracking(-1);const w=setCurrentRenderingInstance(n);let L;try{L=e(...h)}finally{setCurrentRenderingInstance(w),s._d&&setBlockTracking(1)}return L};return s._n=!0,s._c=!0,s._d=!0,s}function markAttrsAccessed(){}function renderComponentRoot(e){const{type:n,vnode:o,proxy:s,withProxy:h,propsOptions:[w],slots:L,attrs:c,emit:a,render:g,renderCache:D,props:H,data:m,setupState:f,ctx:j,inheritAttrs:C}=e,b=setCurrentRenderingInstance(e);let T,O;try{if(o.shapeFlag&4){const U=h||s,B=U;T=normalizeVNode(g.call(B,U,D,H,f,m,j)),O=c}else{const U=n;T=normalizeVNode(U.length>1?U(H,{attrs:c,slots:L,emit:a}):U(H,null)),O=n.props?c:getFunctionalFallthrough(c)}}catch(U){blockStack.length=0,handleError(U,e,1),T=createVNode(Comment)}let F=T;if(O&&C!==!1){const U=Object.keys(O),{shapeFlag:B}=F;U.length&&B&7&&(w&&U.some(isModelListener)&&(O=filterModelListeners(O,w)),F=cloneVNode(F,O))}return o.dirs&&(F=cloneVNode(F),F.dirs=F.dirs?F.dirs.concat(o.dirs):o.dirs),o.transition&&(F.transition=o.transition),T=F,setCurrentRenderingInstance(b),T}const getFunctionalFallthrough=e=>{let n;for(const o in e)(o==="class"||o==="style"||isOn(o))&&((n||(n={}))[o]=e[o]);return n},filterModelListeners=(e,n)=>{const o={};for(const s in e)(!isModelListener(s)||!(s.slice(9)in n))&&(o[s]=e[s]);return o};function shouldUpdateComponent(e,n,o){const{props:s,children:h,component:w}=e,{props:L,children:c,patchFlag:a}=n,g=w.emitsOptions;if(n.dirs||n.transition)return!0;if(o&&a>=0){if(a&1024)return!0;if(a&16)return s?hasPropsChanged(s,L,g):!!L;if(a&8){const D=n.dynamicProps;for(let H=0;H<D.length;H++){const m=D[H];if(L[m]!==s[m]&&!isEmitListener(g,m))return!0}}}else return(h||c)&&(!c||!c.$stable)?!0:s===L?!1:s?L?hasPropsChanged(s,L,g):!0:!!L;return!1}function hasPropsChanged(e,n,o){const s=Object.keys(n);if(s.length!==Object.keys(e).length)return!0;for(let h=0;h<s.length;h++){const w=s[h];if(n[w]!==e[w]&&!isEmitListener(o,w))return!0}return!1}function updateHOCHostEl({vnode:e,parent:n},o){for(;n;){const s=n.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=n.vnode).el=o,n=n.parent;else break}}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc"),isSuspense=e=>e.__isSuspense;function queueEffectWithSuspense(e,n){n&&n.pendingBranch?isArray(e)?n.effects.push(...e):n.effects.push(e):queuePostFlushCb(e)}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey),INITIAL_WATCHER_VALUE={};function watch(e,n,o){return doWatch(e,n,o)}function doWatch(e,n,{immediate:o,deep:s,flush:h,once:w,onTrack:L,onTrigger:c}=EMPTY_OBJ){if(n&&w){const I=n;n=(...P)=>{I(...P),B()}}const a=currentInstance,g=I=>s===!0?I:traverse(I,s===!1?1:void 0);let D,H=!1,m=!1;if(isRef(e)?(D=()=>e.value,H=isShallow(e)):isReactive(e)?(D=()=>g(e),H=!0):isArray(e)?(m=!0,H=e.some(I=>isReactive(I)||isShallow(I)),D=()=>e.map(I=>{if(isRef(I))return I.value;if(isReactive(I))return g(I);if(isFunction(I))return callWithErrorHandling(I,a,2)})):isFunction(e)?n?D=()=>callWithErrorHandling(e,a,2):D=()=>(f&&f(),callWithAsyncErrorHandling(e,a,3,[j])):D=NOOP,n&&s){const I=D;D=()=>traverse(I())}let f,j=I=>{f=F.onStop=()=>{callWithErrorHandling(I,a,4),f=F.onStop=void 0}},C;if(isInSSRComponentSetup)if(j=NOOP,n?o&&callWithAsyncErrorHandling(n,a,3,[D(),m?[]:void 0,j]):D(),h==="sync"){const I=useSSRContext();C=I.__watcherHandles||(I.__watcherHandles=[])}else return NOOP;let b=m?new Array(e.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const T=()=>{if(!(!F.active||!F.dirty))if(n){const I=F.run();(s||H||(m?I.some((P,V)=>hasChanged(P,b[V])):hasChanged(I,b)))&&(f&&f(),callWithAsyncErrorHandling(n,a,3,[I,b===INITIAL_WATCHER_VALUE?void 0:m&&b[0]===INITIAL_WATCHER_VALUE?[]:b,j]),b=I)}else F.run()};T.allowRecurse=!!n;let O;h==="sync"?O=T:h==="post"?O=()=>queuePostRenderEffect(T,a&&a.suspense):(T.pre=!0,a&&(T.id=a.uid),O=()=>queueJob(T));const F=new ReactiveEffect(D,NOOP,O),U=getCurrentScope(),B=()=>{F.stop(),U&&remove(U.effects,F)};return n?o?T():b=F.run():h==="post"?queuePostRenderEffect(F.run.bind(F),a&&a.suspense):F.run(),C&&C.push(B),B}function instanceWatch(e,n,o){const s=this.proxy,h=isString(e)?e.includes(".")?createPathGetter(s,e):()=>s[e]:e.bind(s,s);let w;isFunction(n)?w=n:(w=n.handler,o=n);const L=setCurrentInstance(this),c=doWatch(h,w.bind(s),o);return L(),c}function createPathGetter(e,n){const o=n.split(".");return()=>{let s=e;for(let h=0;h<o.length&&s;h++)s=s[o[h]];return s}}function traverse(e,n,o=0,s){if(!isObject(e)||e.__v_skip)return e;if(n&&n>0){if(o>=n)return e;o++}if(s=s||new Set,s.has(e))return e;if(s.add(e),isRef(e))traverse(e.value,n,o,s);else if(isArray(e))for(let h=0;h<e.length;h++)traverse(e[h],n,o,s);else if(isSet(e)||isMap(e))e.forEach(h=>{traverse(h,n,o,s)});else if(isPlainObject(e))for(const h in e)traverse(e[h],n,o,s);return e}function invokeDirectiveHook(e,n,o,s){const h=e.dirs,w=n&&n.dirs;for(let L=0;L<h.length;L++){const c=h[L];w&&(c.oldValue=w[L].value);let a=c.dir[s];a&&(pauseTracking(),callWithAsyncErrorHandling(a,o,8,[e.el,c,e,n]),resetTracking())}}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(e,n){return isFunction(e)?extend({name:e.name},n,{setup:e}):e}const isAsyncWrapper=e=>!!e.type.__asyncLoader,isKeepAlive=e=>e.type.__isKeepAlive;function onActivated(e,n){registerKeepAliveHook(e,"a",n)}function onDeactivated(e,n){registerKeepAliveHook(e,"da",n)}function registerKeepAliveHook(e,n,o=currentInstance){const s=e.__wdc||(e.__wdc=()=>{let h=o;for(;h;){if(h.isDeactivated)return;h=h.parent}return e()});if(injectHook(n,s,o),o){let h=o.parent;for(;h&&h.parent;)isKeepAlive(h.parent.vnode)&&injectToKeepAliveRoot(s,n,o,h),h=h.parent}}function injectToKeepAliveRoot(e,n,o,s){const h=injectHook(n,e,s,!0);onUnmounted(()=>{remove(s[n],h)},o)}function injectHook(e,n,o=currentInstance,s=!1){if(o){const h=o[e]||(o[e]=[]),w=n.__weh||(n.__weh=(...L)=>{if(o.isUnmounted)return;pauseTracking();const c=setCurrentInstance(o),a=callWithAsyncErrorHandling(n,o,e,L);return c(),resetTracking(),a});return s?h.unshift(w):h.push(w),w}}const createHook=e=>(n,o=currentInstance)=>(!isInSSRComponentSetup||e==="sp")&&injectHook(e,(...s)=>n(...s),o),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(e,n=currentInstance){injectHook("ec",e,n)}const getPublicInstance=e=>e?isStatefulComponent(e)?getExposeProxy(e)||e.proxy:getPublicInstance(e.parent):null,publicPropertiesMap=extend(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>getPublicInstance(e.parent),$root:e=>getPublicInstance(e.root),$emit:e=>e.emit,$options:e=>resolveMergedOptions(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,queueJob(e.update)}),$nextTick:e=>e.n||(e.n=nextTick.bind(e.proxy)),$watch:e=>instanceWatch.bind(e)}),hasSetupBinding=(e,n)=>e!==EMPTY_OBJ&&!e.__isScriptSetup&&hasOwn(e,n),PublicInstanceProxyHandlers={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:o,setupState:s,data:h,props:w,accessCache:L,type:c,appContext:a}=e;let g;if(n[0]!=="$"){const f=L[n];if(f!==void 0)switch(f){case 1:return s[n];case 2:return h[n];case 4:return o[n];case 3:return w[n]}else{if(hasSetupBinding(s,n))return L[n]=1,s[n];if(h!==EMPTY_OBJ&&hasOwn(h,n))return L[n]=2,h[n];if((g=e.propsOptions[0])&&hasOwn(g,n))return L[n]=3,w[n];if(o!==EMPTY_OBJ&&hasOwn(o,n))return L[n]=4,o[n];shouldCacheAccess&&(L[n]=0)}}const D=publicPropertiesMap[n];let H,m;if(D)return n==="$attrs"&&track(e.attrs,"get",""),D(e);if((H=c.__cssModules)&&(H=H[n]))return H;if(o!==EMPTY_OBJ&&hasOwn(o,n))return L[n]=4,o[n];if(m=a.config.globalProperties,hasOwn(m,n))return m[n]},set({_:e},n,o){const{data:s,setupState:h,ctx:w}=e;return hasSetupBinding(h,n)?(h[n]=o,!0):s!==EMPTY_OBJ&&hasOwn(s,n)?(s[n]=o,!0):hasOwn(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(w[n]=o,!0)},has({_:{data:e,setupState:n,accessCache:o,ctx:s,appContext:h,propsOptions:w}},L){let c;return!!o[L]||e!==EMPTY_OBJ&&hasOwn(e,L)||hasSetupBinding(n,L)||(c=w[0])&&hasOwn(c,L)||hasOwn(s,L)||hasOwn(publicPropertiesMap,L)||hasOwn(h.config.globalProperties,L)},defineProperty(e,n,o){return o.get!=null?e._.accessCache[n]=0:hasOwn(o,"value")&&this.set(e,n,o.value,null),Reflect.defineProperty(e,n,o)}};function normalizePropsOrEmits(e){return isArray(e)?e.reduce((n,o)=>(n[o]=null,n),{}):e}let shouldCacheAccess=!0;function applyOptions(e){const n=resolveMergedOptions(e),o=e.proxy,s=e.ctx;shouldCacheAccess=!1,n.beforeCreate&&callHook(n.beforeCreate,e,"bc");const{data:h,computed:w,methods:L,watch:c,provide:a,inject:g,created:D,beforeMount:H,mounted:m,beforeUpdate:f,updated:j,activated:C,deactivated:b,beforeDestroy:T,beforeUnmount:O,destroyed:F,unmounted:U,render:B,renderTracked:I,renderTriggered:P,errorCaptured:V,serverPrefetch:R,expose:Q,inheritAttrs:de,components:oe,directives:be,filters:Ee}=n;if(g&&resolveInjections(g,s,null),L)for(const we in L){const qe=L[we];isFunction(qe)&&(s[we]=qe.bind(o))}if(h){const we=h.call(o,o);isObject(we)&&(e.data=reactive(we))}if(shouldCacheAccess=!0,w)for(const we in w){const qe=w[we],_e=isFunction(qe)?qe.bind(o,o):isFunction(qe.get)?qe.get.bind(o,o):NOOP,Xe=!isFunction(qe)&&isFunction(qe.set)?qe.set.bind(o):NOOP,at=computed({get:_e,set:Xe});Object.defineProperty(s,we,{enumerable:!0,configurable:!0,get:()=>at.value,set:z=>at.value=z})}if(c)for(const we in c)createWatcher(c[we],s,o,we);if(a){const we=isFunction(a)?a.call(o):a;Reflect.ownKeys(we).forEach(qe=>{provide(qe,we[qe])})}D&&callHook(D,e,"c");function se(we,qe){isArray(qe)?qe.forEach(_e=>we(_e.bind(o))):qe&&we(qe.bind(o))}if(se(onBeforeMount,H),se(onMounted,m),se(onBeforeUpdate,f),se(onUpdated,j),se(onActivated,C),se(onDeactivated,b),se(onErrorCaptured,V),se(onRenderTracked,I),se(onRenderTriggered,P),se(onBeforeUnmount,O),se(onUnmounted,U),se(onServerPrefetch,R),isArray(Q))if(Q.length){const we=e.exposed||(e.exposed={});Q.forEach(qe=>{Object.defineProperty(we,qe,{get:()=>o[qe],set:_e=>o[qe]=_e})})}else e.exposed||(e.exposed={});B&&e.render===NOOP&&(e.render=B),de!=null&&(e.inheritAttrs=de),oe&&(e.components=oe),be&&(e.directives=be)}function resolveInjections(e,n,o=NOOP){isArray(e)&&(e=normalizeInject(e));for(const s in e){const h=e[s];let w;isObject(h)?"default"in h?w=inject(h.from||s,h.default,!0):w=inject(h.from||s):w=inject(h),isRef(w)?Object.defineProperty(n,s,{enumerable:!0,configurable:!0,get:()=>w.value,set:L=>w.value=L}):n[s]=w}}function callHook(e,n,o){callWithAsyncErrorHandling(isArray(e)?e.map(s=>s.bind(n.proxy)):e.bind(n.proxy),n,o)}function createWatcher(e,n,o,s){const h=s.includes(".")?createPathGetter(o,s):()=>o[s];if(isString(e)){const w=n[e];isFunction(w)&&watch(h,w)}else if(isFunction(e))watch(h,e.bind(o));else if(isObject(e))if(isArray(e))e.forEach(w=>createWatcher(w,n,o,s));else{const w=isFunction(e.handler)?e.handler.bind(o):n[e.handler];isFunction(w)&&watch(h,w,e)}}function resolveMergedOptions(e){const n=e.type,{mixins:o,extends:s}=n,{mixins:h,optionsCache:w,config:{optionMergeStrategies:L}}=e.appContext,c=w.get(n);let a;return c?a=c:!h.length&&!o&&!s?a=n:(a={},h.length&&h.forEach(g=>mergeOptions(a,g,L,!0)),mergeOptions(a,n,L)),isObject(n)&&w.set(n,a),a}function mergeOptions(e,n,o,s=!1){const{mixins:h,extends:w}=n;w&&mergeOptions(e,w,o,!0),h&&h.forEach(L=>mergeOptions(e,L,o,!0));for(const L in n)if(!(s&&L==="expose")){const c=internalOptionMergeStrats[L]||o&&o[L];e[L]=c?c(e[L],n[L]):n[L]}return e}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(e,n){return n?e?function(){return extend(isFunction(e)?e.call(this,this):e,isFunction(n)?n.call(this,this):n)}:n:e}function mergeInject(e,n){return mergeObjectOptions(normalizeInject(e),normalizeInject(n))}function normalizeInject(e){if(isArray(e)){const n={};for(let o=0;o<e.length;o++)n[e[o]]=e[o];return n}return e}function mergeAsArray(e,n){return e?[...new Set([].concat(e,n))]:n}function mergeObjectOptions(e,n){return e?extend(Object.create(null),e,n):n}function mergeEmitsOrPropsOptions(e,n){return e?isArray(e)&&isArray(n)?[...new Set([...e,...n])]:extend(Object.create(null),normalizePropsOrEmits(e),normalizePropsOrEmits(n??{})):n}function mergeWatchOptions(e,n){if(!e)return n;if(!n)return e;const o=extend(Object.create(null),e);for(const s in n)o[s]=mergeAsArray(e[s],n[s]);return o}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(e,n){return function(s,h=null){isFunction(s)||(s=extend({},s)),h!=null&&!isObject(h)&&(h=null);const w=createAppContext(),L=new WeakSet;let c=!1;const a=w.app={_uid:uid$1++,_component:s,_props:h,_container:null,_context:w,_instance:null,version,get config(){return w.config},set config(g){},use(g,...D){return L.has(g)||(g&&isFunction(g.install)?(L.add(g),g.install(a,...D)):isFunction(g)&&(L.add(g),g(a,...D))),a},mixin(g){return w.mixins.includes(g)||w.mixins.push(g),a},component(g,D){return D?(w.components[g]=D,a):w.components[g]},directive(g,D){return D?(w.directives[g]=D,a):w.directives[g]},mount(g,D,H){if(!c){const m=createVNode(s,h);return m.appContext=w,H===!0?H="svg":H===!1&&(H=void 0),D&&n?n(m,g):e(m,g,H),c=!0,a._container=g,g.__vue_app__=a,getExposeProxy(m.component)||m.component.proxy}},unmount(){c&&(e(null,a._container),delete a._container.__vue_app__)},provide(g,D){return w.provides[g]=D,a},runWithContext(g){const D=currentApp;currentApp=a;try{return g()}finally{currentApp=D}}};return a}}let currentApp=null;function provide(e,n){if(currentInstance){let o=currentInstance.provides;const s=currentInstance.parent&&currentInstance.parent.provides;s===o&&(o=currentInstance.provides=Object.create(s)),o[e]=n}}function inject(e,n,o=!1){const s=currentInstance||currentRenderingInstance;if(s||currentApp){const h=s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:currentApp._context.provides;if(h&&e in h)return h[e];if(arguments.length>1)return o&&isFunction(n)?n.call(s&&s.proxy):n}}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=e=>Object.getPrototypeOf(e)===internalObjectProto;function initProps(e,n,o,s=!1){const h={},w=createInternalObject();e.propsDefaults=Object.create(null),setFullProps(e,n,h,w);for(const L in e.propsOptions[0])L in h||(h[L]=void 0);o?e.props=s?h:shallowReactive(h):e.type.props?e.props=h:e.props=w,e.attrs=w}function updateProps(e,n,o,s){const{props:h,attrs:w,vnode:{patchFlag:L}}=e,c=toRaw(h),[a]=e.propsOptions;let g=!1;if((s||L>0)&&!(L&16)){if(L&8){const D=e.vnode.dynamicProps;for(let H=0;H<D.length;H++){let m=D[H];if(isEmitListener(e.emitsOptions,m))continue;const f=n[m];if(a)if(hasOwn(w,m))f!==w[m]&&(w[m]=f,g=!0);else{const j=camelize(m);h[j]=resolvePropValue(a,c,j,f,e,!1)}else f!==w[m]&&(w[m]=f,g=!0)}}}else{setFullProps(e,n,h,w)&&(g=!0);let D;for(const H in c)(!n||!hasOwn(n,H)&&((D=hyphenate(H))===H||!hasOwn(n,D)))&&(a?o&&(o[H]!==void 0||o[D]!==void 0)&&(h[H]=resolvePropValue(a,c,H,void 0,e,!0)):delete h[H]);if(w!==c)for(const H in w)(!n||!hasOwn(n,H))&&(delete w[H],g=!0)}g&&trigger(e.attrs,"set","")}function setFullProps(e,n,o,s){const[h,w]=e.propsOptions;let L=!1,c;if(n)for(let a in n){if(isReservedProp(a))continue;const g=n[a];let D;h&&hasOwn(h,D=camelize(a))?!w||!w.includes(D)?o[D]=g:(c||(c={}))[D]=g:isEmitListener(e.emitsOptions,a)||(!(a in s)||g!==s[a])&&(s[a]=g,L=!0)}if(w){const a=toRaw(o),g=c||EMPTY_OBJ;for(let D=0;D<w.length;D++){const H=w[D];o[H]=resolvePropValue(h,a,H,g[H],e,!hasOwn(g,H))}}return L}function resolvePropValue(e,n,o,s,h,w){const L=e[o];if(L!=null){const c=hasOwn(L,"default");if(c&&s===void 0){const a=L.default;if(L.type!==Function&&!L.skipFactory&&isFunction(a)){const{propsDefaults:g}=h;if(o in g)s=g[o];else{const D=setCurrentInstance(h);s=g[o]=a.call(null,n),D()}}else s=a}L[0]&&(w&&!c?s=!1:L[1]&&(s===""||s===hyphenate(o))&&(s=!0))}return s}function normalizePropsOptions(e,n,o=!1){const s=n.propsCache,h=s.get(e);if(h)return h;const w=e.props,L={},c=[];let a=!1;if(!isFunction(e)){const D=H=>{a=!0;const[m,f]=normalizePropsOptions(H,n,!0);extend(L,m),f&&c.push(...f)};!o&&n.mixins.length&&n.mixins.forEach(D),e.extends&&D(e.extends),e.mixins&&e.mixins.forEach(D)}if(!w&&!a)return isObject(e)&&s.set(e,EMPTY_ARR),EMPTY_ARR;if(isArray(w))for(let D=0;D<w.length;D++){const H=camelize(w[D]);validatePropName(H)&&(L[H]=EMPTY_OBJ)}else if(w)for(const D in w){const H=camelize(D);if(validatePropName(H)){const m=w[D],f=L[H]=isArray(m)||isFunction(m)?{type:m}:extend({},m);if(f){const j=getTypeIndex(Boolean,f.type),C=getTypeIndex(String,f.type);f[0]=j>-1,f[1]=C<0||j<C,(j>-1||hasOwn(f,"default"))&&c.push(H)}}}const g=[L,c];return isObject(e)&&s.set(e,g),g}function validatePropName(e){return e[0]!=="$"&&!isReservedProp(e)}function getType(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function isSameType(e,n){return getType(e)===getType(n)}function getTypeIndex(e,n){return isArray(n)?n.findIndex(o=>isSameType(o,e)):isFunction(n)&&isSameType(n,e)?0:-1}const isInternalKey=e=>e[0]==="_"||e==="$stable",normalizeSlotValue=e=>isArray(e)?e.map(normalizeVNode):[normalizeVNode(e)],normalizeSlot=(e,n,o)=>{if(n._n)return n;const s=withCtx((...h)=>normalizeSlotValue(n(...h)),o);return s._c=!1,s},normalizeObjectSlots=(e,n,o)=>{const s=e._ctx;for(const h in e){if(isInternalKey(h))continue;const w=e[h];if(isFunction(w))n[h]=normalizeSlot(h,w,s);else if(w!=null){const L=normalizeSlotValue(w);n[h]=()=>L}}},normalizeVNodeSlots=(e,n)=>{const o=normalizeSlotValue(n);e.slots.default=()=>o},initSlots=(e,n)=>{const o=e.slots=createInternalObject();if(e.vnode.shapeFlag&32){const s=n._;s?(extend(o,n),def(o,"_",s)):normalizeObjectSlots(n,o)}else n&&normalizeVNodeSlots(e,n)},updateSlots=(e,n,o)=>{const{vnode:s,slots:h}=e;let w=!0,L=EMPTY_OBJ;if(s.shapeFlag&32){const c=n._;c?o&&c===1?w=!1:(extend(h,n),!o&&c===1&&delete h._):(w=!n.$stable,normalizeObjectSlots(n,h)),L=n}else n&&(normalizeVNodeSlots(e,n),L={default:1});if(w)for(const c in h)!isInternalKey(c)&&L[c]==null&&delete h[c]};function setRef(e,n,o,s,h=!1){if(isArray(e)){e.forEach((m,f)=>setRef(m,n&&(isArray(n)?n[f]:n),o,s,h));return}if(isAsyncWrapper(s)&&!h)return;const w=s.shapeFlag&4?getExposeProxy(s.component)||s.component.proxy:s.el,L=h?null:w,{i:c,r:a}=e,g=n&&n.r,D=c.refs===EMPTY_OBJ?c.refs={}:c.refs,H=c.setupState;if(g!=null&&g!==a&&(isString(g)?(D[g]=null,hasOwn(H,g)&&(H[g]=null)):isRef(g)&&(g.value=null)),isFunction(a))callWithErrorHandling(a,c,12,[L,D]);else{const m=isString(a),f=isRef(a);if(m||f){const j=()=>{if(e.f){const C=m?hasOwn(H,a)?H[a]:D[a]:a.value;h?isArray(C)&&remove(C,w):isArray(C)?C.includes(w)||C.push(w):m?(D[a]=[w],hasOwn(H,a)&&(H[a]=D[a])):(a.value=[w],e.k&&(D[e.k]=a.value))}else m?(D[a]=L,hasOwn(H,a)&&(H[a]=L)):f&&(a.value=L,e.k&&(D[e.k]=L))};L?(j.id=-1,queuePostRenderEffect(j,o)):j()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(e){return baseCreateRenderer(e)}function baseCreateRenderer(e,n){const o=getGlobalThis();o.__VUE__=!0;const{insert:s,remove:h,patchProp:w,createElement:L,createText:c,createComment:a,setText:g,setElementText:D,parentNode:H,nextSibling:m,setScopeId:f=NOOP,insertStaticContent:j}=e,C=(te,ce,ve,Ce=null,Se=null,Be=null,Pe=void 0,Ve=null,Ue=!!ce.dynamicChildren)=>{if(te===ce)return;te&&!isSameVNodeType(te,ce)&&(Ce=Oe(te),z(te,Se,Be,!0),te=null),ce.patchFlag===-2&&(Ue=!1,ce.dynamicChildren=null);const{type:E,ref:M,shapeFlag:d}=ce;switch(E){case Text:b(te,ce,ve,Ce);break;case Comment:T(te,ce,ve,Ce);break;case Static:te==null&&O(ce,ve,Ce,Pe);break;case Fragment:oe(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue);break;default:d&1?B(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue):d&6?be(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue):(d&64||d&128)&&E.process(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue,Ke)}M!=null&&Se&&setRef(M,te&&te.ref,Be,ce||te,!ce)},b=(te,ce,ve,Ce)=>{if(te==null)s(ce.el=c(ce.children),ve,Ce);else{const Se=ce.el=te.el;ce.children!==te.children&&g(Se,ce.children)}},T=(te,ce,ve,Ce)=>{te==null?s(ce.el=a(ce.children||""),ve,Ce):ce.el=te.el},O=(te,ce,ve,Ce)=>{[te.el,te.anchor]=j(te.children,ce,ve,Ce,te.el,te.anchor)},F=({el:te,anchor:ce},ve,Ce)=>{let Se;for(;te&&te!==ce;)Se=m(te),s(te,ve,Ce),te=Se;s(ce,ve,Ce)},U=({el:te,anchor:ce})=>{let ve;for(;te&&te!==ce;)ve=m(te),h(te),te=ve;h(ce)},B=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue)=>{ce.type==="svg"?Pe="svg":ce.type==="math"&&(Pe="mathml"),te==null?I(ce,ve,Ce,Se,Be,Pe,Ve,Ue):R(te,ce,Se,Be,Pe,Ve,Ue)},I=(te,ce,ve,Ce,Se,Be,Pe,Ve)=>{let Ue,E;const{props:M,shapeFlag:d,transition:l,dirs:_}=te;if(Ue=te.el=L(te.type,Be,M&&M.is,M),d&8?D(Ue,te.children):d&16&&V(te.children,Ue,null,Ce,Se,resolveChildrenNamespace(te,Be),Pe,Ve),_&&invokeDirectiveHook(te,null,Ce,"created"),P(Ue,te,te.scopeId,Pe,Ce),M){for(const ne in M)ne!=="value"&&!isReservedProp(ne)&&w(Ue,ne,null,M[ne],Be,te.children,Ce,Se,Ie);"value"in M&&w(Ue,"value",null,M.value,Be),(E=M.onVnodeBeforeMount)&&invokeVNodeHook(E,Ce,te)}_&&invokeDirectiveHook(te,null,Ce,"beforeMount");const G=needTransition(Se,l);G&&l.beforeEnter(Ue),s(Ue,ce,ve),((E=M&&M.onVnodeMounted)||G||_)&&queuePostRenderEffect(()=>{E&&invokeVNodeHook(E,Ce,te),G&&l.enter(Ue),_&&invokeDirectiveHook(te,null,Ce,"mounted")},Se)},P=(te,ce,ve,Ce,Se)=>{if(ve&&f(te,ve),Ce)for(let Be=0;Be<Ce.length;Be++)f(te,Ce[Be]);if(Se){let Be=Se.subTree;if(ce===Be){const Pe=Se.vnode;P(te,Pe,Pe.scopeId,Pe.slotScopeIds,Se.parent)}}},V=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue=0)=>{for(let E=Ue;E<te.length;E++){const M=te[E]=Ve?cloneIfMounted(te[E]):normalizeVNode(te[E]);C(null,M,ce,ve,Ce,Se,Be,Pe,Ve)}},R=(te,ce,ve,Ce,Se,Be,Pe)=>{const Ve=ce.el=te.el;let{patchFlag:Ue,dynamicChildren:E,dirs:M}=ce;Ue|=te.patchFlag&16;const d=te.props||EMPTY_OBJ,l=ce.props||EMPTY_OBJ;let _;if(ve&&toggleRecurse(ve,!1),(_=l.onVnodeBeforeUpdate)&&invokeVNodeHook(_,ve,ce,te),M&&invokeDirectiveHook(ce,te,ve,"beforeUpdate"),ve&&toggleRecurse(ve,!0),E?Q(te.dynamicChildren,E,Ve,ve,Ce,resolveChildrenNamespace(ce,Se),Be):Pe||qe(te,ce,Ve,null,ve,Ce,resolveChildrenNamespace(ce,Se),Be,!1),Ue>0){if(Ue&16)de(Ve,ce,d,l,ve,Ce,Se);else if(Ue&2&&d.class!==l.class&&w(Ve,"class",null,l.class,Se),Ue&4&&w(Ve,"style",d.style,l.style,Se),Ue&8){const G=ce.dynamicProps;for(let ne=0;ne<G.length;ne++){const k=G[ne],S=d[k],Y=l[k];(Y!==S||k==="value")&&w(Ve,k,S,Y,Se,te.children,ve,Ce,Ie)}}Ue&1&&te.children!==ce.children&&D(Ve,ce.children)}else!Pe&&E==null&&de(Ve,ce,d,l,ve,Ce,Se);((_=l.onVnodeUpdated)||M)&&queuePostRenderEffect(()=>{_&&invokeVNodeHook(_,ve,ce,te),M&&invokeDirectiveHook(ce,te,ve,"updated")},Ce)},Q=(te,ce,ve,Ce,Se,Be,Pe)=>{for(let Ve=0;Ve<ce.length;Ve++){const Ue=te[Ve],E=ce[Ve],M=Ue.el&&(Ue.type===Fragment||!isSameVNodeType(Ue,E)||Ue.shapeFlag&70)?H(Ue.el):ve;C(Ue,E,M,null,Ce,Se,Be,Pe,!0)}},de=(te,ce,ve,Ce,Se,Be,Pe)=>{if(ve!==Ce){if(ve!==EMPTY_OBJ)for(const Ve in ve)!isReservedProp(Ve)&&!(Ve in Ce)&&w(te,Ve,ve[Ve],null,Pe,ce.children,Se,Be,Ie);for(const Ve in Ce){if(isReservedProp(Ve))continue;const Ue=Ce[Ve],E=ve[Ve];Ue!==E&&Ve!=="value"&&w(te,Ve,E,Ue,Pe,ce.children,Se,Be,Ie)}"value"in Ce&&w(te,"value",ve.value,Ce.value,Pe)}},oe=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue)=>{const E=ce.el=te?te.el:c(""),M=ce.anchor=te?te.anchor:c("");let{patchFlag:d,dynamicChildren:l,slotScopeIds:_}=ce;_&&(Ve=Ve?Ve.concat(_):_),te==null?(s(E,ve,Ce),s(M,ve,Ce),V(ce.children||[],ve,M,Se,Be,Pe,Ve,Ue)):d>0&&d&64&&l&&te.dynamicChildren?(Q(te.dynamicChildren,l,ve,Se,Be,Pe,Ve),(ce.key!=null||Se&&ce===Se.subTree)&&traverseStaticChildren(te,ce,!0)):qe(te,ce,ve,M,Se,Be,Pe,Ve,Ue)},be=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue)=>{ce.slotScopeIds=Ve,te==null?ce.shapeFlag&512?Se.ctx.activate(ce,ve,Ce,Pe,Ue):Ee(ce,ve,Ce,Se,Be,Pe,Ue):ye(te,ce,Ue)},Ee=(te,ce,ve,Ce,Se,Be,Pe)=>{const Ve=te.component=createComponentInstance(te,Ce,Se);if(isKeepAlive(te)&&(Ve.ctx.renderer=Ke),setupComponent(Ve),Ve.asyncDep){if(Se&&Se.registerDep(Ve,se),!te.el){const Ue=Ve.subTree=createVNode(Comment);T(null,Ue,ce,ve)}}else se(Ve,te,ce,ve,Se,Be,Pe)},ye=(te,ce,ve)=>{const Ce=ce.component=te.component;if(shouldUpdateComponent(te,ce,ve))if(Ce.asyncDep&&!Ce.asyncResolved){we(Ce,ce,ve);return}else Ce.next=ce,invalidateJob(Ce.update),Ce.effect.dirty=!0,Ce.update();else ce.el=te.el,Ce.vnode=ce},se=(te,ce,ve,Ce,Se,Be,Pe)=>{const Ve=()=>{if(te.isMounted){let{next:M,bu:d,u:l,parent:_,vnode:G}=te;{const J=locateNonHydratedAsyncRoot(te);if(J){M&&(M.el=G.el,we(te,M,Pe)),J.asyncDep.then(()=>{te.isUnmounted||Ve()});return}}let ne=M,k;toggleRecurse(te,!1),M?(M.el=G.el,we(te,M,Pe)):M=G,d&&invokeArrayFns(d),(k=M.props&&M.props.onVnodeBeforeUpdate)&&invokeVNodeHook(k,_,M,G),toggleRecurse(te,!0);const S=renderComponentRoot(te),Y=te.subTree;te.subTree=S,C(Y,S,H(Y.el),Oe(Y),te,Se,Be),M.el=S.el,ne===null&&updateHOCHostEl(te,S.el),l&&queuePostRenderEffect(l,Se),(k=M.props&&M.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(k,_,M,G),Se)}else{let M;const{el:d,props:l}=ce,{bm:_,m:G,parent:ne}=te,k=isAsyncWrapper(ce);if(toggleRecurse(te,!1),_&&invokeArrayFns(_),!k&&(M=l&&l.onVnodeBeforeMount)&&invokeVNodeHook(M,ne,ce),toggleRecurse(te,!0),d&&ct){const S=()=>{te.subTree=renderComponentRoot(te),ct(d,te.subTree,te,Se,null)};k?ce.type.__asyncLoader().then(()=>!te.isUnmounted&&S()):S()}else{const S=te.subTree=renderComponentRoot(te);C(null,S,ve,Ce,te,Se,Be),ce.el=S.el}if(G&&queuePostRenderEffect(G,Se),!k&&(M=l&&l.onVnodeMounted)){const S=ce;queuePostRenderEffect(()=>invokeVNodeHook(M,ne,S),Se)}(ce.shapeFlag&256||ne&&isAsyncWrapper(ne.vnode)&&ne.vnode.shapeFlag&256)&&te.a&&queuePostRenderEffect(te.a,Se),te.isMounted=!0,ce=ve=Ce=null}},Ue=te.effect=new ReactiveEffect(Ve,NOOP,()=>queueJob(E),te.scope),E=te.update=()=>{Ue.dirty&&Ue.run()};E.id=te.uid,toggleRecurse(te,!0),E()},we=(te,ce,ve)=>{ce.component=te;const Ce=te.vnode.props;te.vnode=ce,te.next=null,updateProps(te,ce.props,Ce,ve),updateSlots(te,ce.children,ve),pauseTracking(),flushPreFlushCbs(te),resetTracking()},qe=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue=!1)=>{const E=te&&te.children,M=te?te.shapeFlag:0,d=ce.children,{patchFlag:l,shapeFlag:_}=ce;if(l>0){if(l&128){Xe(E,d,ve,Ce,Se,Be,Pe,Ve,Ue);return}else if(l&256){_e(E,d,ve,Ce,Se,Be,Pe,Ve,Ue);return}}_&8?(M&16&&Ie(E,Se,Be),d!==E&&D(ve,d)):M&16?_&16?Xe(E,d,ve,Ce,Se,Be,Pe,Ve,Ue):Ie(E,Se,Be,!0):(M&8&&D(ve,""),_&16&&V(d,ve,Ce,Se,Be,Pe,Ve,Ue))},_e=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue)=>{te=te||EMPTY_ARR,ce=ce||EMPTY_ARR;const E=te.length,M=ce.length,d=Math.min(E,M);let l;for(l=0;l<d;l++){const _=ce[l]=Ue?cloneIfMounted(ce[l]):normalizeVNode(ce[l]);C(te[l],_,ve,null,Se,Be,Pe,Ve,Ue)}E>M?Ie(te,Se,Be,!0,!1,d):V(ce,ve,Ce,Se,Be,Pe,Ve,Ue,d)},Xe=(te,ce,ve,Ce,Se,Be,Pe,Ve,Ue)=>{let E=0;const M=ce.length;let d=te.length-1,l=M-1;for(;E<=d&&E<=l;){const _=te[E],G=ce[E]=Ue?cloneIfMounted(ce[E]):normalizeVNode(ce[E]);if(isSameVNodeType(_,G))C(_,G,ve,null,Se,Be,Pe,Ve,Ue);else break;E++}for(;E<=d&&E<=l;){const _=te[d],G=ce[l]=Ue?cloneIfMounted(ce[l]):normalizeVNode(ce[l]);if(isSameVNodeType(_,G))C(_,G,ve,null,Se,Be,Pe,Ve,Ue);else break;d--,l--}if(E>d){if(E<=l){const _=l+1,G=_<M?ce[_].el:Ce;for(;E<=l;)C(null,ce[E]=Ue?cloneIfMounted(ce[E]):normalizeVNode(ce[E]),ve,G,Se,Be,Pe,Ve,Ue),E++}}else if(E>l)for(;E<=d;)z(te[E],Se,Be,!0),E++;else{const _=E,G=E,ne=new Map;for(E=G;E<=l;E++){const fe=ce[E]=Ue?cloneIfMounted(ce[E]):normalizeVNode(ce[E]);fe.key!=null&&ne.set(fe.key,E)}let k,S=0;const Y=l-G+1;let J=!1,ie=0;const xe=new Array(Y);for(E=0;E<Y;E++)xe[E]=0;for(E=_;E<=d;E++){const fe=te[E];if(S>=Y){z(fe,Se,Be,!0);continue}let Re;if(fe.key!=null)Re=ne.get(fe.key);else for(k=G;k<=l;k++)if(xe[k-G]===0&&isSameVNodeType(fe,ce[k])){Re=k;break}Re===void 0?z(fe,Se,Be,!0):(xe[Re-G]=E+1,Re>=ie?ie=Re:J=!0,C(fe,ce[Re],ve,null,Se,Be,Pe,Ve,Ue),S++)}const ge=J?getSequence(xe):EMPTY_ARR;for(k=ge.length-1,E=Y-1;E>=0;E--){const fe=G+E,Re=ce[fe],We=fe+1<M?ce[fe+1].el:Ce;xe[E]===0?C(null,Re,ve,We,Se,Be,Pe,Ve,Ue):J&&(k<0||E!==ge[k]?at(Re,ve,We,2):k--)}}},at=(te,ce,ve,Ce,Se=null)=>{const{el:Be,type:Pe,transition:Ve,children:Ue,shapeFlag:E}=te;if(E&6){at(te.component.subTree,ce,ve,Ce);return}if(E&128){te.suspense.move(ce,ve,Ce);return}if(E&64){Pe.move(te,ce,ve,Ke);return}if(Pe===Fragment){s(Be,ce,ve);for(let d=0;d<Ue.length;d++)at(Ue[d],ce,ve,Ce);s(te.anchor,ce,ve);return}if(Pe===Static){F(te,ce,ve);return}if(Ce!==2&&E&1&&Ve)if(Ce===0)Ve.beforeEnter(Be),s(Be,ce,ve),queuePostRenderEffect(()=>Ve.enter(Be),Se);else{const{leave:d,delayLeave:l,afterLeave:_}=Ve,G=()=>s(Be,ce,ve),ne=()=>{d(Be,()=>{G(),_&&_()})};l?l(Be,G,ne):ne()}else s(Be,ce,ve)},z=(te,ce,ve,Ce=!1,Se=!1)=>{const{type:Be,props:Pe,ref:Ve,children:Ue,dynamicChildren:E,shapeFlag:M,patchFlag:d,dirs:l}=te;if(Ve!=null&&setRef(Ve,null,ve,te,!0),M&256){ce.ctx.deactivate(te);return}const _=M&1&&l,G=!isAsyncWrapper(te);let ne;if(G&&(ne=Pe&&Pe.onVnodeBeforeUnmount)&&invokeVNodeHook(ne,ce,te),M&6)ft(te.component,ve,Ce);else{if(M&128){te.suspense.unmount(ve,Ce);return}_&&invokeDirectiveHook(te,null,ce,"beforeUnmount"),M&64?te.type.remove(te,ce,ve,Se,Ke,Ce):E&&(Be!==Fragment||d>0&&d&64)?Ie(E,ce,ve,!1,!0):(Be===Fragment&&d&384||!Se&&M&16)&&Ie(Ue,ce,ve),Ce&&Le(te)}(G&&(ne=Pe&&Pe.onVnodeUnmounted)||_)&&queuePostRenderEffect(()=>{ne&&invokeVNodeHook(ne,ce,te),_&&invokeDirectiveHook(te,null,ce,"unmounted")},ve)},Le=te=>{const{type:ce,el:ve,anchor:Ce,transition:Se}=te;if(ce===Fragment){Qe(ve,Ce);return}if(ce===Static){U(te);return}const Be=()=>{h(ve),Se&&!Se.persisted&&Se.afterLeave&&Se.afterLeave()};if(te.shapeFlag&1&&Se&&!Se.persisted){const{leave:Pe,delayLeave:Ve}=Se,Ue=()=>Pe(ve,Be);Ve?Ve(te.el,Be,Ue):Ue()}else Be()},Qe=(te,ce)=>{let ve;for(;te!==ce;)ve=m(te),h(te),te=ve;h(ce)},ft=(te,ce,ve)=>{const{bum:Ce,scope:Se,update:Be,subTree:Pe,um:Ve}=te;Ce&&invokeArrayFns(Ce),Se.stop(),Be&&(Be.active=!1,z(Pe,te,ce,ve)),Ve&&queuePostRenderEffect(Ve,ce),queuePostRenderEffect(()=>{te.isUnmounted=!0},ce),ce&&ce.pendingBranch&&!ce.isUnmounted&&te.asyncDep&&!te.asyncResolved&&te.suspenseId===ce.pendingId&&(ce.deps--,ce.deps===0&&ce.resolve())},Ie=(te,ce,ve,Ce=!1,Se=!1,Be=0)=>{for(let Pe=Be;Pe<te.length;Pe++)z(te[Pe],ce,ve,Ce,Se)},Oe=te=>te.shapeFlag&6?Oe(te.component.subTree):te.shapeFlag&128?te.suspense.next():m(te.anchor||te.el);let Ye=!1;const Fe=(te,ce,ve)=>{te==null?ce._vnode&&z(ce._vnode,null,null,!0):C(ce._vnode||null,te,ce,null,null,null,ve),Ye||(Ye=!0,flushPreFlushCbs(),flushPostFlushCbs(),Ye=!1),ce._vnode=te},Ke={p:C,um:z,m:at,r:Le,mt:Ee,mc:V,pc:qe,pbc:Q,n:Oe,o:e};let tt,ct;return n&&([tt,ct]=n(Ke)),{render:Fe,hydrate:tt,createApp:createAppAPI(Fe,tt)}}function resolveChildrenNamespace({type:e,props:n},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:o}function toggleRecurse({effect:e,update:n},o){e.allowRecurse=n.allowRecurse=o}function needTransition(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function traverseStaticChildren(e,n,o=!1){const s=e.children,h=n.children;if(isArray(s)&&isArray(h))for(let w=0;w<s.length;w++){const L=s[w];let c=h[w];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=h[w]=cloneIfMounted(h[w]),c.el=L.el),o||traverseStaticChildren(L,c)),c.type===Text&&(c.el=L.el)}}function getSequence(e){const n=e.slice(),o=[0];let s,h,w,L,c;const a=e.length;for(s=0;s<a;s++){const g=e[s];if(g!==0){if(h=o[o.length-1],e[h]<g){n[s]=h,o.push(s);continue}for(w=0,L=o.length-1;w<L;)c=w+L>>1,e[o[c]]<g?w=c+1:L=c;g<e[o[w]]&&(w>0&&(n[s]=o[w-1]),o[w]=s)}}for(w=o.length,L=o[w-1];w-- >0;)o[w]=L,L=n[L];return o}function locateNonHydratedAsyncRoot(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:locateNonHydratedAsyncRoot(n)}const isTeleport=e=>e.__isTeleport,Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(e=!1){blockStack.push(currentBlock=e?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(e){isBlockTreeEnabled+=e}function setupBlock(e){return e.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(e),e}function createElementBlock(e,n,o,s,h,w){return setupBlock(createBaseVNode(e,n,o,s,h,w,!0))}function createBlock(e,n,o,s,h){return setupBlock(createVNode(e,n,o,s,h,!0))}function isVNode(e){return e?e.__v_isVNode===!0:!1}function isSameVNodeType(e,n){return e.type===n.type&&e.key===n.key}const normalizeKey=({key:e})=>e??null,normalizeRef=({ref:e,ref_key:n,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?isString(e)||isRef(e)||isFunction(e)?{i:currentRenderingInstance,r:e,k:n,f:!!o}:e:null);function createBaseVNode(e,n=null,o=null,s=0,h=null,w=e===Fragment?0:1,L=!1,c=!1){const a={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&normalizeKey(n),ref:n&&normalizeRef(n),scopeId:currentScopeId,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:w,patchFlag:s,dynamicProps:h,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return c?(normalizeChildren(a,o),w&128&&e.normalize(a)):o&&(a.shapeFlag|=isString(o)?8:16),isBlockTreeEnabled>0&&!L&&currentBlock&&(a.patchFlag>0||w&6)&&a.patchFlag!==32&&currentBlock.push(a),a}const createVNode=_createVNode;function _createVNode(e,n=null,o=null,s=0,h=null,w=!1){if((!e||e===NULL_DYNAMIC_COMPONENT)&&(e=Comment),isVNode(e)){const c=cloneVNode(e,n,!0);return o&&normalizeChildren(c,o),isBlockTreeEnabled>0&&!w&&currentBlock&&(c.shapeFlag&6?currentBlock[currentBlock.indexOf(e)]=c:currentBlock.push(c)),c.patchFlag|=-2,c}if(isClassComponent(e)&&(e=e.__vccOpts),n){n=guardReactiveProps(n);let{class:c,style:a}=n;c&&!isString(c)&&(n.class=normalizeClass(c)),isObject(a)&&(isProxy(a)&&!isArray(a)&&(a=extend({},a)),n.style=normalizeStyle(a))}const L=isString(e)?1:isSuspense(e)?128:isTeleport(e)?64:isObject(e)?4:isFunction(e)?2:0;return createBaseVNode(e,n,o,s,h,L,w,!0)}function guardReactiveProps(e){return e?isProxy(e)||isInternalObject(e)?extend({},e):e:null}function cloneVNode(e,n,o=!1){const{props:s,ref:h,patchFlag:w,children:L}=e,c=n?mergeProps(s||{},n):s;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&normalizeKey(c),ref:n&&n.ref?o&&h?isArray(h)?h.concat(normalizeRef(n)):[h,normalizeRef(n)]:normalizeRef(n):h,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:L,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==Fragment?w===-1?16:w|16:w,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&cloneVNode(e.ssContent),ssFallback:e.ssFallback&&cloneVNode(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function createTextVNode(e=" ",n=0){return createVNode(Text,null,e,n)}function normalizeVNode(e){return e==null||typeof e=="boolean"?createVNode(Comment):isArray(e)?createVNode(Fragment,null,e.slice()):typeof e=="object"?cloneIfMounted(e):createVNode(Text,null,String(e))}function cloneIfMounted(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:cloneVNode(e)}function normalizeChildren(e,n){let o=0;const{shapeFlag:s}=e;if(n==null)n=null;else if(isArray(n))o=16;else if(typeof n=="object")if(s&65){const h=n.default;h&&(h._c&&(h._d=!1),normalizeChildren(e,h()),h._c&&(h._d=!0));return}else{o=32;const h=n._;!h&&!isInternalObject(n)?n._ctx=currentRenderingInstance:h===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else isFunction(n)?(n={default:n,_ctx:currentRenderingInstance},o=32):(n=String(n),s&64?(o=16,n=[createTextVNode(n)]):o=8);e.children=n,e.shapeFlag|=o}function mergeProps(...e){const n={};for(let o=0;o<e.length;o++){const s=e[o];for(const h in s)if(h==="class")n.class!==s.class&&(n.class=normalizeClass([n.class,s.class]));else if(h==="style")n.style=normalizeStyle([n.style,s.style]);else if(isOn(h)){const w=n[h],L=s[h];L&&w!==L&&!(isArray(w)&&w.includes(L))&&(n[h]=w?[].concat(w,L):L)}else h!==""&&(n[h]=s[h])}return n}function invokeVNodeHook(e,n,o,s=null){callWithAsyncErrorHandling(e,n,7,[o,s])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(e,n,o){const s=e.type,h=(n?n.appContext:e.appContext)||emptyAppContext,w={uid:uid++,vnode:e,type:s,parent:n,appContext:h,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(h.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(s,h),emitsOptions:normalizeEmitsOptions(s,h),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:s.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return w.ctx={_:w},w.root=n?n.root:w,w.emit=emit.bind(null,w),e.ce&&e.ce(w),w}let currentInstance=null,internalSetCurrentInstance,setInSSRSetupState;{const e=getGlobalThis(),n=(o,s)=>{let h;return(h=e[o])||(h=e[o]=[]),h.push(s),w=>{h.length>1?h.forEach(L=>L(w)):h[0](w)}};internalSetCurrentInstance=n("__VUE_INSTANCE_SETTERS__",o=>currentInstance=o),setInSSRSetupState=n("__VUE_SSR_SETTERS__",o=>isInSSRComponentSetup=o)}const setCurrentInstance=e=>{const n=currentInstance;return internalSetCurrentInstance(e),e.scope.on(),()=>{e.scope.off(),internalSetCurrentInstance(n)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(e){return e.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(e,n=!1){n&&setInSSRSetupState(n);const{props:o,children:s}=e.vnode,h=isStatefulComponent(e);initProps(e,o,h,n),initSlots(e,s);const w=h?setupStatefulComponent(e,n):void 0;return n&&setInSSRSetupState(!1),w}function setupStatefulComponent(e,n){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,PublicInstanceProxyHandlers);const{setup:s}=o;if(s){const h=e.setupContext=s.length>1?createSetupContext(e):null,w=setCurrentInstance(e);pauseTracking();const L=callWithErrorHandling(s,e,0,[e.props,h]);if(resetTracking(),w(),isPromise(L)){if(L.then(unsetCurrentInstance,unsetCurrentInstance),n)return L.then(c=>{handleSetupResult(e,c,n)}).catch(c=>{handleError(c,e,0)});e.asyncDep=L}else handleSetupResult(e,L,n)}else finishComponentSetup(e,n)}function handleSetupResult(e,n,o){isFunction(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:isObject(n)&&(e.setupState=proxyRefs(n)),finishComponentSetup(e,o)}let compile;function finishComponentSetup(e,n,o){const s=e.type;if(!e.render){if(!n&&compile&&!s.render){const h=s.template||resolveMergedOptions(e).template;if(h){const{isCustomElement:w,compilerOptions:L}=e.appContext.config,{delimiters:c,compilerOptions:a}=s,g=extend(extend({isCustomElement:w,delimiters:c},L),a);s.render=compile(h,g)}}e.render=s.render||NOOP}{const h=setCurrentInstance(e);pauseTracking();try{applyOptions(e)}finally{resetTracking(),h()}}}const attrsProxyHandlers={get(e,n){return track(e,"get",""),e[n]}};function createSetupContext(e){const n=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,attrsProxyHandlers),slots:e.slots,emit:e.emit,expose:n}}function getExposeProxy(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(proxyRefs(markRaw(e.exposed)),{get(n,o){if(o in n)return n[o];if(o in publicPropertiesMap)return publicPropertiesMap[o](e)},has(n,o){return o in n||o in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=e=>e.replace(classifyRE,n=>n.toUpperCase()).replace(/[-_]/g,"");function getComponentName(e,n=!0){return isFunction(e)?e.displayName||e.name:e.name||n&&e.__name}function formatComponentName(e,n,o=!1){let s=getComponentName(n);if(!s&&n.__file){const h=n.__file.match(/([^/\\]+)\.\w+$/);h&&(s=h[1])}if(!s&&e&&e.parent){const h=w=>{for(const L in w)if(w[L]===n)return L};s=h(e.components||e.parent.type.components)||h(e.appContext.components)}return s?classify(s):o?"App":"Anonymous"}function isClassComponent(e){return isFunction(e)&&"__vccOpts"in e}const computed=(e,n)=>computed$1(e,n,isInSSRComponentSetup),version="3.4.25";/**
* @vue/runtime-dom v3.4.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(e,n,o)=>{n.insertBefore(e,o||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,o,s)=>{const h=n==="svg"?doc.createElementNS(svgNS,e):n==="mathml"?doc.createElementNS(mathmlNS,e):doc.createElement(e,o?{is:o}:void 0);return e==="select"&&s&&s.multiple!=null&&h.setAttribute("multiple",s.multiple),h},createText:e=>doc.createTextNode(e),createComment:e=>doc.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>doc.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,o,s,h,w){const L=o?o.previousSibling:n.lastChild;if(h&&(h===w||h.nextSibling))for(;n.insertBefore(h.cloneNode(!0),o),!(h===w||!(h=h.nextSibling)););else{templateContainer.innerHTML=s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e;const c=templateContainer.content;if(s==="svg"||s==="mathml"){const a=c.firstChild;for(;a.firstChild;)c.appendChild(a.firstChild);c.removeChild(a)}n.insertBefore(c,o)}return[L?L.nextSibling:n.firstChild,o?o.previousSibling:n.lastChild]}},vtcKey=Symbol("_vtc");function patchClass(e,n,o){const s=e[vtcKey];s&&(n=(n?[n,...s]:[...s]).join(" ")),n==null?e.removeAttribute("class"):o?e.setAttribute("class",n):e.className=n}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(e,n,o){const s=e.style,h=isString(o);let w=!1;if(o&&!h){if(n)if(isString(n))for(const L of n.split(";")){const c=L.slice(0,L.indexOf(":")).trim();o[c]==null&&setStyle(s,c,"")}else for(const L in n)o[L]==null&&setStyle(s,L,"");for(const L in o)L==="display"&&(w=!0),setStyle(s,L,o[L])}else if(h){if(n!==o){const L=s[CSS_VAR_TEXT];L&&(o+=";"+L),s.cssText=o,w=displayRE.test(o)}}else n&&e.removeAttribute("style");vShowOriginalDisplay in e&&(e[vShowOriginalDisplay]=w?s.display:"",e[vShowHidden]&&(s.display="none"))}const importantRE=/\s*!important$/;function setStyle(e,n,o){if(isArray(o))o.forEach(s=>setStyle(e,n,s));else if(o==null&&(o=""),n.startsWith("--"))e.setProperty(n,o);else{const s=autoPrefix(e,n);importantRE.test(o)?e.setProperty(hyphenate(s),o.replace(importantRE,""),"important"):e[s]=o}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(e,n){const o=prefixCache[n];if(o)return o;let s=camelize(n);if(s!=="filter"&&s in e)return prefixCache[n]=s;s=capitalize(s);for(let h=0;h<prefixes.length;h++){const w=prefixes[h]+s;if(w in e)return prefixCache[n]=w}return n}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(e,n,o,s,h){if(s&&n.startsWith("xlink:"))o==null?e.removeAttributeNS(xlinkNS,n.slice(6,n.length)):e.setAttributeNS(xlinkNS,n,o);else{const w=isSpecialBooleanAttr(n);o==null||w&&!includeBooleanAttr(o)?e.removeAttribute(n):e.setAttribute(n,w?"":o)}}function patchDOMProp(e,n,o,s,h,w,L){if(n==="innerHTML"||n==="textContent"){s&&L(s,h,w),e[n]=o??"";return}const c=e.tagName;if(n==="value"&&c!=="PROGRESS"&&!c.includes("-")){const g=c==="OPTION"?e.getAttribute("value")||"":e.value,D=o??"";(g!==D||!("_value"in e))&&(e.value=D),o==null&&e.removeAttribute(n),e._value=o;return}let a=!1;if(o===""||o==null){const g=typeof e[n];g==="boolean"?o=includeBooleanAttr(o):o==null&&g==="string"?(o="",a=!0):g==="number"&&(o=0,a=!0)}try{e[n]=o}catch{}a&&e.removeAttribute(n)}function addEventListener(e,n,o,s){e.addEventListener(n,o,s)}function removeEventListener(e,n,o,s){e.removeEventListener(n,o,s)}const veiKey=Symbol("_vei");function patchEvent(e,n,o,s,h=null){const w=e[veiKey]||(e[veiKey]={}),L=w[n];if(s&&L)L.value=s;else{const[c,a]=parseName(n);if(s){const g=w[n]=createInvoker(s,h);addEventListener(e,c,g,a)}else L&&(removeEventListener(e,c,L,a),w[n]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(e){let n;if(optionsModifierRE.test(e)){n={};let s;for(;s=e.match(optionsModifierRE);)e=e.slice(0,e.length-s[0].length),n[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):hyphenate(e.slice(2)),n]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(e,n){const o=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=o.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(s,o.value),n,5,[s])};return o.value=e,o.attached=getNow(),o}function patchStopImmediatePropagation(e,n){if(isArray(n)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},n.map(s=>h=>!h._stopped&&s&&s(h))}else return n}const isNativeOn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,patchProp=(e,n,o,s,h,w,L,c,a)=>{const g=h==="svg";n==="class"?patchClass(e,s,g):n==="style"?patchStyle(e,o,s):isOn(n)?isModelListener(n)||patchEvent(e,n,o,s,L):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):shouldSetAsProp(e,n,s,g))?patchDOMProp(e,n,s,w,L,c,a):(n==="true-value"?e._trueValue=s:n==="false-value"&&(e._falseValue=s),patchAttr(e,n,s,g))};function shouldSetAsProp(e,n,o,s){if(s)return!!(n==="innerHTML"||n==="textContent"||n in e&&isNativeOn(n)&&isFunction(o));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const h=e.tagName;if(h==="IMG"||h==="VIDEO"||h==="CANVAS"||h==="SOURCE")return!1}return isNativeOn(n)&&isString(o)?!1:n in e}const rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...e)=>{const n=ensureRenderer().createApp(...e),{mount:o}=n;return n.mount=s=>{const h=normalizeContainer(s);if(!h)return;const w=n._component;!isFunction(w)&&!w.render&&!w.template&&(w.template=h.innerHTML),h.innerHTML="";const L=o(h,!1,resolveRootNamespace(h));return h instanceof Element&&(h.removeAttribute("v-cloak"),h.setAttribute("data-v-app","")),L},n};function resolveRootNamespace(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function normalizeContainer(e){return isString(e)?document.querySelector(e):e}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsuites={exports:{}};(function(e,n){(function(s,h){e.exports=h()})(commonjsGlobal,function(){return function(){var o={195:function(L){(function(c,a){L.exports=a()})(this,function(){return function(Le){function a(Ie,Oe){this.highOrder=Ie,this.lowOrder=Oe}var g=[new a(1779033703,4089235720),new a(3144134277,2227873595),new a(1013904242,4271175723),new a(2773480762,1595750129),new a(1359893119,2917565137),new a(2600822924,725511199),new a(528734635,4215389547),new a(1541459225,327033209)],D=[new a(1116352408,3609767458),new a(1899447441,602891725),new a(3049323471,3964484399),new a(3921009573,2173295548),new a(961987163,4081628472),new a(1508970993,3053834265),new a(2453635748,2937671579),new a(2870763221,3664609560),new a(3624381080,2734883394),new a(310598401,1164996542),new a(607225278,1323610764),new a(1426881987,3590304994),new a(1925078388,4068182383),new a(2162078206,991336113),new a(2614888103,633803317),new a(3248222580,3479774868),new a(3835390401,2666613458),new a(4022224774,944711139),new a(264347078,2341262773),new a(604807628,2007800933),new a(770255983,1495990901),new a(1249150122,1856431235),new a(1555081692,3175218132),new a(1996064986,2198950837),new a(2554220882,3999719339),new a(2821834349,766784016),new a(2952996808,2566594879),new a(3210313671,3203337956),new a(3336571891,1034457026),new a(3584528711,2466948901),new a(113926993,3758326383),new a(338241895,168717936),new a(666307205,1188179964),new a(773529912,1546045734),new a(1294757372,1522805485),new a(1396182291,2643833823),new a(1695183700,2343527390),new a(1986661051,1014477480),new a(2177026350,1206759142),new a(2456956037,344077627),new a(2730485921,1290863460),new a(2820302411,3158454273),new a(3259730800,3505952657),new a(3345764771,106217008),new a(3516065817,3606008344),new a(3600352804,1432725776),new a(4094571909,1467031594),new a(275423344,851169720),new a(430227734,3100823752),new a(506948616,1363258195),new a(659060556,3750685593),new a(883997877,3785050280),new a(958139571,3318307427),new a(1322822218,3812723403),new a(1537002063,2003034995),new a(1747873779,3602036899),new a(1955562222,1575990012),new a(2024104815,1125592928),new a(2227730452,2716904306),new a(2361852424,442776044),new a(2428436474,593698344),new a(2756734187,3733110249),new a(3204031479,2999351573),new a(3329325298,3815920427),new a(3391569614,3928383900),new a(3515267271,566280711),new a(3940187606,3454069534),new a(4118630271,4000239992),new a(116418474,1914138554),new a(174292421,2731055270),new a(289380356,3203993006),new a(460393269,320620315),new a(685471733,587496836),new a(852142971,1086792851),new a(1017036298,365543100),new a(1126000580,2618297676),new a(1288033470,3409855158),new a(1501505948,4234509866),new a(1607167915,987167468),new a(1816402316,1246189591)],H=new Array(64),m,f,j,C,b,T,O,F,U,B,I,P,V=8;function R(Ie){return unescape(encodeURIComponent(Ie))}function Q(Ie){for(var Oe=[],Ye=(1<<V)-1,Fe=Ie.length*V,Ke=0;Ke<Fe;Ke+=V)Oe[Ke>>5]|=(Ie.charCodeAt(Ke/V)&Ye)<<32-V-Ke%32;return Oe}function de(Ie){for(var Oe="0123456789abcdef",Ye="",Fe=Ie.length*4,Ke,tt=0;tt<Fe;tt+=1)Ke=Ie[tt>>2]>>(3-tt%4)*8,Ye+=Oe.charAt(Ke>>4&15)+Oe.charAt(Ke&15);return Ye}function oe(Ie,Oe){var Ye,Fe,Ke,tt;return Ye=(Ie.lowOrder&65535)+(Oe.lowOrder&65535),Fe=(Ie.lowOrder>>>16)+(Oe.lowOrder>>>16)+(Ye>>>16),Ke=(Fe&65535)<<16|Ye&65535,Ye=(Ie.highOrder&65535)+(Oe.highOrder&65535)+(Fe>>>16),Fe=(Ie.highOrder>>>16)+(Oe.highOrder>>>16)+(Ye>>>16),tt=(Fe&65535)<<16|Ye&65535,new a(tt,Ke)}function be(Ie,Oe,Ye,Fe){var Ke,tt,ct,te;return Ke=(Ie.lowOrder&65535)+(Oe.lowOrder&65535)+(Ye.lowOrder&65535)+(Fe.lowOrder&65535),tt=(Ie.lowOrder>>>16)+(Oe.lowOrder>>>16)+(Ye.lowOrder>>>16)+(Fe.lowOrder>>>16)+(Ke>>>16),ct=(tt&65535)<<16|Ke&65535,Ke=(Ie.highOrder&65535)+(Oe.highOrder&65535)+(Ye.highOrder&65535)+(Fe.highOrder&65535)+(tt>>>16),tt=(Ie.highOrder>>>16)+(Oe.highOrder>>>16)+(Ye.highOrder>>>16)+(Fe.highOrder>>>16)+(Ke>>>16),te=(tt&65535)<<16|Ke&65535,new a(te,ct)}function Ee(Ie,Oe,Ye,Fe,Ke){var tt,ct,te,ce;return tt=(Ie.lowOrder&65535)+(Oe.lowOrder&65535)+(Ye.lowOrder&65535)+(Fe.lowOrder&65535)+(Ke.lowOrder&65535),ct=(Ie.lowOrder>>>16)+(Oe.lowOrder>>>16)+(Ye.lowOrder>>>16)+(Fe.lowOrder>>>16)+(Ke.lowOrder>>>16)+(tt>>>16),te=(ct&65535)<<16|tt&65535,tt=(Ie.highOrder&65535)+(Oe.highOrder&65535)+(Ye.highOrder&65535)+(Fe.highOrder&65535)+(Ke.highOrder&65535)+(ct>>>16),ct=(Ie.highOrder>>>16)+(Oe.highOrder>>>16)+(Ye.highOrder>>>16)+(Fe.highOrder>>>16)+(Ke.highOrder>>>16)+(tt>>>16),ce=(ct&65535)<<16|tt&65535,new a(ce,te)}function ye(Ie,Oe,Ye){return new a(Ie.highOrder&Oe.highOrder^Ie.highOrder&Ye.highOrder^Oe.highOrder&Ye.highOrder,Ie.lowOrder&Oe.lowOrder^Ie.lowOrder&Ye.lowOrder^Oe.lowOrder&Ye.lowOrder)}function se(Ie,Oe,Ye){return new a(Ie.highOrder&Oe.highOrder^~Ie.highOrder&Ye.highOrder,Ie.lowOrder&Oe.lowOrder^~Ie.lowOrder&Ye.lowOrder)}function we(Ie,Oe){return Oe<=32?new a(Ie.highOrder>>>Oe|Ie.lowOrder<<32-Oe,Ie.lowOrder>>>Oe|Ie.highOrder<<32-Oe):new a(Ie.lowOrder>>>Oe|Ie.highOrder<<32-Oe,Ie.highOrder>>>Oe|Ie.lowOrder<<32-Oe)}function qe(Ie){var Oe=we(Ie,28),Ye=we(Ie,34),Fe=we(Ie,39);return new a(Oe.highOrder^Ye.highOrder^Fe.highOrder,Oe.lowOrder^Ye.lowOrder^Fe.lowOrder)}function _e(Ie){var Oe=we(Ie,14),Ye=we(Ie,18),Fe=we(Ie,41);return new a(Oe.highOrder^Ye.highOrder^Fe.highOrder,Oe.lowOrder^Ye.lowOrder^Fe.lowOrder)}function Xe(Ie){var Oe=we(Ie,1),Ye=we(Ie,8),Fe=z(Ie,7);return new a(Oe.highOrder^Ye.highOrder^Fe.highOrder,Oe.lowOrder^Ye.lowOrder^Fe.lowOrder)}function at(Ie){var Oe=we(Ie,19),Ye=we(Ie,61),Fe=z(Ie,6);return new a(Oe.highOrder^Ye.highOrder^Fe.highOrder,Oe.lowOrder^Ye.lowOrder^Fe.lowOrder)}function z(Ie,Oe){return Oe<=32?new a(Ie.highOrder>>>Oe,Ie.lowOrder>>>Oe|Ie.highOrder<<32-Oe):new a(0,Ie.highOrder<<32-Oe)}var Le=R(Le),Qe=Le.length*V;Le=Q(Le),Le[Qe>>5]|=128<<24-Qe%32,Le[(Qe+128>>10<<5)+31]=Qe;for(var U=0;U<Le.length;U+=32){m=g[0],f=g[1],j=g[2],C=g[3],b=g[4],T=g[5],O=g[6],F=g[7];for(var B=0;B<80;B++)B<16?H[B]=new a(Le[B*2+U],Le[B*2+U+1]):H[B]=be(at(H[B-2]),H[B-7],Xe(H[B-15]),H[B-16]),I=Ee(F,_e(b),se(b,T,O),D[B],H[B]),P=oe(qe(m),ye(m,f,j)),F=O,O=T,T=b,b=oe(C,I),C=j,j=f,f=m,m=oe(I,P);g[0]=oe(m,g[0]),g[1]=oe(f,g[1]),g[2]=oe(j,g[2]),g[3]=oe(C,g[3]),g[4]=oe(b,g[4]),g[5]=oe(T,g[5]),g[6]=oe(O,g[6]),g[7]=oe(F,g[7])}for(var ft=[],U=0;U<g.length;U++)ft.push(g[U].highOrder),ft.push(g[U].lowOrder);return de(ft)}})}},s={};function h(L){var c=s[L];if(c!==void 0)return c.exports;var a=s[L]={exports:{}};return o[L].call(a.exports,a,a.exports,h),a.exports}(function(){h.n=function(L){var c=L&&L.__esModule?function(){return L.default}:function(){return L};return h.d(c,{a:c}),c}})(),function(){h.d=function(L,c){for(var a in c)h.o(c,a)&&!h.o(L,a)&&Object.defineProperty(L,a,{enumerable:!0,get:c[a]})}}(),function(){h.o=function(L,c){return Object.prototype.hasOwnProperty.call(L,c)}}();var w={};return function(){h.d(w,{default:function(){return Ue}});var L={};L.two=function(E){return E=""+E,E.length==1&&(E="0"+E),E},L.focus=function(E){if(E.innerText.length){var M=document.createRange(),d=window.getSelection(),l=E.childNodes[E.childNodes.length-1];M.setStart(l,l.length),M.collapse(!0),d.removeAllRanges(),d.addRange(M),E.scrollLeft=E.scrollWidth}},L.isNumeric=function(E){return typeof E=="string"&&(E=E.trim()),!isNaN(E)&&E!==null&&E!==""},L.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(E){var M=Math.random()*16|0,d=E=="x"?M:M&3|8;return d.toString(16)})},L.getNode=function(){var E=document.getSelection().anchorNode;return E?E.nodeType==3?E.parentNode:E:null},L.hash=function(E){var M=0,d,l;if(E.length===0)return M;for(d=0;d<E.length;d++)l=E.charCodeAt(d),l>32&&(M=(M<<5)-M+l,M|=0);return M},L.randomColor=function(E){var M=-.25,d=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");d.length<6&&(d=d[0]+d[0]+d[1]+d[1]+d[2]+d[2]);var l=[],_,G;for(G=0;G<3;G++)_=parseInt(d.substr(G*2,2),16),_=Math.round(Math.min(Math.max(0,_+_*M),255)).toString(16),l.push(("00"+_).substr(_.length));return E==!0?"#"+L.two(l[0].toString(16))+L.two(l[1].toString(16))+L.two(l[2].toString(16)):l},L.getWindowWidth=function(){var E=window,M=document,d=M.documentElement,l=M.getElementsByTagName("body")[0],_=E.innerWidth||d.clientWidth||l.clientWidth;return _},L.getWindowHeight=function(){var E=window,M=document,d=M.documentElement,l=M.getElementsByTagName("body")[0],_=E.innerHeight||d.clientHeight||l.clientHeight;return _},L.getPosition=function(E){if(E.changedTouches&&E.changedTouches[0])var M=E.changedTouches[0].pageX,d=E.changedTouches[0].pageY;else var M=window.Event?E.pageX:E.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),d=window.Event?E.pageY:E.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[M,d]},L.click=function(E){if(E.click)E.click();else{var M=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});E.dispatchEvent(M)}},L.findElement=function(E,M){var d=!1;function l(_){_&&!d&&(typeof M=="function"?d=M(_):typeof M=="string"&&_.classList&&_.classList.contains(M)&&(d=_)),_.parentNode&&!d&&l(_.parentNode)}return l(E),d};var c=L;function a(){var E={};E.now=function(_,G){var ne=null,k=null,S=null,Y=null,J=null,ie=null;return Array.isArray(_)?(ne=_[0],k=_[1],S=_[2],Y=_[3],J=_[4],ie=_[5]):(_||(_=new Date),ne=_.getFullYear(),k=_.getMonth()+1,S=_.getDate(),Y=_.getHours(),J=_.getMinutes(),ie=_.getSeconds()),G==!0?c.two(ne)+"-"+c.two(k)+"-"+c.two(S):c.two(ne)+"-"+c.two(k)+"-"+c.two(S)+" "+c.two(Y)+":"+c.two(J)+":"+c.two(ie)},E.toArray=function(_){var ne=_.split(_.indexOf("T")!==-1?"T":" "),G=ne[1],ne=ne[0].split("-"),k=parseInt(ne[0]),S=parseInt(ne[1]),Y=parseInt(ne[2]),J=0,ie=0;return G&&(G=G.split(":"),J=parseInt(G[0]),ie=parseInt(G[1])),[k,S,Y,J,ie,0]};var M=Date.UTC(1900,0,0),d=Date.UTC(1900,1,29),l=864e5;return E.dateToNum=function(_){typeof _=="string"&&(_=new Date(_+"  GMT+0"));var G=_.getTime();return G>=d&&(G+=l),G-=M,G/l},E.numToDate=function(_){var G=M+_*l;G>=d&&(G-=l);const ne=new Date(G);var k=[ne.getUTCFullYear(),ne.getUTCMonth()+1,ne.getUTCDate(),ne.getUTCHours(),ne.getUTCMinutes(),ne.getUTCSeconds()];return E.now(k)},E.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],E.months=["January","February","March","April","May","June","July","August","September","October","November","December"],E.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],E}var g=a(),D=function(E){document.dictionary||(document.dictionary={});var M=null,d=null,l=Object.keys(E);for(d=0;d<l.length;d++)document.dictionary[l[d]]=E[l[d]];for(d=0;d<g.weekdays.length;d++)M=H(g.weekdays[d]),g.weekdays[d]&&(g.weekdays[d]=M,g.weekdaysShort[d]=M.substr(0,3));for(d=0;d<g.months.length;d++)M=H(g.months[d]),M&&(g.months[d]=M,g.monthsShort[d]=M.substr(0,3))},H=function(E){return typeof document<"u"&&document.dictionary&&document.dictionary[E]||E},m={setDictionary:D,translate:H};function f(E,M){if(M==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(l){return l!==null}),setTimeout(function(){document.jsuitesComponents.push(E)},0);else{var d=document.jsuitesComponents.indexOf(E);d>=0&&document.jsuitesComponents.splice(d,1)}}function j(E,M,d){if(E=E.split("."),E.length){let l=this,_=null;for(;E.length>1;)if(_=E.shift(),l.hasOwnProperty(_))l=l[_];else{if(typeof M>"u")return;l[_]={},l=l[_]}if(_=E.shift(),typeof M<"u")return d===!0?delete l[_]:l[_]=M,!0;if(l)return l[_]}return!1}function C(E,M){var d={};d.options={};var l={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},_=null;for(var G in l)M&&M.hasOwnProperty(G)?d.options[G]=M[G]:d.options[G]=l[G];E.classList.add("jsorting"),E.addEventListener("dragstart",function(S){let Y=S.target;if(Y.nodeType===3)if(Y.parentNode.getAttribute("draggable")==="true")Y=Y.parentNode;else{S.preventDefault(),S.stopPropagation();return}if(Y.getAttribute("draggable")==="true"){let J=Array.prototype.indexOf.call(Y.parentNode.children,Y);_={element:Y,o:J,d:J},Y.style.opacity="0.25",typeof d.options.ondragstart=="function"&&d.options.ondragstart(E,Y,S),S.dataTransfer.setDragImage(Y,0,0)}}),E.addEventListener("dragover",function(S){if(S.preventDefault(),_&&ne(S.target)&&S.target.getAttribute("draggable")=="true"&&_.element!=S.target){if(d.options.direction)var Y=S.target.clientWidth/2>S.offsetX;else var Y=S.target.clientHeight/2>S.offsetY;Y?S.target.parentNode.insertBefore(_.element,S.target):S.target.parentNode.insertBefore(_.element,S.target.nextSibling),_.d=Array.prototype.indexOf.call(S.target.parentNode.children,_.element)}}),E.addEventListener("dragleave",function(S){S.preventDefault()}),E.addEventListener("dragend",function(S){S.preventDefault(),_&&(typeof d.options.ondragend=="function"&&d.options.ondragend(E,_.element,S),_.o<_.d?S.target.parentNode.insertBefore(_.element,S.target.parentNode.children[_.o]):S.target.parentNode.insertBefore(_.element,S.target.parentNode.children[_.o].nextSibling),_.element.style.opacity="",_=null)}),E.addEventListener("drop",function(S){S.preventDefault(),_&&(_.o!==_.d&&typeof d.options.ondrop=="function"&&d.options.ondrop(E,_.o,_.d,_.element,S.target,S),_.element.style.opacity="",_=null)});for(var ne=function(S){var Y=!1;function J(ie){ie.className&&ie.classList.contains("jsorting")&&(Y=!0),Y||J(ie.parentNode)}return J(S),Y},k=0;k<E.children.length;k++)E.children[k].hasAttribute("draggable")||E.children[k].setAttribute("draggable","true");return E.val=function(){for(var S=null,Y=[],J=0;J<E.children.length;J++)(S=E.children[J].getAttribute("data-id"))&&Y.push(S);return Y},E}function b(E,M){var d={};(!M.loadUp||typeof M.loadUp!="function")&&(M.loadUp=function(){return!1}),(!M.loadDown||typeof M.loadDown!="function")&&(M.loadDown=function(){return!1}),M.timer||(M.timer=100);var l=null,_=function(G){if(l==null){var ne=!1,k=E.scrollTop;E.scrollTop+E.clientHeight*2>=E.scrollHeight?M.loadDown()&&(k==E.scrollTop&&(E.scrollTop=E.scrollTop-E.clientHeight),ne=!0):E.scrollTop<=E.clientHeight&&M.loadUp()&&(k==E.scrollTop&&(E.scrollTop=E.scrollTop+E.clientHeight),ne=!0),l=setTimeout(function(){l=null},M.timer),ne&&typeof M.onupdate=="function"&&M.onupdate()}};return E.onscroll=function(G){_()},E.onwheel=function(G){_()},d}function T(){var E=function(M,d){if(Array.isArray(M)){var l={instance:[],complete:d};if(M.length>0)for(var _=0;_<M.length;_++)M[_].multiple=l,l.instance.push(E(M[_]));return l}if(M.data||(M.data={}),M.type&&(M.method=M.type),M.method||(M.method="GET"),M.dataType||(M.dataType="json"),M.data){var G=function(ie,xe){var ge=[];if(ie){var fe=Object.keys(ie);if(fe.length)for(var Re=0;Re<fe.length;Re++){if(xe)var We=xe+"["+fe[Re]+"]";else var We=fe[Re];if(ie[We]instanceof FileList)ge[We]=ie[fe[Re]];else if(ie[fe[Re]]===null||ie[fe[Re]]===void 0)ge[We]="";else if(typeof ie[fe[Re]]=="object")for(var Je=G(ie[fe[Re]],We),Me=Object.keys(Je),ze=0;ze<Me.length;ze++)ge[Me[ze]]=Je[Me[ze]];else ge[We]=ie[fe[Re]]}}return ge},ne=G(M.data),k=Object.keys(ne);if(M.method=="GET"){if(k.length){for(var S=[],_=0;_<k.length;_++)S.push(k[_]+"="+encodeURIComponent(ne[k[_]]));M.url.indexOf("?")<0&&(M.url+="?"),M.url+=S.join("&")}}else for(var S=new FormData,_=0;_<k.length;_++)if(ne[k[_]]instanceof FileList){if(ne[k[_]].length)for(var Y=0;Y<ne[k[_]].length;Y++)S.append(k[_],ne[k[_]][Y],ne[k[_]][Y].name)}else S.append(k[_],ne[k[_]])}var J=new XMLHttpRequest;return J.open(M.method,M.url,!0),J.setRequestHeader("X-Requested-With","XMLHttpRequest"),M.contentType&&J.setRequestHeader("Content-Type",M.contentType),M.method==="POST"?J.setRequestHeader("Accept","application/json"):M.dataType==="blob"?J.responseType="blob":M.contentType||(M.dataType==="json"?J.setRequestHeader("Content-Type","text/json"):M.dataType==="html"&&J.setRequestHeader("Content-Type","text/html")),M.cache!==!0&&(J.setRequestHeader("pragma","no-cache"),J.setRequestHeader("cache-control","no-cache")),M.withCredentials===!0&&(J.withCredentials=!0),typeof M.beforeSend=="function"&&M.beforeSend(J),typeof E.beforeSend=="function"&&E.beforeSend(J),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(J),J.onload=function(){if(J.status>=200&&J.status<300)if(M.dataType==="json")try{var ie=JSON.parse(J.responseText);M.success&&typeof M.success=="function"&&M.success(ie)}catch(ge){M.error&&typeof M.error=="function"&&M.error(ge,ie)}else{if(M.dataType==="blob")var ie=J.response;else var ie=J.responseText;M.success&&typeof M.success=="function"&&M.success(ie)}else M.error&&typeof M.error=="function"&&M.error(J.responseText,J.status);if(E.queue&&E.queue.length>0&&E.send(E.queue.shift()),E.requests&&E.requests.length){var xe=E.requests.indexOf(J);if(E.requests.splice(xe,1),E.requests.length||M.complete&&typeof M.complete=="function"&&M.complete(ie),M.group&&E.oncomplete&&typeof E.oncomplete[M.group]=="function"&&(E.pending(M.group)||(E.oncomplete[M.group](),E.oncomplete[M.group]=null)),M.multiple&&M.multiple.instance){var xe=M.multiple.instance.indexOf(J);M.multiple.instance.splice(xe,1),M.multiple.instance.length||M.multiple.complete&&typeof M.multiple.complete=="function"&&M.multiple.complete(ie)}}},J.options=M,J.data=S,M.queue===!0&&E.requests.length>0?E.queue.push(J):E.send(J),J};return E.send=function(M){M.data?Array.isArray(M.data)?M.send(M.data.join("&")):M.send(M.data):M.send(),E.requests.push(M)},E.exists=function(M,d){var l=new XMLHttpRequest;l.open("HEAD",M,!1),l.send(),l.status&&d(l.status)},E.pending=function(M){var d=0,l=E.requests;if(l&&l.length)for(var _=0;_<l.length;_++)(!M||M==l[_].options.group)&&d++;return d},E.oncomplete={},E.requests=[],E.queue=[],E}var O=T();function F(){const E={loading:{}};return E.loading.show=function(M){E.loading.element||(E.loading.element=document.createElement("div"),E.loading.element.className="jloading"),document.body.appendChild(E.loading.element),M>0&&setTimeout(function(){E.loading.hide()},M*1e3)},E.loading.hide=function(){E.loading.element&&E.loading.element.parentNode&&document.body.removeChild(E.loading.element)},E.slideLeft=function(M,d,l){d==!0?(M.classList.add("jslide-left-in"),setTimeout(function(){M.classList.remove("jslide-left-in"),typeof l=="function"&&l()},400)):(M.classList.add("jslide-left-out"),setTimeout(function(){M.classList.remove("jslide-left-out"),typeof l=="function"&&l()},400))},E.slideRight=function(M,d,l){d===!0?(M.classList.add("jslide-right-in"),setTimeout(function(){M.classList.remove("jslide-right-in"),typeof l=="function"&&l()},400)):(M.classList.add("jslide-right-out"),setTimeout(function(){M.classList.remove("jslide-right-out"),typeof l=="function"&&l()},400))},E.slideTop=function(M,d,l){d===!0?(M.classList.add("jslide-top-in"),setTimeout(function(){M.classList.remove("jslide-top-in"),typeof l=="function"&&l()},400)):(M.classList.add("jslide-top-out"),setTimeout(function(){M.classList.remove("jslide-top-out"),typeof l=="function"&&l()},400))},E.slideBottom=function(M,d,l){d===!0?(M.classList.add("jslide-bottom-in"),setTimeout(function(){M.classList.remove("jslide-bottom-in"),typeof l=="function"&&l()},400)):(M.classList.add("jslide-bottom-out"),setTimeout(function(){M.classList.remove("jslide-bottom-out"),typeof l=="function"&&l()},100))},E.fadeIn=function(M,d){M.style.display="",M.classList.add("jfade-in"),setTimeout(function(){M.classList.remove("jfade-in"),typeof d=="function"&&d()},2e3)},E.fadeOut=function(M,d){M.classList.add("jfade-out"),setTimeout(function(){M.style.display="none",M.classList.remove("jfade-out"),typeof d=="function"&&d()},1e3)},E}var U=F();function B(){var E={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},M=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var A=0;this.date[4]&&(A=parseFloat(this.date[4]/60));var W=parseInt(this.date[3])+A;W/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?W=c.two(this.date[3])+":"+c.two(this.date[4])+":"+c.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),W=c.two(this.date[0])+"-"+c.two(this.date[1])+"-"+c.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(W+=" "+c.two(this.date[3])+":"+c.two(this.date[4])+":"+c.two(this.date[5])));return W},d=function(){var A="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)A=parseInt(this.date[3]);else{let ee=parseInt(this.date[3]);ee<13&&this.values.indexOf("PM")!==-1?A=(ee+12)%24:A=ee%24}this.date[4]&&(A+=parseFloat(this.date[4]/60)),this.date[5]&&(A+=parseFloat(this.date[5]/3600)),A/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var W=g.now(this.date);A=g.dateToNum(W),this.date[4]&&(A+=parseFloat(this.date[4]/60))}return isNaN(A)&&(A=""),A},l=function(A){return A===null||A===""||A===void 0},_=function(A){var W=(""+A)[0];return W=="="},G=function(A){return A==="currency"||A==="percentage"||A==="numeric"},ne=function(A){if(A&&Number(A)==A)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var W=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=W[1]}else{A||(A=this.mask);var ee=new RegExp("0{1}(.{1})0+","ig"),W=ee.exec(A);if(W&&W[1]&&W[1].length==1)return this.options.decimal=W[1],W[1];var ee=new RegExp("#{1}(.{1})#+","ig"),W=ee.exec(A);W&&W[1]&&W[1].length==1?W[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},k=function(A,W){if(A=="")return"";W||(W=ne.call(this)),A=(""+A).split(W);var ee=A[0].match(/[-]+/g);if(ee&&ee.length?ee=!0:ee=!1,A[0]=A[0].match(/[0-9]+/g),A[0]?(ee&&A[0].unshift("-"),A[0]=A[0].join("")):ee&&(A[0]="-"),A[0]||A[1])A[1]!==void 0&&(A[1]=A[1].match(/[0-9]+/g),A[1]?A[1]=A[1].join(""):A[1]="");else return"";return A},S=function(A,W){if(A==="")return"";var ee=ne.call(this),me=this.options;if(A=k.call(this,A),A==="")return"";var re=null;if(A[0]&&(me.style==="percent"?re=parseFloat(A[0])/100:re=parseFloat(A[0]+".1")),(A[0]==="-"||A[0]==="-00")&&!A[1]&&W&&W.inputType=="deleteContentBackward")return"";var he=new Intl.NumberFormat(this.locale,me).format(re);if(he=he.split(ee),me.style==="percent"&&he[0].indexOf("%")!==-1&&(he[0]=he[0].replace("%",""),he[2]="%"),typeof he[1]<"u"){var Te=he[1].replace(/[0-9]*/g,"");Te&&(he[2]=Te)}return A[1]!==void 0?he[1]=ee+A[1]:he[1]="",he.join("")},Y=function(A,W){var ee=xe.call(A);if(ee){var me=S.call(this,ee,W),re=me.length-ee.length,he=ie.call(A)+re;xe.call(A,me,he,!0)}},J=function(A){var W=k.call(this,A);return W?(W[0]==="-"&&(W[0]="-0"),parseFloat(W.join("."))):null},ie=function(A,W){if(A===void 0)if(this.tagName=="DIV"){var ee=0,me=window.getSelection();if(me&&me.rangeCount!==0){var re=me.getRangeAt(0),he=re.cloneRange();he.selectNodeContents(this),he.setEnd(re.endContainer,re.endOffset),ee=he.toString().length}return ee}else return this.selectionStart;else{var Te=xe.call(this);if(W){for(var he=null,Ge=0;Ge<Te.length;Ge++)(Te[Ge].match(/[\-0-9]/g)||Te[Ge]==="."||Te[Ge]===",")&&(he=Ge);he===null&&(he=Te.indexOf(" ")),A>=he&&(A=he+1)}if(A>Te.length&&(A=Te.length),A)if(this.tagName=="DIV"){var me=window.getSelection(),re=document.createRange();this.childNodes[0]&&(re.setStart(this.childNodes[0],A),me.removeAllRanges(),me.addRange(re))}else this.selectionStart=A,this.selectionEnd=A}},xe=function(A,W,ee){if(this.tagName=="DIV")if(A===void 0){var A=this.innerText;return this.value&&this.value.length>A.length&&(A=this.value),A}else this.innerText!==A&&(this.innerText=A,W&&ie.call(this,W,ee));else{if(A===void 0)return this.value;this.value!==A&&(this.value=A,W&&ie.call(this,W,ee))}},ge=g.weekdays,fe=g.weekdaysShort,Re=g.months,We=g.monthsShort,Je={YEAR:function(A,W){var ee=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<=10&&this.values[this.index].length<W&&(this.values[this.index]+=A),this.values[this.index].length==W){if(W==2)var ee=ee.substr(0,2)+this.values[this.index];else if(W==3)var ee=ee.substr(0,1)+this.values[this.index];else if(W==4)var ee=this.values[this.index];this.date[0]=ee,this.index++}},YYYY:function(A){Je.YEAR.call(this,A,4)},YYY:function(A){Je.YEAR.call(this,A,3)},YY:function(A){Je.YEAR.call(this,A,2)},FIND:function(A,W){if(l(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=A;return}for(var ee=0,me=0,re=(this.values[this.index]+A).toLowerCase(),he=0;he<W.length;he++)W[he].toLowerCase().indexOf(re)==0&&(ee=he,me++);if(me>1)this.values[this.index]+=A;else if(me==1){var Te=W[ee].length-this.values[this.index].length-1;return this.position+=Te,this.values[this.index]=W[ee],this.index++,ee}},MMM:function(A){var W=Je.FIND.call(this,A,We);W!==void 0&&(this.date[1]=W+1)},MON:function(A){Je.MMM.call(this,A)},MMMM:function(A){var W=Je.FIND.call(this,A,Re);W!==void 0&&(this.date[1]=W+1)},MONTH:function(A){Je.MMMM.call(this,A)},MMMMM:function(A){l(this.values[this.index])&&(this.values[this.index]="");for(var W=(this.values[this.index]+A).toLowerCase(),ee=0;ee<Re.length;ee++)if(Re[ee][0].toLowerCase().indexOf(W)==0){this.values[this.index]=Re[ee][0],this.date[1]=ee+1,this.index++;break}},MM:function(A){l(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(this.date[1]=this.values[this.index]="0"+A,this.index++):parseInt(A)<2&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[1]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[1]=this.values[this.index]+=A,this.index++)},M:function(A){var W=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(l(this.values[this.index]))this.values[this.index]=A,A>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(A)<3)this.date[1]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[1]=this.values[this.index]+=A,this.index++;else var W=!0;else var W=!0;if(W==!0){var ee=parseInt(this.values[this.index]);ee>0&&ee<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(A){var W=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(l(this.values[this.index]))this.values[this.index]=A,parseInt(A)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(A)<2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[2]=this.values[this.index]+=A,this.index++;else var W=!0;else var W=!0;if(W==!0){var ee=parseInt(this.values[this.index]);ee>0&&ee<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(A){l(this.values[this.index])?parseInt(A)>3&&parseInt(A)<10?(this.date[2]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==3&&parseInt(A)<2?(this.date[2]=this.values[this.index]+=A,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(A)<10?(this.date[2]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[2]=this.values[this.index]+=A,this.index++)},DDD:function(A){Je.FIND.call(this,A,fe)},DY:function(A){Je.DDD.call(this,A)},DDDD:function(A){Je.FIND.call(this,A,ge)},DAY:function(A){Je.DDDD.call(this,A)},HH12:function(A,W){l(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(W&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<1&&parseInt(A)<10&&(this.date[3]=this.values[this.index]+=A,this.index++)},HH24:function(A,W){parseInt(A)>=0&&parseInt(A)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>2&&parseInt(A)<10?(W&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==2&&parseInt(A)<4?(!W&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<2&&parseInt(A)<10&&(!W&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=A,this.index++))},HH:function(A){Je.HH24.call(this,A,1)},H:function(A){Je.HH24.call(this,A,0)},"\\[H\\]":function(A){this.values[this.index]==null&&(this.values[this.index]=""),A.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=A:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(A,W){this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>5&&parseInt(A)<10?(this.date[W]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):parseInt(A)<10&&(this.date[W]=this.values[this.index]+=A,this.index++)},MI:function(A){Je.N60.call(this,A,4)},SS:function(A){Je.N60.call(this,A,5)},"AM/PM":function(A){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?A.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":A.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(A){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<7&&(this.values[this.index]=A),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(A){var W=ne.call(this),ee=!1;l(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(ee=!0);var me=k.call(this,this.values[this.index],W);me&&(this.values[this.index]=me.join(W)),parseInt(A)>=0&&parseInt(A)<10?(this.values[this.index]=="0"&&A>0?this.values[this.index]="":this.values[this.index]=="-0"&&A>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||A==W)&&(this.values[this.index]+=A)):W&&A==W?this.values[this.index].indexOf(W)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=A):A=="-"&&(ee=!0),ee===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(A){Je["0{1}(.{1}0+)?"].call(this,A),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(A){Je["0{1}(.{1}0+)?"].call(this,A);var W=ne.call(this),ee=this.tokens[this.index].substr(1,1),me=this.values[this.index][0]==="-",re=k.call(this,this.values[this.index],W);if(re!==""){var he=re[0].match(/[0-9]/g);if(he){he=he.join("");for(var Te=[],Ge=0,De=he.length-1;De>=0;De--)Te.push(he[De]),Ge++,Ge%3||Te.push(ee);Te=Te.reverse(),re[0]=Te.join(""),re[0].substr(0,1)==ee&&(re[0]=re[0].substr(1))}else re[0]="";this.values[this.index]=re.join(W),me&&(this.values[this.index]="-"+this.values[this.index])}},0:function(A){A.match(/[0-9]/g)&&(this.values[this.index]=A,this.index++)},"[0-9a-zA-Z$]+":function(A){l(this.values[this.index])&&(this.values[this.index]="");var W=this.tokens[this.index],ee=this.values[this.index],me=ee.length;W[me]==A?(this.values[this.index]+=A,this.values[this.index]==W&&this.index++):(this.values[this.index]=W,this.index++,A.match(/[\-0-9]/g)&&this.position--)},A:function(A){A.match(/[a-zA-Z]/gi)&&(this.values[this.index]=A,this.index++)},".":function(A){Je["[0-9a-zA-Z$]+"].call(this,A)},"@":function(A){l(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=A}},Me=function(A){if(this.type=="general")var W=[].concat(E.general);else var W=[].concat(E.currency,E.datetime,E.percentage,E.numeric,E.text,E.general);var ee=new RegExp(W.join("|"),"gi");return A.match(ee)},ze=function(A){if(this.type)if(this.type=="text")var W=["text"];else if(this.type=="general")var W=["general"];else if(this.type=="datetime")var W=["numeric","datetime","general"];else var W=["currency","percentage","numeric","general"];else var W=Object.keys(E);for(var ee=0;ee<W.length;ee++)for(var me=W[ee],re=0;re<E[me].length;re++){var he=new RegExp(E[me][re],"gi"),Te=A.match(he);if(Te)return{type:me,method:E[me][re]}}},pe=function(A){for(var W=[],ee=0;ee<A.length;ee++){var me=ze.call(this,A[ee]);me?W.push(me.method):W.push(null)}for(var ee=0;ee<W.length;ee++)W[ee]=="MM"&&(W[ee-1]&&W[ee-1].indexOf("H")>=0||W[ee-2]&&W[ee-2].indexOf("H")>=0||W[ee+1]&&W[ee+1].indexOf("S")>=0||W[ee+2]&&W[ee+2].indexOf("S")>=0)&&(W[ee]="MI");return W},He=function(A){var W=ze.call(this,A);if(W)var ee=W.type;if(ee){for(var me=0,re=Me.call(this,A),he=0;he<re.length;he++)W=ze.call(this,re[he]),W&&G(W.type)&&me++;me>1&&(ee="general")}return ee},Z=function(){typeof Je[this.methods[this.index]]=="function"?(Je[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},K=function(A){return(""+ +A).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(W,ee,me,re,he){return he<0?ee+"0."+Array(1-he-me.length).join(0)+me+re:ee+me+re+Array(he-re.length+1).join(0)})},ae=function(A,W,ee){var me=null,re={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof A=="object"){if(re.input=A.target,re.value=xe.call(A.target),re.caret=ie.call(A.target),(me=A.target.getAttribute("data-mask"))&&(re.mask=me),(me=A.target.getAttribute("data-type"))&&(re.type=me),A.target.mask?(A.target.mask.options&&(re.options=A.target.mask.options),A.target.mask.locale&&(re.locale=A.target.mask.locale)):(me=A.target.getAttribute("data-locale"))&&(re.locale=me,re.mask&&(re.options.style=re.mask)),A.target.attributes&&A.target.attributes.length)for(var he=0;he<A.target.attributes.length;he++){var Te=A.target.attributes[he].name,Ge=A.target.attributes[he].value;Te.substr(0,4)=="data"&&(re.options[Te.substr(5)]=Ge)}}else{if(typeof W=="string")re.mask=W;else for(var Te=Object.keys(W),he=0;he<Te.length;he++)re[Te[he]]=W[Te[he]];typeof A=="number"&&(ne.call(re,re.mask),A=(""+A).replace(".",re.options.decimal)),re.value=A,re.input&&(xe.call(re.input,A),c.focus(re.input),re.caret=ie.call(re.input))}if(!_(re.value)&&(re.mask||re.locale)){if(re.mask){if(re.mask=re.mask.replace(new RegExp(/\[h]/),"|h|"),re.mask=re.mask.replace(new RegExp(/\[.*?\]/),""),re.mask=re.mask.replace(new RegExp(/\|h\|/),"[h]"),re.mask.indexOf(";")!==-1){var me=re.mask.split(";");re.mask=me[0]}if(re.mask.indexOf("##")!==-1){var De=re.mask.split(";");De[0]&&(typeof A=="object"&&(De[0]=De[0].replace(new RegExp(/_\)/g),""),De[0]=De[0].replace(new RegExp(/_\(/g),"")),De[0]=De[0].replace("*","	"),De[0]=De[0].replace(new RegExp(/_-/g),""),De[0]=De[0].replace(new RegExp(/_/g),""),De[0]=De[0].replace(new RegExp(/"/g),""),De[0]=De[0].replace("##0.###","##0.000"),De[0]=De[0].replace("##0.##","##0.00"),De[0]=De[0].replace("##0.#","##0.0"),De[0]=De[0].replace("##0,###","##0,000"),De[0]=De[0].replace("##0,##","##0,00"),De[0]=De[0].replace("##0,#","##0,0")),re.mask=De[0]}if(re.mask.indexOf("\\")!==-1){var De=re.mask.split(";");De[0]=De[0].replace(new RegExp(/\\/g),""),re.mask=De[0]}re.type||(re.type=He.call(re,re.mask)),re.tokens=Me.call(re,re.mask)}if(typeof A!="object"||!A.inputType||!A.inputType.indexOf("insert")||!A.inputType.indexOf("delete"))if(re.locale)if(re.input)Y.call(re,re.input,A);else var Ze=S.call(re,re.value);else{for(re.methods=pe.call(re,re.tokens),re.event=A;re.position<re.value.length&&typeof re.tokens[re.index]<"u";)Z.call(re);var Ze=re.values.join("");if(G(re.type)&&Ze!==""){for(;typeof re.tokens[re.index]<"u";){var me=ze.call(re,re.tokens[re.index]);me&&me.type=="general"&&(re.values[re.index]=re.tokens[re.index]),re.index++}var it=!0}else var it=!1;if(Ze=re.values.join(""),re.input){if(me=Ze.length-re.value.length,me>0)var dt=re.caret+me;else var dt=re.caret;xe.call(re.input,Ze,dt,it)}}if(re.input){var le=null;if(G(re.type)){let Ae=xe.call(re.input);re.number=J.call(re,Ae),re.type=="percentage"&&Ae.indexOf("%")!==-1?le=ae.adjustPrecision(re.number/100):le=re.number}else re.type=="datetime"&&(le=M.call(re),re.date[0]&&re.date[1]&&re.date[2]&&re.input.setAttribute("data-completed",!0));le&&re.input.setAttribute("data-value",le)}if(Ze!==void 0)return ee?re:Ze}};return ae.adjustPrecision=function(A){if(typeof A=="number"&&!Number.isInteger(A)){const W=A.toString().split(".");if(W[1]&&W[1].length>10){let ee=0;const me=W[1][W[1].length-2];if(me==0||me==9){for(let re=W[1].length-2;re>0;re--)if(ee>=0&&W[1][re]==me){if(ee++,ee>6)break}else{ee=0;break}if(ee)return parseFloat(parseFloat(A).toFixed(W[1].length-1))}}}return A},ae.getType=He,ae.prepare=function(A,W){return W||(W={}),Me.call(W,A)},ae.apply=function(A){var W=xe.call(A.target);A.key.length==1&&(W+=A.key),xe.call(A.target,ae(W,A.target.getAttribute("data-mask")))},ae.run=function(A,W,ee){return ae(A,{mask:W,decimal:ee})},ae.extract=function(A,W,ee){if(l(A)||typeof W!="object")return A;if(W=Object.assign({},W),W.options||(W.options={}),!W.mask&&W.format&&(W.mask=W.format),W.mask){if(W.mask.indexOf(";")!==-1){var me=W.mask.split(";");W.mask=me[0]}W.mask=W.mask.replace(new RegExp(/\[h]/),"|h|"),W.mask=W.mask.replace(new RegExp(/\[.*?\]/),""),W.mask=W.mask.replace(new RegExp(/\|h\|/),"[h]")}ne.call(W,W.mask);var re=null,he=null;if(W.type=="percent"||W.options.style=="percent"?re="percentage":W.mask&&(re=He.call(W,W.mask)),re==="general"){var Te=ae(A,W,!0);he=A}else if(re==="datetime"){A instanceof Date&&(A=ae.getDateString(A,W.mask));var Te=ae(A,W,!0);c.isNumeric(A)?he=A:he=d.call(Te)}else{he=J.call(W,A),re==="percentage"&&A.indexOf("%")!==-1&&(he/=100);var Te=W}return Te.value=he,!Te.type&&re&&(Te.type=re),ee?Te:he},ae.render=function(A,W,ee){if(l(A)||typeof W!="object")return A;if(W=Object.assign({},W),W.options||(W.options={}),!W.mask&&W.format&&(W.mask=W.format),W.mask){if(W.mask.indexOf(";")!==-1){var me=W.mask.split(";");ee||(me[0]=me[0].replace(new RegExp(/_\)/g),""),me[0]=me[0].replace(new RegExp(/_\(/g),"")),W.mask=me[0]}W.mask=W.mask.replace(new RegExp(/\[h]/),"|h|"),W.mask=W.mask.replace(new RegExp(/\[.*?\]/),""),W.mask=W.mask.replace(new RegExp(/\|h\|/),"[h]")}var re=null;W.type=="percent"||W.options.style=="percent"?re="percentage":W.mask?re=He.call(W,W.mask):A instanceof Date&&(re="datetime");var he=!1;if(re=="datetime"||W.type=="calendar"){var me=ae.getDateString(A,W.mask);me&&(A=me),W.mask&&ee&&(he=!0)}else if(re==="percentage"&&(A=ae.adjustPrecision(A*100)),typeof A=="number"){var me=null;if(W.mask&&ee&&(""+A).indexOf("e")===-1){var Te=ne.call(W,W.mask);if(W.mask.indexOf(Te)!==-1){Te=W.mask.split(Te),Te=""+Te[1].match(/[0-9]+/g),Te=Te.length,me=A.toFixed(Te);let Ae=A.toString().split("."),Ne=Ae[1];Ne&&Ne.length>Te&&Ne[Ne.length-1]==="5"?me=parseFloat(Ae[0]+"."+Ne+"1").toFixed(Te):me=A.toFixed(Te)}else me=A.toFixed(0)}else if(W.locale&&ee){var Te=(""+A).split(".");if(W.options){typeof Te[1]>"u"&&(Te[1]="");var De=Te[1].length;if(W.options.minimumFractionDigits>De)for(var Ge=0;Ge<W.options.minimumFractionDigits-De;Ge++)Te[1]+="0"}Te[1].length?me=Te.join("."):me=Te[0];var De=Te[1].length;W.options&&W.options.maximumFractionDigits<De&&(me=parseFloat(me).toFixed(W.options.maximumFractionDigits))}else me=K(A);me!==null&&(A=me,ne.call(W,W.mask),W.options.decimal&&(A=A.replace(".",W.options.decimal)))}else W.mask&&ee&&(he=!0);if(he){var Ze=W.mask.length-A.length;if(Ze>0)for(var Ge=0;Ge<Ze;Ge++)A+=" "}if(A=ae(A,W),ee&&re==="numeric"){var it=W.mask.match(new RegExp(/^[0]+$/gm));if(it&&it.length===1){var dt=it[0].length;if(dt>3)for(A=""+A;A.length<dt;)A="0"+A}}return A},ae.set=function(A,W){if(W){A.setAttribute("data-mask",W);var ee=new Event("input",{bubbles:!0,cancelable:!0});A.dispatchEvent(ee)}},ae.extractDateFromString=function(A,W){var ee=ae(A,{mask:W},!0);if(A>0&&Number(A)==A&&(ee.values.join("")!==ee.value||ee.type=="numeric")){var me=new Date(Math.round((A-25569)*86400*1e3));return me.getFullYear()+"-"+c.two(me.getMonth())+"-"+c.two(me.getDate())+" 00:00:00"}var re=!1;return ee.values.length===ee.tokens.length&&ee.values[ee.values.length-1].length>=ee.tokens[ee.tokens.length-1].length&&(re=!0),ee.date[0]&&ee.date[1]&&(ee.date[2]||re)?(ee.date[2]||(ee.date[2]=1),ee.date[0]+"-"+c.two(ee.date[1])+"-"+c.two(ee.date[2])+" "+c.two(ee.date[3])+":"+c.two(ee.date[4])+":"+c.two(ee.date[5])):""},ae.getDateString=function(A,W){if(!W)var W={};if(W&&typeof W=="object"){if(W.format)var ee=W.format;else if(W.mask)var ee=W.mask}else var ee=W;if(ee||(ee="YYYY-MM-DD"),ee.indexOf("[h]")>=0){var me=0;if(A&&c.isNumeric(A)&&(me=parseFloat(24*Number(A)),ee.indexOf("mm")>=0)){var re=(""+me).split(".");if(re[1]){var he=60*parseFloat("0."+re[1]);he=parseFloat(he.toFixed(2))}else var he=0;me=parseInt(re[0])+":"+c.two(he)}return me}A instanceof Date?A=g.now(A):A&&c.isNumeric(A)&&(A=g.numToDate(A));for(var Te=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Ge=new RegExp(Te.join("|"),"gi"),De=ee.match(Ge),Ze=0;Ze<De.length;Ze++)De[Ze].toUpperCase()=="MM"&&(De[Ze-1]&&De[Ze-1].toUpperCase().indexOf("H")>=0||De[Ze-2]&&De[Ze-2].toUpperCase().indexOf("H")>=0||De[Ze+1]&&De[Ze+1].toUpperCase().indexOf("S")>=0||De[Ze+2]&&De[Ze+2].toUpperCase().indexOf("S")>=0)&&(De[Ze]="mi");var it={tokens:De};if(A){var he=""+A,dt=he.indexOf("T")!==-1?"T":" ";he=he.split(dt);var re=0,le=0,Ae=0;if(he[1]&&(re=he[1].split(":"),le=re[1]?re[1]:0,Ae=re[2]?re[2]:0,re=re[0]?re[0]:0),he=he[0].split("-"),he[0]&&he[1]&&he[2]&&he[0]>0&&he[1]>0&&he[1]<13&&he[2]>0&&he[2]<32){it.data=[he[0],he[1],he[2],re,le,Ae],it.value=[];for(var Ne=new Date(it.data[0],it.data[1]-1,it.data[2],it.data[3],it.data[4],it.data[5]),nt=function(mt){var jt=this.tokens[mt],rt=jt.toUpperCase(),st=null;rt==="YYYY"?st=this.data[0]:rt==="YYY"?st=this.data[0].substring(1,4):rt==="YY"?st=this.data[0].substring(2,4):rt==="Y"?st=this.data[0].substring(3,4):jt==="MON"?st=g.months[Ne.getMonth()].substr(0,3).toUpperCase():jt==="mon"?st=g.months[Ne.getMonth()].substr(0,3).toLowerCase():jt==="MONTH"?st=g.months[Ne.getMonth()].toUpperCase():jt==="month"?st=g.months[Ne.getMonth()].toLowerCase():rt==="MMMMM"?st=g.months[Ne.getMonth()].substr(0,1):rt==="MMMM"||jt==="Month"?st=g.months[Ne.getMonth()]:rt==="MMM"||jt=="Mon"?st=g.months[Ne.getMonth()].substr(0,3):rt==="MM"?st=c.two(this.data[1]):rt==="M"?st=Ne.getMonth()+1:jt==="DAY"?st=g.weekdays[Ne.getDay()].toUpperCase():jt==="day"?st=g.weekdays[Ne.getDay()].toLowerCase():rt==="DDDD"||jt=="Day"?st=g.weekdays[Ne.getDay()]:rt==="DDD"?st=g.weekdays[Ne.getDay()].substr(0,3):rt==="DD"?st=c.two(this.data[2]):rt==="D"?st=parseInt(this.data[2]):rt==="Q"?st=Math.floor((Ne.getMonth()+3)/3):rt==="HH24"||rt==="HH"?(st=this.data[3],st>12&&this.tokens.indexOf("am/pm")!==-1&&(st-=12),st=c.two(st)):rt==="HH12"?this.data[3]>12?st=c.two(this.data[3]-12):st=c.two(this.data[3]):rt==="H"?(st=this.data[3],st>12&&this.tokens.indexOf("am/pm")!==-1&&(st-=12,st=c.two(st))):rt==="MI"?st=c.two(this.data[4]):rt==="SS"?st=c.two(this.data[5]):rt==="MS"?st=Ne.getMilliseconds():rt==="AM/PM"?this.data[3]>=12?st="PM":st="AM":rt==="WD"&&(st=g.weekdays[Ne.getDay()]),st===null?this.value[mt]=this.tokens[mt]:this.value[mt]=st},Ze=0;Ze<it.tokens.length;Ze++)nt.call(it,Ze);A=it.value.join("")}else A=""}return A},ae}var I=B();function P(){var E=function(M,d){if(M.calendar)return M.calendar.setOptions(d,!0);var l={type:"calendar"};l.options={},l.date=null,l.setOptions=function(K,ae){var A={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:g.monthsShort,monthsFull:g.months,weekdays:g.weekdays,textDone:m.translate("Done"),textReset:m.translate("Reset"),textUpdate:m.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var W in A)K&&K.hasOwnProperty(W)?l.options[W]=K[W]:(typeof l.options[W]>"u"||ae===!0)&&(l.options[W]=A[W]);if(l.options.resetButton==!1?S.style.display="none":S.style.display="",l.options.readonly?M.setAttribute("readonly","readonly"):M.removeAttribute("readonly"),l.options.placeholder?M.setAttribute("placeholder",l.options.placeholder):M.removeAttribute("placeholder"),c.isNumeric(l.options.value)&&l.options.value>0&&(l.options.value=E.numToDate(l.options.value),l.options.dataType="numeric"),S.innerHTML=l.options.textReset,Y.innerHTML=l.options.textDone,ze.innerHTML=l.options.textUpdate,M.setAttribute("data-mask",l.options.format.toLowerCase()),!l.options.value&&l.options.today)var ee=E.now();else var ee=l.options.value;return ee&&(l.options.value=null,l.setValue(ee)),l},l.open=function(K){if(!k.classList.contains("jcalendar-focus")&&!k.classList.contains("jcalendar-inline")){if(E.current=l,f(l,!0),l.getDays(),l.options.type=="year-month-picker"&&l.getMonths(),l.options.time&&(pe.value=l.date[3],He.value=l.date[4]),k.classList.add("jcalendar-focus"),c.getWindowWidth()<800||l.options.fullscreen)k.classList.add("jcalendar-fullsize"),U.slideBottom(ie,1);else{k.classList.remove("jcalendar-fullsize");var ae=M.getBoundingClientRect(),A=ie.getBoundingClientRect();if(l.options.position)J.style.position="fixed",window.innerHeight<ae.bottom+A.height?J.style.top=ae.top-(A.height+2)+"px":J.style.top=ae.top+ae.height+2+"px",J.style.left=ae.left+"px";else{if(window.innerHeight<ae.bottom+A.height){var W=-1*(ae.height+A.height+2);W+ae.top<0&&(W=-1*(ae.top+ae.height)),J.style.top=W+"px"}else J.style.top="2px";if(window.innerWidth<ae.left+A.width){var W=window.innerWidth-(ae.left+A.width+20);J.style.left=W+"px"}else J.style.left="0px"}}typeof l.options.onopen=="function"&&l.options.onopen(M)}},l.close=function(K,ae){if(l.options.autoSelect!==!0&&typeof ae>"u"&&(ae=!1),k.classList.contains("jcalendar-focus")){if(ae!==!1){var A=k.querySelector(".jcalendar-selected");if(typeof ae=="string")var W=ae;else if(!A||A.classList.contains("jcalendar-disabled"))var W=l.options.value;else var W=l.getValue();l.setValue(W)}else if(l.options.value){let ee=l.options.value;l.options.value="",l.setValue(ee)}!K&&typeof l.options.onclose=="function"&&l.options.onclose(M),k.classList.remove("jcalendar-focus"),f(l,!1),E.current=null}return l.options.value},l.prev=function(){l.options.mode=="years"?(l.date[0]=l.date[0]-12,l.getYears()):l.options.mode=="months"?(l.date[0]=parseInt(l.date[0])-1,l.getMonths()):(l.date[1]<2?(l.date[0]=l.date[0]-1,l.date[1]=12):l.date[1]=l.date[1]-1,l.getDays())},l.next=function(){l.options.mode=="years"?(l.date[0]=parseInt(l.date[0])+12,l.getYears()):l.options.mode=="months"?(l.date[0]=parseInt(l.date[0])+1,l.getMonths()):(l.date[1]>11?(l.date[0]=parseInt(l.date[0])+1,l.date[1]=1):l.date[1]=parseInt(l.date[1])+1,l.getDays())},l.setToday=function(){var K=new Date().toISOString().substr(0,10);return l.setValue(K),K},l.setValue=function(K){K||(K=""+K);var ae=K,A=l.options.value;if(A!=ae){if(ae){l.setLabel(ae,l.options);var ee=ae.split(" ");ee[1]||(ee[1]="00:00:00");var W=ee[1].split(":"),ee=ee[0].split("-"),me=parseInt(ee[0]),re=parseInt(ee[1]),he=parseInt(ee[2]),Te=parseInt(W[0]),Ge=parseInt(W[1]);l.date=[me,re,he,Te,Ge,0];var K=l.setLabel(ae,l.options),De=E.now(new Date(me,re-1,he),!0);if(l.options.validRange){if(!l.options.validRange[0]||De>=l.options.validRange[0])var Ze=!0;else var Ze=!1;if(!l.options.validRange[1]||De<=l.options.validRange[1])var it=!0;else var it=!1;Ze&&it?(M.classList.remove("jcalendar_warning"),M.title=""):(M.classList.add("jcalendar_warning"),M.title=m.translate("Date outside the valid range"))}else M.classList.remove("jcalendar_warning"),M.title=""}else{l.date=null;var K="";M.classList.remove("jcalendar_warning"),M.title=""}l.options.value=ae,typeof l.options.onchange=="function"&&l.options.onchange(M,ae,A),M.value!=K&&(M.value=K,typeof M.oninput=="function"&&M.oninput({type:"input",target:M,value:M.value}))}l.getDays(),l.options.type=="year-month-picker"&&l.getMonths()},l.getValue=function(){return l.date?l.options.time?c.two(l.date[0])+"-"+c.two(l.date[1])+"-"+c.two(l.date[2])+" "+c.two(l.date[3])+":"+c.two(l.date[4])+":"+c.two(0):c.two(l.date[0])+"-"+c.two(l.date[1])+"-"+c.two(l.date[2])+" "+c.two(0)+":"+c.two(0)+":"+c.two(0):""},l.update=function(K,ae){if(!K.classList.contains("jcalendar-disabled")){var A=k.querySelector(".jcalendar-selected");A&&A.classList.remove("jcalendar-selected"),K.classList.add("jcalendar-selected"),K.classList.contains("jcalendar-set-month")?(l.date[1]=ae,l.date[2]=1):l.date[2]=K.innerText,l.options.time?(l.date[3]=pe.value,l.date[4]=He.value):l.close(null,!0)}ne()},l.reset=function(){l.setValue(""),l.date=null,l.close(!1,!1)},l.getDays=function(){l.options.mode="days";var Te=new Date,K=l.date&&c.isNumeric(l.date[0])?l.date[0]:parseInt(Te.getFullYear()),ae=l.date&&c.isNumeric(l.date[1])?l.date[1]:parseInt(Te.getMonth())+1,A=l.date&&c.isNumeric(l.date[2])?l.date[2]:parseInt(Te.getDate()),W=l.date&&c.isNumeric(l.date[3])?l.date[3]:parseInt(Te.getHours()),ee=l.date&&c.isNumeric(l.date[4])?l.date[4]:parseInt(Te.getMinutes());l.date=[K,ae,A,W,ee,0],xe.innerHTML=K,ge.innerHTML=l.options.months[ae-1];var me=Te.getMonth()==ae-1&&Te.getFullYear()==K,re=Te.getDate(),Te=new Date(K,ae,0,0,0),he=Te.getDate(),Te=new Date(K,ae-1,0,0,0),Ge=Te.getDay()+1,dt=l.options.startingDay||0;Ge=Ge-dt,Re.innerHTML="";var De=document.createElement("tr");De.setAttribute("align","center"),Re.appendChild(De);for(var Ze=0;Ze<7;Ze++){var it=document.createElement("td");it.classList.add("jcalendar-weekday"),it.innerHTML=l.options.weekdays[dt].substr(0,1),De.appendChild(it),dt++,dt>6&&(dt=0)}for(var dt=0,le=0,Ae=0;Ae<6;Ae++){var De=document.createElement("tr");De.setAttribute("align","center"),De.style.height="34px";for(var Ze=0;Ze<7;Ze++){var it=document.createElement("td");if(it.classList.add("jcalendar-set-day"),dt>=Ge&&dt<Ge+he){le++,it.innerHTML=le,le==A&&it.classList.add("jcalendar-selected"),me&&re==le&&(it.style.fontWeight="bold");var Ne=E.now(new Date(K,ae-1,le),!0);if(l.options.validRange){if(!l.options.validRange[0]||Ne>=l.options.validRange[0])var nt=!0;else var nt=!1;if(!l.options.validRange[1]||Ne<=l.options.validRange[1])var ht=!0;else var ht=!1;nt&&ht||it.classList.add("jcalendar-disabled")}}De.appendChild(it),dt++}Re.appendChild(De)}l.options.time?Je.style.display="":Je.style.display="none",ne()},l.getMonths=function(){l.options.mode="months";var K=l.options.months;l.options.value;var ae=new Date,A=parseInt(ae.getFullYear()),W=parseInt(ae.getMonth())+1,ee=l.date&&c.isNumeric(l.date[0])?l.date[0]:A,me=l.date&&c.isNumeric(l.date[1])?l.date[1]:W;xe.innerHTML=l.date[0],ge.innerHTML=K[me-1];var re=document.createElement("table");re.setAttribute("width","100%");for(var he=null,Te=0;Te<12;Te++){if(!(Te%4)){var he=document.createElement("tr");he.setAttribute("align","center"),re.appendChild(he)}var Ge=document.createElement("td");if(Ge.classList.add("jcalendar-set-month"),Ge.setAttribute("data-value",Te+1),Ge.innerText=K[Te],l.options.validRange){var De=ee+"-"+c.two(Te+1);if(!l.options.validRange[0]||De>=l.options.validRange[0].substr(0,7))var Ze=!0;else var Ze=!1;if(!l.options.validRange[1]||De<=l.options.validRange[1].substr(0,7))var it=!0;else var it=!1;Ze&&it||Ge.classList.add("jcalendar-disabled")}Te+1==me&&Ge.classList.add("jcalendar-selected"),A==ee&&Te+1==W&&(Ge.style.fontWeight="bold"),he.appendChild(Ge)}Re.innerHTML='<tr><td colspan="7"></td></tr>',Re.children[0].children[0].appendChild(re),ne()},l.getYears=function(){l.options.mode="years";for(var K=new Date,ae=K.getFullYear(),A=l.date&&c.isNumeric(l.date[0])?l.date[0]:parseInt(K.getFullYear()),W=[],ee=0;ee<25;ee++)W[ee]=parseInt(l.date[0])+(ee-12);var me=document.createElement("table");me.setAttribute("width","100%");for(var ee=0;ee<25;ee++){if(!(ee%5)){var re=document.createElement("tr");re.setAttribute("align","center"),me.appendChild(re)}var he=document.createElement("td");he.classList.add("jcalendar-set-year"),he.innerText=W[ee],A==W[ee]&&he.classList.add("jcalendar-selected"),ae==W[ee]&&(he.style.fontWeight="bold"),re.appendChild(he)}Re.innerHTML='<tr><td colspan="7"></td></tr>',Re.firstChild.firstChild.appendChild(me),ne()},l.setLabel=function(K,ae){return E.getDateString(K,ae)},l.fromFormatted=function(K,ae){return E.extractDateFromString(K,ae)};var _=function(K){var ae=c.findElement(K.target,"jcalendar-container");if(ae){var A=K.target.className;if(A=="jcalendar-prev")l.prev();else if(A=="jcalendar-next")l.next();else if(A=="jcalendar-month")l.getMonths();else if(A=="jcalendar-year")l.getYears();else if(A=="jcalendar-set-year")l.date[0]=K.target.innerText,l.options.type=="year-month-picker"?l.getMonths():l.getDays();else if(K.target.classList.contains("jcalendar-set-month")){var W=parseInt(K.target.getAttribute("data-value"));l.options.type=="year-month-picker"?l.update(K.target,W):(l.date[1]=W,l.getDays())}else A=="jcalendar-confirm"||A=="jcalendar-update"||A=="jcalendar-close"?l.close(null,!0):A=="jcalendar-backdrop"?l.close(!1,!1):A=="jcalendar-reset"?l.reset():K.target.classList.contains("jcalendar-set-day")&&K.target.innerText&&l.update(K.target)}else l.close(!1,!1)},G=function(K){if(K.target.value&&K.target.value.length>3){var ae=E.extractDateFromString(K.target.value,l.options.format);ae&&l.setValue(ae)}},ne=function(){var K=k.querySelector(".jcalendar-selected");K&&K.classList.contains("jcalendar-disabled")?(ze.setAttribute("disabled","disabled"),pe.setAttribute("disabled","disabled"),He.setAttribute("disabled","disabled")):(ze.removeAttribute("disabled"),pe.removeAttribute("disabled"),He.removeAttribute("disabled")),typeof l.options.onupdate=="function"&&l.options.onupdate(M,l.getValue())},k=null,S=null,Y=null,J=null,ie=null,xe=null,ge=null,fe=null,Re=null,We=null,Je=null,Me=null,ze=null,pe=null,He=null,Z=function(){M.tagName=="INPUT"&&M.value&&(d.value=M.value),S=document.createElement("div"),S.className="jcalendar-reset",Y=document.createElement("div"),Y.className="jcalendar-confirm",We=document.createElement("div"),We.className="jcalendar-controls",We.style.borderBottom="1px solid #ddd",We.appendChild(S),We.appendChild(Y),J=document.createElement("div"),J.className="jcalendar-container",ie=document.createElement("div"),ie.className="jcalendar-content",J.appendChild(ie),M.tagName=="DIV"?(k=M,k.classList.add("jcalendar-inline")):(ie.appendChild(We),k=document.createElement("div"),k.className="jcalendar"),k.classList.add("jcalendar-container"),k.appendChild(J);var K=document.createElement("div");K.className="jcalendar-table",ie.appendChild(K);var ae=document.createElement("td");ae.setAttribute("colspan","2"),ae.className="jcalendar-prev",xe=document.createElement("span"),xe.className="jcalendar-year",ge=document.createElement("span"),ge.className="jcalendar-month";var A=document.createElement("td");A.className="jcalendar-header",A.setAttribute("colspan","3"),A.appendChild(ge),A.appendChild(xe);var W=document.createElement("td");W.setAttribute("colspan","2"),W.className="jcalendar-next";var ee=document.createElement("thead"),me=document.createElement("tr");me.appendChild(ae),me.appendChild(A),me.appendChild(W),ee.appendChild(me),fe=document.createElement("table"),Re=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(ee),fe.appendChild(Re),K.appendChild(fe),pe=document.createElement("select"),pe.className="jcalendar-select",pe.onchange=function(){l.date[3]=this.value,typeof l.options.onupdate=="function"&&l.options.onupdate(M,l.getValue())};for(var re=0;re<24;re++){var he=document.createElement("option");he.value=re,he.innerHTML=c.two(re),pe.appendChild(he)}He=document.createElement("select"),He.className="jcalendar-select",He.onchange=function(){l.date[4]=this.value,typeof l.options.onupdate=="function"&&l.options.onupdate(M,l.getValue())};for(var re=0;re<60;re++){var he=document.createElement("option");he.value=re,he.innerHTML=c.two(re),He.appendChild(he)}var Te=document.createElement("div");Te.className="jcalendar-controls",Je=document.createElement("div"),Je.className="jcalendar-time",Je.style.maxWidth="140px",Je.appendChild(pe),Je.appendChild(He),ze=document.createElement("button"),ze.setAttribute("type","button"),ze.className="jcalendar-update",Me=document.createElement("div"),Me.style.flexGrow="10",Me.appendChild(ze),Te.appendChild(Je),M.tagName=="INPUT"&&Te.appendChild(Me),ie.appendChild(Te);var Ge=document.createElement("div");Ge.className="jcalendar-backdrop",k.appendChild(Ge),M.addEventListener("keyup",G),k.addEventListener("swipeleft",function(De){U.slideLeft(fe,0,function(){l.next(),U.slideRight(fe,1)}),De.preventDefault(),De.stopPropagation()}),k.addEventListener("swiperight",function(De){U.slideRight(fe,0,function(){l.prev(),U.slideLeft(fe,1)}),De.preventDefault(),De.stopPropagation()}),"ontouchend"in document.documentElement?(k.addEventListener("touchend",_),M.addEventListener("touchend",l.open)):(k.addEventListener("mouseup",_),M.addEventListener("mouseup",l.open)),E.hasEvents||(E.hasEvents=!0,document.addEventListener("keydown",E.keydown)),l.setOptions(d),M.tagName=="INPUT"?(M.parentNode.insertBefore(k,M.nextSibling),M.setAttribute("autocomplete","off"),M.classList.add("jcalendar-input"),M.value=l.setLabel(l.getValue(),l.options)):(l.getDays(),l.options.time&&(pe.value=l.date[3],He.value=l.date[4])),l.options.opened==!0&&l.open(),l.options.controls==!1&&J.classList.add("jcalendar-hide-controls"),M.change=l.setValue,M.val=function(De){if(De===void 0)return l.getValue();l.setValue(De)},M.calendar=k.calendar=l};return Z(),l};return E.keydown=function(M){var d=null;(d=E.current)&&(M.which==13?d.close(!1,!0):M.which==27&&d.close(!1,!1))},E.prettify=function(M,d){if(!d)var d={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};M.indexOf("GMT")===-1&&M.indexOf("Z")===-1&&(M+=" GMT");var l=new Date,_=new Date(M),G=parseInt((l-_)/1e3/60);if(String.prototype.format=function(k){return this.replace("{0}",k)},G==0)var ne=d.justNow;else if(G<90)var ne=d.xMinutesAgo.format(G);else if(G<1440)var ne=d.xHoursAgo.format(Math.round(G/60));else if(G<20160)var ne=d.xDaysAgo.format(Math.round(G/1440));else if(G<43200)var ne=d.xWeeksAgo.format(Math.round(G/10080));else if(G<1036800)var ne=d.xMonthsAgo.format(Math.round(G/43200));else var ne=d.xYearsAgo.format(Math.round(G/525600));return ne},E.prettifyAll=function(){for(var M=document.querySelectorAll(".prettydate"),d=0;d<M.length;d++)M[d].getAttribute("data-date")?M[d].innerHTML=E.prettify(M[d].getAttribute("data-date")):M[d].innerHTML&&(M[d].setAttribute("title",M[d].innerHTML),M[d].setAttribute("data-date",M[d].innerHTML),M[d].innerHTML=E.prettify(M[d].innerHTML))},E.now=g.now,E.toArray=g.toArray,E.dateToNum=g.dateToNum,E.numToDate=g.numToDate,E.weekdays=g.weekdays,E.months=g.months,E.weekdaysShort=g.weekdaysShort,E.monthsShort=g.monthsShort,E.extractDateFromString=I.extractDateFromString,E.getDateString=I.getDateString,E}var V=P();function R(){var E={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},M=function(d){return E[d]?E[d]:E.material};return M.get=function(d){return E[d]?E[d]:E},M.set=function(d,l){E[d]=l},M}var Q=R();function de(E,M){var d={};d.options={};var l={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var _ in l)M&&M.hasOwnProperty(_)?d.options[_]=M[_]:d.options[_]=l[_];E.classList.add("jtabs");var G=null,ne=null,k=null,S=function(ge){if(d.options.animation){var fe=d.headers.children[ge].getBoundingClientRect();d.options.palette==="modern"?(k.style.width=fe.width-4+"px",k.style.left=d.headers.children[ge].offsetLeft+2+"px"):(k.style.width=fe.width+"px",k.style.left=d.headers.children[ge].offsetLeft+"px"),d.options.position==="bottom"?k.style.top="0px":k.style.bottom="0px"}},Y=function(ge){typeof d.headers.scrollTo=="function"?d.headers.scrollTo({left:ge,behavior:"smooth"}):d.headers.scrollLeft=ge,ge<=1?G.classList.add("disabled"):G.classList.remove("disabled"),ge>=d.headers.scrollWidth-d.headers.offsetWidth?ne.classList.add("disabled"):ne.classList.remove("disabled"),d.headers.scrollWidth<=d.headers.offsetWidth?(G.style.display="none",ne.style.display="none"):(G.style.display="",ne.style.display="")};if(d.setBorder=S,d.open=function(ge){if(d.content.children[ge]){for(var fe=null,Re=0;Re<d.headers.children.length;Re++)d.headers.children[Re].classList.contains("jtabs-selected")&&(fe=Re),d.headers.children[Re].classList.remove("jtabs-selected"),d.content.children[Re]&&d.content.children[Re].classList.remove("jtabs-selected");if(d.headers.children[ge].classList.add("jtabs-selected"),d.content.children[ge]&&d.content.children[ge].classList.add("jtabs-selected"),fe!=ge&&typeof d.options.onchange=="function"&&d.content.children[ge]&&d.options.onchange(E,d,ge,d.headers.children[ge],d.content.children[ge]),d.options.hideHeaders==!0&&d.headers.children.length<3&&d.options.allowCreate==!1)d.headers.parentNode.style.display="none";else{d.headers.parentNode.style.display="";var We=d.headers.children[ge].offsetLeft,Je=We+d.headers.children[ge].offsetWidth,Me=d.headers.scrollLeft,ze=Me+d.headers.offsetWidth;Me<=We&&ze>=Je||Y(We-1),S(ge)}}},d.selectIndex=function(ge){var fe=Array.prototype.indexOf.call(d.headers.children,ge);return fe>=0&&d.open(fe),fe},d.rename=function(ge,fe){fe||(fe=prompt("New title",d.headers.children[ge].innerText)),d.headers.children[ge].innerText=fe,d.open(ge)},d.create=function(ge,fe){if(typeof d.options.onbeforecreate=="function"){var Re=d.options.onbeforecreate(E);if(Re===!1)return!1;ge=Re}var We=d.appendElement(ge);return typeof d.options.oncreate=="function"&&d.options.oncreate(E,We),S(),We},d.remove=function(ge){return d.deleteElement(ge)},d.nextNumber=function(){for(var ge=0,fe=0;fe<d.headers.children.length;fe++){var Re=d.headers.children[fe].innerText.match(/[0-9].*/);Re>ge&&(ge=parseInt(Re))}return ge?ge++:ge=1,ge},d.deleteElement=function(ge){if(d.headers.children[ge])d.headers.removeChild(d.headers.children[ge]),d.content.removeChild(d.content.children[ge]);else return!1;d.open(0),typeof d.options.ondelete=="function"&&d.options.ondelete(E,ge)},d.appendElement=function(ge,fe,Re,We){if(!ge)var ge=prompt("Title?","");if(ge){var Je=document.createElement("div"),Me=document.createElement("div");if(Me.innerHTML=ge,Me.content=Je,typeof We>"u")d.content.appendChild(Je),d.headers.insertBefore(Me,d.headers.lastChild);else{let ze=d.content.children[We];ze?d.content.insertBefore(Je,ze):d.content.appendChild(Je),ze=d.headers.children[We]||d.headers.lastChild,d.headers.insertBefore(Me,ze)}return d.options.allowChangePosition&&Me.setAttribute("draggable","true"),Re!==!1&&d.selectIndex(Me),typeof fe=="function"&&fe(Je,Me),Je}},d.getActive=function(){for(var ge=0;ge<d.headers.children.length;ge++)if(d.headers.children[ge].classList.contains("jtabs-selected"))return ge;return!1},d.updateContent=function(ge,fe){if(typeof fe!="string")var Re=fe;else{var Re=document.createElement("div");Re.innerHTML=fe}d.content.children[ge].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),d.content.replaceChild(fe,d.content.children[ge]),S()},d.updatePosition=function(ge,fe,Re,We){if(ge>fe?d.content.insertBefore(d.content.children[ge],d.content.children[fe]):d.content.insertBefore(d.content.children[ge],d.content.children[fe].nextSibling),We!==!1)d.open(fe);else{const Je=d.getActive();fe<Je&&d.setBorder(Je)}!Re&&typeof d.options.onchangeposition=="function"&&d.options.onchangeposition(d.headers,ge,fe)},d.move=function(ge,fe,Re,We){ge>fe?d.headers.insertBefore(d.headers.children[ge],d.headers.children[fe]):d.headers.insertBefore(d.headers.children[ge],d.headers.children[fe].nextSibling),d.updatePosition(ge,fe,Re,We)},d.setBorder=S,d.init=function(){E.innerHTML="",d.headers=document.createElement("div"),d.content=document.createElement("div"),d.headers.classList.add("jtabs-headers"),d.content.classList.add("jtabs-content"),d.options.palette?E.classList.add("jtabs-modern"):E.classList.remove("jtabs-modern"),d.options.padding&&(d.content.style.padding=parseInt(d.options.padding)+"px");var ge=document.createElement("div");ge.className="jtabs-headers-container",ge.appendChild(d.headers),d.options.maxWidth&&(ge.style.maxWidth=parseInt(d.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),ge.appendChild(fe),d.options.position=="bottom"?(E.appendChild(d.content),E.appendChild(ge)):(E.appendChild(ge),E.appendChild(d.content)),d.options.allowCreate==!0){var Re=document.createElement("div");Re.className="jtabs-add",Re.onclick=function(){d.create()},fe.appendChild(Re)}G=document.createElement("div"),G.className="jtabs-prev",G.onclick=function(){Y(d.headers.scrollLeft-d.headers.offsetWidth)},fe.appendChild(G),ne=document.createElement("div"),ne.className="jtabs-next",ne.onclick=function(){Y(d.headers.scrollLeft+d.headers.offsetWidth)},fe.appendChild(ne);for(var We=0;We<d.options.data.length;We++){if(d.options.data[We].titleElement)var Je=d.options.data[We].titleElement;else var Je=document.createElement("div");if(d.options.data[We].icon){var Me=document.createElement("div"),ze=document.createElement("i");ze.classList.add("material-icons"),ze.innerHTML=d.options.data[We].icon,Me.appendChild(ze),Je.appendChild(Me)}if(d.options.data[We].title){var pe=document.createTextNode(d.options.data[We].title);Je.appendChild(pe)}if(d.options.data[We].width&&(Je.style.width=d.options.data[We].width),d.options.data[We].contentElement)var He=d.options.data[We].contentElement;else{var He=document.createElement("div");He.innerHTML=d.options.data[We].content}d.headers.appendChild(Je),d.content.appendChild(He)}k=document.createElement("div"),k.className="jtabs-border",d.headers.appendChild(k),d.options.animation&&E.classList.add("jtabs-animation"),d.headers.addEventListener("click",function(Z){if(Z.target.parentNode.classList.contains("jtabs-headers"))var K=Z.target;else if(Z.target.tagName=="I")var K=Z.target.parentNode.parentNode;else var K=Z.target.parentNode;var ae=d.selectIndex(K);typeof d.options.onclick=="function"&&d.options.onclick(E,d,ae,d.headers.children[ae],d.content.children[ae])}),d.headers.addEventListener("contextmenu",function(Z){d.selectIndex(Z.target)}),d.headers.children.length&&d.open(0),Y(0),d.options.allowChangePosition==!0&&C(d.headers,{direction:1,ondrop:function(Z,K,ae){d.updatePosition(K,ae)}}),typeof d.options.onload=="function"&&d.options.onload(E,d)},E.children[0]&&E.children[0].children.length)for(var J=0;J<E.children[0].children.length;J++){var ie=d.options.data&&d.options.data[J]?d.options.data[J]:{};E.children[1]&&E.children[1].children[J]?(ie.titleElement=E.children[0].children[J],ie.contentElement=E.children[1].children[J]):ie.contentElement=E.children[0].children[J],d.options.data[J]=ie}var xe=!1;if(d.options.data)for(var J=0;J<d.options.data.length;J++)d.options.data[J].url&&(O({url:d.options.data[J].url,type:"GET",dataType:"text/html",index:J,success:function(fe){d.options.data[this.index].content=fe},complete:function(){d.init()}}),xe=!0);return xe||d.init(),E.tabs=d,d}function oe(E,M){if(E.color)return E.color.setOptions(M,!0);var d={type:"color"};d.options={};var l=null,_=null,G=null,ne=null,k=null,S=null,Y=null;d.setOptions=function(A,W){var ee={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};A||(A={}),A&&!A.palette&&(A.palette=Q());for(var me in ee)A&&A.hasOwnProperty(me)?d.options[me]=A[me]:(typeof d.options[me]>"u"||W===!0)&&(d.options[me]=ee[me]);return ne&&(ne.innerHTML=d.options.resetLabel),k&&(k.innerHTML=d.options.doneLabel),d.options.palette&&Y&&Y.updateContent(0,fe()),typeof d.options.value=="string"&&(E.value=d.options.value,E.tagName==="INPUT"&&(E.style.color=E.value,E.style.backgroundColor=E.value)),d.options.placeholder?E.setAttribute("placeholder",d.options.placeholder):E.getAttribute("placeholder")&&E.removeAttribute("placeholder"),d},d.select=function(A){var W=l.querySelector(".jcolor-selected");W&&W.classList.remove("jcolor-selected"),d.values[A]&&d.values[A].classList.add("jcolor-selected"),d.options.value=A},d.open=function(){if(!l.classList.contains("jcolor-focus")){f(d,!0),l.classList.add("jcolor-focus"),d.options.value&&d.select(d.options.value),G.style.marginTop="",G.style.marginLeft="";var A=G.getBoundingClientRect(),W=c.getWindowWidth(),ee=c.getWindowHeight();if(W<800||d.options.fullscreen==!0?(G.classList.add("jcolor-fullscreen"),U.slideBottom(G,1),_.style.display="block"):(G.classList.contains("jcolor-fullscreen")&&(G.classList.remove("jcolor-fullscreen"),_.style.display=""),d.options.position?G.style.position="fixed":G.style.position="",A.left+A.width>W&&(G.style.marginLeft=-1*(A.left+A.width-(W-20))+"px"),A.top+A.height>ee&&(G.style.marginTop=-1*(A.top+A.height-(ee-20))+"px")),typeof d.options.onopen=="function"&&d.options.onopen(E,d),Y.setBorder(Y.getActive()),d.options.value){var me=ge(d.options.value);He.forEach(function(re,he){re.value=me[he],re.dispatchEvent(new Event("input"))})}}},d.close=function(A){return l.classList.contains("jcolor-focus")&&(l.classList.remove("jcolor-focus"),_.style.display="",!A&&typeof d.options.onclose=="function"&&d.options.onclose(E,d),f(d,!1)),d.options.value},d.setValue=function(A){A||(A=""),A!=d.options.value&&(d.options.value=A,pe=A,d.select(A),typeof d.options.onchange=="function"&&d.options.onchange(E,A,d),E.value!=d.options.value&&(E.value=d.options.value,E.tagName==="INPUT"&&(E.style.color=E.value,E.style.backgroundColor=E.value),typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),d.options.closeOnChange==!0&&d.close())},d.getValue=function(){return d.options.value};var J=function(A){var W=A.toString(16);return W.length===1?"0"+W:W},ie=function(A,W,ee){return"#"+J(A)+J(W)+J(ee)},xe=function(A){return parseInt("0x"+A)},ge=function(A){return[xe(A.substr(1,2)),xe(A.substr(3,2)),xe(A.substr(5,2))]},fe=function(){var A=document.createElement("div");A.className="jcolor-grid",d.values=[];var W=document.createElement("table");W.setAttribute("cellpadding","7"),W.setAttribute("cellspacing","0");for(var ee=0;ee<d.options.palette.length;ee++){for(var me=document.createElement("tr"),re=0;re<d.options.palette[ee].length;re++){var he=document.createElement("td"),Te=d.options.palette[ee][re];Te.length<7&&Te.substr(0,1)!=="#"&&(Te="#"+Te),he.style.backgroundColor=Te,he.setAttribute("data-value",Te),he.innerHTML="",me.appendChild(he),d.options.value==Te&&he.classList.add("jcolor-selected"),d.values[Te]=he}W.appendChild(me)}return A.appendChild(W),A},Re=document.createElement("canvas");Re.width=200,Re.height=160;var We=Re.getContext("2d"),Je=function(){var A=S.firstChild.getBoundingClientRect();Re.width=A.width-14,Me()},Me=function(){var A=We.createLinearGradient(0,0,Re.width,0);A.addColorStop(0,"rgb(255,0,0)"),A.addColorStop(.15,"rgb(255,0,255)"),A.addColorStop(.33,"rgb(0,0,255)"),A.addColorStop(.49,"rgb(0,255,255)"),A.addColorStop(.67,"rgb(0,255,0)"),A.addColorStop(.84,"rgb(255,255,0)"),A.addColorStop(1,"rgb(255,0,0)"),We.fillStyle=A,We.fillRect(0,0,Re.width,Re.height),A=We.createLinearGradient(0,0,0,Re.height),A.addColorStop(0,"rgba(255,255,255,1)"),A.addColorStop(.5,"rgba(255,255,255,0)"),A.addColorStop(.5,"rgba(0,0,0,0)"),A.addColorStop(1,"rgba(0,0,0,1)"),We.fillStyle=A,We.fillRect(0,0,Re.width,Re.height)},ze=function(){var A=document.createElement("div");A.className="jcolor-hsl";var W=document.createElement("div");W.className="jcolor-point";var ee=document.createElement("div");ee.appendChild(Re),ee.appendChild(W),A.appendChild(ee);var me=function(re,he,Te){if(re===1){var Ge=A.getBoundingClientRect(),De=he-Ge.left,Ze=Te-Ge.top;De<0&&(De=0),Ze<0&&(Ze=0),De>Ge.width&&(De=Ge.width),Ze>Ge.height&&(Ze=Ge.height),W.style.left=De+"px",W.style.top=Ze+"px";var it=We.getImageData(De,Ze,1,1).data;pe=ie(it[0],it[1],it[2])}};return A.addEventListener("mousedown",function(re){me(re.buttons,re.clientX,re.clientY)}),A.addEventListener("mousemove",function(re){me(re.buttons,re.clientX,re.clientY)}),A.addEventListener("touchmove",function(re){me(1,re.changedTouches[0].clientX,re.changedTouches[0].clientY)}),A},pe="",He=[],Z=function(){if(pe!=="")for(var A=0;A<He.length;A++){var W=ge(pe);W[A]=0;var ee="linear-gradient(90deg, rgb(";ee+=W.join(", "),ee+="), rgb(",W[A]=255,ee+=W.join(", "),ee+="))",He[A].style.backgroundImage=ee}},K=function(){var A=document.createElement("div");A.className="jcolor-sliders";var W=document.createElement("div"),ee=function(Te){var Ge=document.createElement("div");Ge.className="jcolor-sliders-input-container";var De=document.createElement("label");De.innerText=Te;var Ze=document.createElement("div");Ze.className="jcolor-sliders-input-subcontainer";var it=document.createElement("input");it.type="range",it.min=0,it.max=255,it.value=0,Ge.appendChild(De),Ze.appendChild(it);var dt=document.createElement("div");return dt.innerText=it.value,it.addEventListener("input",function(){dt.innerText=it.value}),Ze.appendChild(dt),Ge.appendChild(Ze),W.appendChild(Ge),it};He=[ee("Red"),ee("Green"),ee("Blue")],A.appendChild(W);var me=document.createElement("div");me.className="jcolor-sliders-final-color";var re=document.createElement("div");re.style.visibility="hidden",re.innerText="a",me.appendChild(re);var he=function(){var Te=ie(parseInt(He[0].value),parseInt(He[1].value),parseInt(He[2].value));re.innerText=Te,re.style.color=Te,re.style.removeProperty("visibility"),pe=Te};return He.forEach(function(Te){Te.addEventListener("input",function(){he(),Z()})}),A.appendChild(me),A},ae=function(){d.setOptions(M),E.tagName=="INPUT"&&(E.classList.add("jcolor-input"),E.readOnly=!0),l=document.createElement("div"),l.className="jcolor",_=document.createElement("div"),_.className="jcolor-backdrop",l.appendChild(_),G=document.createElement("div"),G.className="jcolor-content";var A=document.createElement("div");A.className="jcolor-controls",G.appendChild(A),ne=document.createElement("div"),ne.className="jcolor-reset",ne.innerHTML=d.options.resetLabel,A.appendChild(ne),k=document.createElement("div"),k.className="jcolor-close",k.innerHTML=d.options.doneLabel,A.appendChild(k),S=document.createElement("div"),G.appendChild(S),Y=de(S,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:ze()},{title:"Sliders",contentElement:K()}],onchange:function(W,ee,me){if(me===1)Je();else{var re=pe!==""?pe:d.getValue();if(me===2&&re){var he=ge(re);He.forEach(function(Te,Ge){Te.value=he[Ge],Te.dispatchEvent(new Event("input"))})}}},palette:"modern"}),l.appendChild(G),E.tagName=="INPUT"?E.parentNode.insertBefore(l,E.nextSibling):E.appendChild(l),l.addEventListener("click",function(W){if(W.target.tagName=="TD"){var ee=W.target.getAttribute("data-value");ee&&d.setValue(ee)}else W.target.classList.contains("jcolor-reset")?(d.setValue(""),d.close()):W.target.classList.contains("jcolor-close")?(Y.getActive()>0&&d.setValue(pe),d.close()):W.target.classList.contains("jcolor-backdrop")?d.close():d.open()}),E.addEventListener("mouseup",function(W){d.open()}),window.addEventListener("resize",function(){l.classList.contains("jcolor-focus")&&Y.getActive()==1&&Je()}),d.options.opened==!0&&d.open(),E.change=d.setValue,E.val=function(W){if(W===void 0)return d.getValue();d.setValue(W)},E.color=d,l.color=d};return d.toHex=function(A){var W=function(ee){return("0"+parseInt(ee).toString(16)).slice(-2)};if(A)return/^#[0-9A-F]{6}$/i.test(A)?A:(A=A.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),A&&A.length?"#"+W(A[1])+W(A[2])+W(A[3]):"")},ae(),d}function be(){var E=function(M,d){var l={type:"contextmenu"};l.options={};var _={items:null,onclick:null};for(var G in _)d&&d.hasOwnProperty(G)?l.options[G]=d[G]:l.options[G]=_[G];M.classList.add("jcontextmenu"),l.open=function(S,Y){if(Y&&(l.options.items=Y,l.create(Y)),E.current&&E.current.close(),f(l,!0),M.classList.add("jcontextmenu-focus"),E.current=l,l.options.items&&l.options.items.length>0||M.children.length){if(S.target)if(S.changedTouches&&S.changedTouches[0])J=S.changedTouches[0].clientX,ie=S.changedTouches[0].clientY;else var J=S.clientX,ie=S.clientY;else var J=S.x,ie=S.y;var xe=M.getBoundingClientRect();if(window.innerHeight<ie+xe.height){var ge=ie-xe.height;ge<0&&(ge=0),M.style.top=ge+"px"}else M.style.top=ie+"px";window.innerWidth<J+xe.width?J-xe.width>0?M.style.left=J-xe.width+"px":M.style.left="10px":M.style.left=J+"px"}},l.isOpened=function(){return!!M.classList.contains("jcontextmenu-focus")},l.close=function(){M.classList.contains("jcontextmenu-focus")&&M.classList.remove("jcontextmenu-focus"),f(l,!1)},l.create=function(S){M.innerHTML="";var Y=ne();M.appendChild(Y);for(var J=0;J<S.length;J++){var ie=k(S[J]);M.appendChild(ie)}};function ne(){var S=document.createElement("div");S.classList.add("header"),S.addEventListener("click",function(ie){ie.preventDefault(),ie.stopPropagation()});var Y=document.createElement("a");Y.classList.add("title"),Y.innerHTML=m.translate("Menu"),S.appendChild(Y);var J=document.createElement("a");return J.classList.add("close"),J.innerHTML=m.translate("close"),J.addEventListener("click",function(ie){l.close()}),S.appendChild(J),S}function k(S){if(S.type&&(S.type=="line"||S.type=="divisor"))var Y=document.createElement("hr");else{var Y=document.createElement("div"),J=document.createElement("a");if(J.innerHTML=S.title,S.tooltip&&Y.setAttribute("title",S.tooltip),S.icon&&Y.setAttribute("data-icon",S.icon),S.id&&(Y.id=S.id),S.disabled?Y.className="jcontextmenu-disabled":S.onclick&&(Y.method=S.onclick,Y.addEventListener("mousedown",function(Me){Me.preventDefault()}),Y.addEventListener("mouseup",function(Me){this.method(this,Me)})),Y.appendChild(J),S.submenu){var ie=document.createElement("span");ie.innerHTML="&#9658;",Y.appendChild(ie),Y.classList.add("jcontexthassubmenu");var xe=document.createElement("div");xe.classList.add("jcontextmenu"),xe.setAttribute("tabindex","900");for(var ge=S.submenu,fe=0;fe<ge.length;fe++){var Re=k(ge[fe]);xe.appendChild(Re)}Y.appendChild(xe)}else if(S.shortcut){var We=document.createElement("span");We.innerHTML=S.shortcut,Y.appendChild(We)}}return Y}return typeof l.options.onclick=="function"&&M.addEventListener("click",function(S){l.options.onclick(l,S)}),l.options.items&&l.create(l.options.items),window.addEventListener("mousewheel",function(){l.close()}),M.contextmenu=l,l};return E}var Ee=be();function ye(){var E=function(M,d){if(M.dropdown)return M.dropdown.setOptions(d,!0);var l={type:"dropdown"};l.options={};var _=function(Z,K){Z&&Z.length&&(l.options.sortResults!==!1&&(typeof l.options.sortResults=="function"?Z.sort(l.options.sortResults):Z.sort(G)),l.setData(Z)),typeof l.options.onload=="function"&&l.options.onload(M,l,Z,K),K&&k(K),K==null&&(l.options.value=""),M.value=l.options.value,l.options.opened==!0&&l.open()},G=function(Z,K){var ae,A;return typeof Z=="string"?ae=Z:Z.text?ae=Z.text:Z.name&&(ae=Z.name),typeof K=="string"?A=K:K.text?A=K.text:K.name&&(A=K.name),typeof ae=="string"||typeof A=="string"?(typeof ae!="string"&&(ae=""+ae),typeof A!="string"&&(A=""+A),ae.localeCompare(A)):ae-A},ne=function(){l.value={};for(var Z=0;Z<l.items.length;Z++)l.items[Z].selected==!0&&(l.items[Z].element&&l.items[Z].element.classList.remove("jdropdown-selected"),l.items[Z].selected=null);l.options.value="",M.value=""},k=function(Z){if(ne(),Z!==null)if(!Z)typeof l.value[""]<"u"&&(l.value[""]="");else{Array.isArray(Z)||(Z=(""+Z).split(";"));for(var K=0;K<Z.length;K++)l.value[Z[K]]=""}for(var K=0;K<l.items.length;K++)typeof l.value[S(K)]<"u"&&(l.items[K].element&&l.items[K].element.classList.add("jdropdown-selected"),l.items[K].selected=!0,l.value[S(K)]=Y(K));l.options.value=Object.keys(l.value).join(";"),l.header.value=l.getText()},S=function(Z,K){if(l.options.format)var ae="id";else var ae="value";return l.items[Z]?K!==void 0?l.items[Z].data[ae]=K:l.items[Z].data[ae]:""},Y=function(Z,K){if(l.options.format)var ae="name";else var ae="text";return l.items[Z]?K!==void 0?l.items[Z].data[ae]=K:l.items[Z].data[ae]:""},J=function(){return Object.keys(l.value)},ie=function(){for(var Z=[],K=Object.keys(l.value),ae=0;ae<K.length;ae++)Z.push(l.value[K[ae]]);return Z};l.setOptions=function(Z,K){Z||(Z={});var ae={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(var A in ae)Z&&Z.hasOwnProperty(A)?l.options[A]=Z[A]:(typeof l.options[A]>"u"||K===!0)&&(l.options[A]=ae[A]);return(l.options.remoteSearch==!0||l.options.type==="searchbar")&&(l.options.autocomplete=!0),l.options.newOptions==!0?l.header.classList.add("jdropdown-add"):l.header.classList.remove("jdropdown-add"),l.options.autocomplete==!0?l.header.removeAttribute("readonly"):l.header.setAttribute("readonly","readonly"),l.options.placeholder?l.header.setAttribute("placeholder",l.options.placeholder):l.header.removeAttribute("placeholder"),M.classList.remove("jdropdown-searchbar"),M.classList.remove("jdropdown-picker"),M.classList.remove("jdropdown-list"),l.options.type=="searchbar"?M.classList.add("jdropdown-searchbar"):l.options.type=="list"?M.classList.add("jdropdown-list"):l.options.type=="picker"?M.classList.add("jdropdown-picker"):c.getWindowWidth()<800?l.options.autocomplete?(M.classList.add("jdropdown-searchbar"),l.options.type="searchbar"):(M.classList.add("jdropdown-picker"),l.options.type="picker"):(l.options.width?(M.style.width=l.options.width,M.style.minWidth=l.options.width):(M.style.removeProperty("width"),M.style.removeProperty("min-width")),M.classList.add("jdropdown-default"),l.options.type="default"),l.options.type=="searchbar"?xe.appendChild(Re):ge.insertBefore(Re,ge.firstChild),l.options.url&&!Z.data?O({url:l.options.url,method:"GET",dataType:"json",success:function(W){W&&_(W,l.options.value)}}):_(l.options.data,l.options.value),l};var xe=null,ge=null,fe=null,Re=null,We=null,Je=null,Me=null,ze=function(){if(d||(d={}),M.tagName=="SELECT"){var Z=E.extractFromDom(M,d);M=Z.el,d=Z.options}!d.placeholder&&M.getAttribute("placeholder")&&(d.placeholder=M.getAttribute("placeholder")),l.value={},l.items=[],l.groups=[],l.search="",l.results=null,M.classList.add("jdropdown"),xe=document.createElement("div"),xe.className="jdropdown-container-header",l.header=document.createElement("input"),l.header.className="jdropdown-header jss_object",l.header.type="text",l.header.setAttribute("autocomplete","off"),l.header.onfocus=function(){typeof l.options.onfocus=="function"&&l.options.onfocus(M)},l.header.onblur=function(){typeof l.options.onblur=="function"&&l.options.onblur(M)},l.header.onkeyup=function(K){l.options.autocomplete==!0&&!Me?(l.search!=l.header.value.trim()&&(Me=setTimeout(function(){l.find(l.header.value.trim()),Me=null},400)),M.classList.contains("jdropdown-focus")||l.open()):l.options.autocomplete||l.next(K.key)},E.hasEvents||(E.hasEvents=!0,document.addEventListener("keydown",E.keydown)),ge=document.createElement("div"),ge.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",Re=document.createElement("div"),Re.className="jdropdown-close",Re.textContent="Done",We=document.createElement("div"),We.className="jdropdown-reset",We.textContent="x",We.onclick=function(){l.reset(),l.close()},Je=document.createElement("div"),Je.className="jdropdown-backdrop",xe.appendChild(l.header),ge.appendChild(fe),M.appendChild(xe),M.appendChild(ge),M.appendChild(Je),l.setOptions(d),"ontouchsend"in document.documentElement?M.addEventListener("touchsend",E.mouseup):M.addEventListener("mouseup",E.mouseup),l.options.lazyLoading==!0&&b(fe,{loadUp:l.loadUp,loadDown:l.loadDown}),fe.onwheel=function(K){K.stopPropagation()},M.change=l.setValue,M.val=function(K){if(K===void 0)return l.getValue(!!l.options.multiple);l.setValue(K)},M.dropdown=l};l.getUrl=function(){return l.options.url},l.setUrl=function(Z,K){l.options.url=Z,O({url:l.options.url,method:"GET",dataType:"json",success:function(ae){l.setData(ae),typeof K=="function"&&K(l)}})},l.setId=function(Z,K){if(l.options.format)var ae="id";else var ae="value";typeof Z=="object"?Z[ae]=K:l.items[Z].data[ae]=K},l.add=function(Z,K){if(!Z){var ae=l.options.autocomplete==!0?l.header.value:"",Z=prompt(m.translate("Add A New Option"),ae);if(!Z)return!1}if(K||(K=c.guid()),l.options.format)var A={id:K,name:Z};else var A={value:K,text:Z};if(typeof l.options.onbeforeinsert=="function"){var W=l.options.onbeforeinsert(l,A);if(W===!1)return!1;W&&(A=W)}l.options.data.push(A);var ee=l.createItem(A);return fe.appendChild(ee.element),typeof l.options.oninsert=="function"&&l.options.oninsert(l,A,ee),fe.style.display=="none"&&(fe.style.display=""),l.results&&l.results.push(ee),A},l.createItem=function(Z,K,ae){l.options.format?(!Z.id&&Z.value!==void 0&&(Z.id=Z.value),!Z.name&&Z.text!==void 0&&(Z.name=Z.text)):(!Z.value&&Z.id!==void 0&&(Z.value=Z.id),!Z.text&&Z.name!==void 0&&(Z.text=Z.name));var A={};if(A.element=document.createElement("div"),A.element.className="jdropdown-item",A.element.indexValue=l.items.length,A.data=Z,K&&(A.group=K),Z.id&&A.element.setAttribute("id",Z.id),Z.disabled==!0&&A.element.setAttribute("data-disabled",!0),Z.tooltip&&A.element.setAttribute("title",Z.tooltip),Z.image){var W=document.createElement("img");W.className="jdropdown-image",W.src=Z.image,Z.title||W.classList.add("jdropdown-image-small"),A.element.appendChild(W)}else if(Z.icon){var ee=document.createElement("span");ee.className="jdropdown-icon material-icons",ee.innerText=Z.icon,Z.title||ee.classList.add("jdropdown-icon-small"),Z.color&&(ee.style.color=Z.color),A.element.appendChild(ee)}else if(Z.color){var me=document.createElement("div");me.className="jdropdown-color",me.style.backgroundColor=Z.color,A.element.appendChild(me)}if(l.options.format)var re=Z.name;else var re=Z.text;var he=document.createElement("div");if(he.className="jdropdown-description",he.textContent=re||"&nbsp;",Z.title){var Te=document.createElement("div");Te.className="jdropdown-title",Te.innerText=Z.title,he.appendChild(Te)}if(l.options.format)var Ge=Z.id;else var Ge=Z.value;return l.value[Ge]&&(A.element.classList.add("jdropdown-selected"),A.selected=!0),l.items.push(A),A.element.appendChild(he),A},l.appendData=function(Z){if(Z.length){for(var K=[],ae=[],A=0;A<Z.length;A++)Z[A].group?(ae[Z[A].group]||(ae[Z[A].group]=[]),ae[Z[A].group].push(A)):K.push(A);var W=0,ee=Object.keys(ae);if(ee.length>0)for(var A=0;A<ee.length;A++){var me=document.createElement("div");me.className="jdropdown-group";var re=document.createElement("div");re.className="jdropdown-group-name",re.textContent=ee[A];var he=document.createElement("i");he.className="jdropdown-group-arrow jdropdown-group-arrow-down",re.appendChild(he);var Te=document.createElement("div");Te.className="jdropdown-group-items";for(var Ge=0;Ge<ae[ee[A]].length;Ge++){var De=l.createItem(Z[ae[ee[A]][Ge]],me,ee[A]);(l.options.lazyLoading==!1||W<200)&&(Te.appendChild(De.element),W++)}me.appendChild(re),me.appendChild(Te),l.groups.push(me),Te.children.length>0&&fe.appendChild(me)}if(K.length)for(var A=0;A<K.length;A++){var De=l.createItem(Z[K[A]]);(l.options.lazyLoading==!1||W<200)&&(fe.appendChild(De.element),W++)}}},l.setData=function(Z){if(ne(),fe.textContent="",l.header.value="",l.items=[],Z&&Z.length){for(var K=0;K<Z.length;K++)typeof Z[K]!="object"&&(l.options.format?Z[K]={id:Z[K],name:Z[K]}:Z[K]={value:Z[K],text:Z[K]});l.appendData(Z),l.options.data=Z}else l.options.data=[];l.close()},l.getData=function(){return l.options.data},l.getPosition=function(Z){for(var K=0;K<l.items.length;K++)if(S(K)==Z)return K;return!1},l.getText=function(Z){var K=ie();return Z?K:K.join("; ")},l.getValue=function(Z){var K=J();return Z?K:K.join(";")};var pe=function(Z){M.value!=l.options.value&&(M.value=l.options.value,typeof M.oninput=="function"&&M.oninput({type:"input",target:M,value:M.value})),typeof l.options.onchange=="function"&&l.options.onchange(M,l,Z,l.options.value)};l.setValue=function(Z){var K=l.getValue();Array.isArray(Z)&&(Z=Z.join(";")),K!==Z&&(k(Z),pe(K))},l.resetSelected=function(){l.setValue(null)},l.selectIndex=function(ae,K){var ae=parseInt(ae);if(l.items&&l.items[ae]&&(K===!0||l.items[ae].data.disabled!==!0))if(l.setCursor(ae,!1),!l.options.multiple)l.items[ae].selected?l.setValue(null):l.setValue(S(ae)),l.close();else{var A=l.options.value;l.items[ae].selected?(l.items[ae].element.classList.remove("jdropdown-selected"),l.items[ae].selected=!1,delete l.value[S(ae)]):(l.items[ae].element.classList.add("jdropdown-selected"),l.items[ae].selected=!0,l.value[S(ae)]=Y(ae)),l.options.value=Object.keys(l.value).join(";"),l.options.autocomplete==!1&&(l.header.value=ie().join("; ")),pe(A)}},l.selectItem=function(Z){l.selectIndex(Z.indexValue)};var He=function(Z,K){for(var ae=0;ae<K.length;ae++)if(l.options.format){if(K[ae].id==Z)return!0}else if(K[ae].value==Z)return!0;return!1};return l.find=function(Z){if(l.search==Z.trim())return!1;if(l.search=Z,l.setCursor(),l.groups.length)for(var K=0;K<l.groups.length;K++)l.groups[K].lastChild.textContent="";if(fe.textContent="",l.options.remoteSearch==!0){l.results=null;var ae=l.options.url;let Te={url:ae,method:"GET",data:{q:Z},dataType:"json",success:function(Ge){l.items=[];var De=Object.keys(l.value);if(De.length)for(var Ze=0;Ze<De.length;Ze++)He(De[Ze],Ge)||(l.options.format?Ge.unshift({id:De[Ze],name:l.value[De[Ze]]}):Ge.unshift({value:De[Ze],text:l.value[De[Ze]]}));l.appendData(Ge),Ge.length?fe.style.display="":fe.style.display="none",typeof l.options.onsearch=="function"&&l.options.onsearch(l,Ge)}};if(typeof l.options.onbeforesearch=="function"){let Ge=l.options.onbeforesearch(l,Te);if(Ge===!1)return;typeof Ge=="object"&&(Te=Ge)}O(Te)}else{Z=new RegExp(Z,"gi");for(var A=[],K=0;K<l.items.length;K++){var W=Y(K),ee=l.items[K].data.title||"",me=l.items[K].data.group||"",re=l.items[K].data.synonym||"";re&&(re=re.join(" ")),(Z==null||l.items[K].selected==!0||W.match(Z)||ee.match(Z)||me.match(Z)||re.match(Z))&&A.push(l.items[K])}if(!A.length)fe.style.display="none",l.results=null;else{fe.style.display="",l.results=A;var he=A.length||0;l.options.lazyLoading==!0&&he>200&&(he=200);for(var K=0;K<he;K++)l.results[K].group?(l.results[K].group.parentNode||fe.appendChild(l.results[K].group),l.results[K].group.lastChild.appendChild(l.results[K].element)):fe.appendChild(l.results[K].element)}}l.options.autofocus==!0&&l.first()},l.open=function(){if(!M.classList.contains("jdropdown-focus")){E.current=l,f(l,!0),M.classList.add("jdropdown-focus"),c.getWindowWidth()<800&&(l.options.type==null||l.options.type=="picker")&&U.slideBottom(ge,1),l.options.autocomplete==!0&&(l.header.value=l.search,l.header.focus());var Z=J();if(Z[0]){var K=l.getPosition(Z[0]);K!==!1&&l.setCursor(K)}if(!l.options.type||l.options.type=="default"){var ae=M.getBoundingClientRect(),A=ge.getBoundingClientRect();l.options.position?(ge.style.position="fixed",window.innerHeight<ae.bottom+A.height?(ge.style.top="",ge.style.bottom=window.innerHeight-ae.top+1+"px"):(ge.style.top=ae.bottom+"px",ge.style.bottom=""),ge.style.left=ae.left+"px"):window.innerHeight<ae.bottom+A.height?(ge.style.top="",ge.style.bottom=ae.height+1+"px"):(ge.style.top="",ge.style.bottom=""),ge.style.minWidth=ae.width+"px",l.options.maxWidth&&(ge.style.maxWidth=l.options.maxWidth),!l.items.length&&l.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof l.options.onopen=="function"&&l.options.onopen(M)},l.close=function(Z){return M.classList.contains("jdropdown-focus")&&(l.header.value=l.getText(),l.setCursor(),!Z&&typeof l.options.onclose=="function"&&l.options.onclose(M),l.header.blur&&l.header.blur(),M.classList.remove("jdropdown-focus"),f(l,!1),E.current=null),l.getValue()},l.setCursor=function(Z,K){if(l.currentIndex!=null&&l.items&&l.items[l.currentIndex]&&l.items[l.currentIndex].element.classList.remove("jdropdown-cursor"),Z==null)l.currentIndex=null;else if(Z=parseInt(Z),l.items[Z].element.parentNode&&(l.items[Z].element.classList.add("jdropdown-cursor"),l.currentIndex=Z,K!==!1&&l.items[l.currentIndex].element)){fe.scrollTop;var ae=l.items[l.currentIndex].element;fe.scrollTop=ae.offsetTop-ae.scrollTop+ae.clientTop-95}},l.resetCursor=l.setCursor,l.updateCursor=l.setCursor,l.reset=function(){l.setCursor(),l.setValue(null)},l.first=function(){l.options.lazyLoading===!0&&l.loadFirst();var Z=fe.querySelectorAll(".jdropdown-item");if(Z.length){var K=Z[0].indexValue;l.setCursor(K)}},l.last=function(){l.options.lazyLoading===!0&&l.loadLast();var Z=fe.querySelectorAll(".jdropdown-item");if(Z.length){var K=Z[Z.length-1].indexValue;l.setCursor(K)}},l.next=function(Z){var K=null;if(Z){if(Z.length==1){var ae=l.currentIndex||-1;Z=Z.toLowerCase();var A=null,W=null,ee=fe.querySelectorAll(".jdropdown-item");if(ee.length){for(var me=0;me<ee.length;me++)if(ee[me].indexValue>ae&&(A=l.items[ee[me].indexValue])&&(W=A.element.innerText[0])&&(W=W.toLowerCase(),Z==W)){K=ee[me].indexValue;break}l.setCursor(K)}}}else if(l.currentIndex==null||l.currentIndex==null)l.first();else{var re=l.items[l.currentIndex].element,he=re.nextElementSibling;he?(he.classList.contains("jdropdown-group")&&(he=he.lastChild.firstChild),K=he.indexValue):re.parentNode.classList.contains("jdropdown-group-items")&&((he=re.parentNode.parentNode.nextElementSibling)&&(he.classList.contains("jdropdown-group")?he=he.lastChild.firstChild:he.classList.contains("jdropdown-item")?K=he.indexValue:he=null),he&&(K=he.indexValue)),K!==null&&l.setCursor(K)}},l.prev=function(){var Z=null;if(l.currentIndex===null)l.first();else{var K=l.items[l.currentIndex].element,ae=K.previousElementSibling;ae?(ae.classList.contains("jdropdown-group")&&(ae=ae.lastChild.lastChild),Z=ae.indexValue):K.parentNode.classList.contains("jdropdown-group-items")&&((ae=K.parentNode.parentNode.previousElementSibling)&&(ae.classList.contains("jdropdown-group")?ae=ae.lastChild.lastChild:ae.classList.contains("jdropdown-item")?Z=ae.indexValue:ae=null),ae&&(Z=ae.indexValue))}Z!==null&&l.setCursor(Z)},l.loadFirst=function(){if(l.results)var Z=l.results;else var Z=l.items;var K=Z.length||0;l.options.lazyLoading==!0&&K>200&&(K=200),fe.textContent="";for(var ae=0;ae<K;ae++)Z[ae].group?(Z[ae].group.parentNode||fe.appendChild(Z[ae].group),Z[ae].group.lastChild.appendChild(Z[ae].element)):fe.appendChild(Z[ae].element);fe.scrollTop=0},l.loadLast=function(){if(l.results)var Z=l.results;else var Z=l.items;var K=Z.length;if(K>200){K=K-200,fe.textContent="";for(var ae=K;ae<Z.length;ae++)Z[ae].group?(Z[ae].group.parentNode||fe.appendChild(Z[ae].group),Z[ae].group.lastChild.appendChild(Z[ae].element)):fe.appendChild(Z[ae].element);fe.scrollTop=fe.scrollHeight}},l.loadUp=function(){var Z=!1;if(l.results)var K=l.results;else var K=l.items;var ae=fe.querySelectorAll(".jdropdown-item"),A=ae[0].indexValue;A=l.items[A];var W=K.indexOf(A)-1;if(W>0){for(var ee=0;W>0&&K[W]&&ee<200;)K[W].group?(K[W].group.parentNode||fe.insertBefore(K[W].group,fe.firstChild),K[W].group.lastChild.insertBefore(K[W].element,K[W].group.lastChild.firstChild)):fe.insertBefore(K[W].element,fe.firstChild),W--,ee++;Z=!0}return Z},l.loadDown=function(){var Z=!1;if(l.results)var K=l.results;else var K=l.items;var ae=fe.querySelectorAll(".jdropdown-item"),A=ae[ae.length-1].indexValue;A=l.items[A];var W=K.indexOf(A)+1;if(W<K.length){for(var ee=0;W<K.length&&K[W]&&ee<200;)K[W].group?(K[W].group.parentNode||fe.appendChild(K[W].group),K[W].group.lastChild.appendChild(K[W].element)):fe.appendChild(K[W].element),W++,ee++;Z=!0}return Z},ze(),l};return E.keydown=function(M){var d=null;if(d=E.current){if(M.which==13||M.which==9)d.header.value&&d.currentIndex==null&&d.options.newOptions?d.add():(d.currentIndex==null&&d.options.autocomplete==!0&&d.header.value!=""&&d.find(d.header.value),d.selectIndex(d.currentIndex));else if(M.which==38)d.currentIndex==null?d.first():d.currentIndex>0&&d.prev(),M.preventDefault();else if(M.which==40)d.currentIndex==null?d.first():d.currentIndex+1<d.items.length&&d.next(),M.preventDefault();else if(M.which==36)d.first(),M.target.classList.contains("jdropdown-header")||M.preventDefault();else if(M.which==35)d.last(),M.target.classList.contains("jdropdown-header")||M.preventDefault();else if(M.which==27)d.close();else if(M.which==33){if(d.currentIndex==null)d.first();else if(d.currentIndex>0)for(var l=0;l<7;l++)d.prev();M.preventDefault()}else if(M.which==34){if(d.currentIndex==null)d.first();else if(d.currentIndex+1<d.items.length)for(var l=0;l<7;l++)d.next();M.preventDefault()}}},E.mouseup=function(M){var d=c.findElement(M.target,"jdropdown");if(d){var l=d.dropdown;if(M.target.classList.contains("jdropdown-header"))if(d.classList.contains("jdropdown-focus")&&d.classList.contains("jdropdown-default")){var _=d.getBoundingClientRect();if(M.changedTouches&&M.changedTouches[0]){var G=M.changedTouches[0].clientX;M.changedTouches[0].clientY}else{var G=M.clientX;M.clientY}_.width-(G-_.left)<30?M.target.classList.contains("jdropdown-add")?l.add():l.close():l.options.autocomplete==!1&&l.close()}else l.open();else if(M.target.classList.contains("jdropdown-group-name")){var ne=M.target.nextSibling.children;if(M.target.nextSibling.style.display!="none")for(var k=0;k<ne.length;k++)ne[k].style.display!="none"&&l.selectItem(ne[k])}else M.target.classList.contains("jdropdown-group-arrow")?M.target.classList.contains("jdropdown-group-arrow-down")?(M.target.classList.remove("jdropdown-group-arrow-down"),M.target.classList.add("jdropdown-group-arrow-up"),M.target.parentNode.nextSibling.style.display="none"):(M.target.classList.remove("jdropdown-group-arrow-up"),M.target.classList.add("jdropdown-group-arrow-down"),M.target.parentNode.nextSibling.style.display=""):M.target.classList.contains("jdropdown-item")?l.selectItem(M.target):M.target.classList.contains("jdropdown-image")||M.target.classList.contains("jdropdown-description")?l.selectItem(M.target.parentNode):M.target.classList.contains("jdropdown-title")?l.selectItem(M.target.parentNode.parentNode):(M.target.classList.contains("jdropdown-close")||M.target.classList.contains("jdropdown-backdrop"))&&l.close()}},E.extractFromDom=function(M,d){var l=M;if(d||(d={}),M.getAttribute("multiple")&&(!d||d.multiple==null)&&(d.multiple=!0),M.getAttribute("placeholder")&&(!d||d.placeholder==null)&&(d.placeholder=M.getAttribute("placeholder")),M.getAttribute("data-autocomplete")&&(!d||d.autocomplete==null)&&(d.autocomplete=!0),(!d||d.width==null)&&(d.width=M.offsetWidth),M.value&&(!d||d.value==null)&&(d.value=M.value),!d||d.data==null){d.data=[];for(var _=0;_<M.children.length;_++)if(M.children[_].tagName=="OPTGROUP")for(var G=0;G<M.children[_].children.length;G++)d.data.push({value:M.children[_].children[G].value,text:M.children[_].children[G].textContent,group:M.children[_].getAttribute("label")});else d.data.push({value:M.children[_].value,text:M.children[_].textContent})}(!d||d.onchange==null)&&(d.onchange=function(k,S,Y,J){d.multiple==!0?obj.items[S].classList.contains("jdropdown-selected")?l.options[S].setAttribute("selected","selected"):l.options[S].removeAttribute("selected"):l.value=J});var ne=document.createElement("div");return M.parentNode.insertBefore(ne,M),M.style.display="none",M=ne,{el:M,options:d}},E}var se=ye();function we(E,M){if(E.picker)return E.picker.setOptions(M,!0);var d={type:"picker"};d.options={};var l=null,_=null,G=function(S){return S instanceof Element||S instanceof HTMLDocument},ne=function(){_.innerHTML="";for(var S=Object.keys(d.options.data),Y=0;Y<S.length;Y++){var J=document.createElement("div");J.classList.add("jpicker-item"),J.k=S[Y],J.v=d.options.data[S[Y]];var ie=d.getLabel(S[Y],J);G(ie)?J.appendChild(ie):J.innerHTML=ie,_.appendChild(J)}};d.setOptions=function(S,Y){var J={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};S&&S.options&&(S.data=S.options);for(var ie in J)S&&S.hasOwnProperty(ie)?d.options[ie]=S[ie]:(typeof d.options[ie]>"u"||Y===!0)&&(d.options[ie]=J[ie]);return d.options.header===!1?l.style.display="none":l.style.display="",d.options.width?l.style.width=parseInt(d.options.width)+"px":l.style.width="",d.options.height?(_.style.maxHeight=d.options.height+"px",_.style.overflow="scroll"):_.style.overflow="",d.options.columns>0&&(d.options.grid?(_.classList.add("jpicker-grid"),_.style.gridTemplateColumns="repeat("+d.options.grid+", 1fr)"):(_.classList.add("jpicker-columns"),_.style.width=d.options.width?d.options.width:36*d.options.columns+"px")),isNaN(parseInt(d.options.value))&&(d.options.value=0),ne(),d.setValue(d.options.value),d},d.getValue=function(){return d.options.value},d.setValue=function(S,Y){if(d.setLabel(S),d.options.value=String(S),E.value!=d.options.value&&(E.value=d.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),_.children[S]&&_.children[S].getAttribute("type")!=="generic"&&d.close(),Y&&typeof d.options.onchange=="function"){var J=d.options.data[S];d.options.onchange(E,d,J,J,S,Y)}},d.getLabel=function(S,Y){var J=d.options.data[S]||null;return typeof d.options.render=="function"&&(J=d.options.render(J,Y)),J},d.setLabel=function(S){var Y;d.options.content?Y='<i class="material-icons">'+d.options.content+"</i>":Y=d.getLabel(S,null),G(Y)?(l.innerHTML="",l.appendChild(Y)):l.innerHTML=Y},d.open=function(){if(!E.classList.contains("jpicker-focus")){f(d,!0),E.classList.add("jpicker-focus"),E.focus();var S=0,Y=0;_.style.marginLeft="";var J=l.getBoundingClientRect(),ie=_.getBoundingClientRect();window.innerHeight<J.bottom+ie.height||d.options.bottom?S=-1*(ie.height+4):S=J.height+4,d.options.right===!0&&(Y=-1*ie.width+J.width),ie.left+Y<0&&(Y=Y+ie.left+10),ie.left+ie.width>window.innerWidth&&(Y=-1*(10+ie.left+ie.width-window.innerWidth)),_.style.marginTop=parseInt(S)+"px",_.style.marginLeft=parseInt(Y)+"px",typeof d.options.onopen=="function"&&d.options.onopen(E,d)}},d.close=function(){E.classList.contains("jpicker-focus")&&(E.classList.remove("jpicker-focus"),f(d,!1),typeof d.options.onclose=="function"&&d.options.onclose(E,d))};var k=function(){E.classList.add("jpicker"),E.setAttribute("tabindex","900"),E.onmousedown=function(S){E.classList.contains("jpicker-focus")||d.open()},l=document.createElement("div"),l.classList.add("jpicker-header"),_=document.createElement("div"),_.classList.add("jpicker-content"),_.onclick=function(S){var Y=c.findElement(S.target,"jpicker-item");Y&&Y.parentNode===_&&d.setValue(Y.k,S)},E.appendChild(l),E.appendChild(_),E.value=M.value||0,d.setOptions(M),typeof d.options.onload=="function"&&d.options.onload(E,d),E.change=d.setValue,E.val=function(S){if(S===void 0)return d.getValue();d.setValue(S)},E.picker=d};return k(),d}function qe(E,M){var d={type:"toolbar"};d.options={};var l={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var _ in l)M&&M.hasOwnProperty(_)?d.options[_]=M[_]:d.options[_]=l[_];!E&&M.app&&M.app.el&&(E=document.createElement("div"),M.app.el.appendChild(E));var G=document.createElement("div");G.classList.add("jtoolbar-item"),G.classList.add("jtoolbar-arrow");var ne=document.createElement("div");ne.classList.add("jtoolbar-floating"),G.appendChild(ne),d.selectItem=function(S){for(var Y=k.children,J=0;J<Y.length;J++)S!=Y[J]&&Y[J].classList.remove("jtoolbar-selected");S.classList.add("jtoolbar-selected")},d.hide=function(){U.slideBottom(E,0,function(){E.style.display="none"})},d.show=function(){E.style.display="",U.slideBottom(E,1)},d.get=function(){return E},d.setBadge=function(S,Y){k.children[S].children[1].firstChild.innerHTML=Y},d.destroy=function(){toolbar.remove(),E.innerHTML=""},d.update=function(S,Y){for(var J=0;J<k.children.length;J++){var ie=k.children[J];typeof ie.updateState=="function"&&ie.updateState(E,d,ie,S,Y)}for(var J=0;J<ne.children.length;J++){var ie=ne.children[J];typeof ie.updateState=="function"&&ie.updateState(E,d,ie,S,Y)}},d.create=function(S){k.innerHTML="";for(var Y=0;Y<S.length;Y++){var J=document.createElement("div");if(J.classList.add("jtoolbar-item"),S[Y].width&&(J.style.width=parseInt(S[Y].width)+"px"),S[Y].k&&(J.k=S[Y].k),S[Y].tooltip&&J.setAttribute("title",S[Y].tooltip),S[Y].id&&J.setAttribute("id",S[Y].id),S[Y].updateState&&(J.updateState=S[Y].updateState),S[Y].active&&J.classList.add("jtoolbar-active"),S[Y].disabled&&J.classList.add("jtoolbar-disabled"),S[Y].type=="select"||S[Y].type=="dropdown")we(J,S[Y]);else if(S[Y].type=="divisor")J.classList.add("jtoolbar-divisor");else if(S[Y].type=="label")J.classList.add("jtoolbar-label"),J.innerHTML=S[Y].content;else{var ie=document.createElement("i");if(typeof S[Y].class>"u")ie.classList.add("material-icons");else for(var xe=S[Y].class.split(" "),ge=0;ge<xe.length;ge++)ie.classList.add(xe[ge]);if(ie.innerHTML=S[Y].content?S[Y].content:"",J.appendChild(ie),d.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var Re=document.createElement("div");Re.innerHTML=S[Y].badge?S[Y].badge:"",fe.appendChild(Re),J.appendChild(fe)}if(S[Y].title)if(d.options.title==!0){var We=document.createElement("span");We.innerHTML=S[Y].title,J.appendChild(We)}else J.setAttribute("title",S[Y].title);d.options.app&&S[Y].route&&(J.route=S[Y].route,J.onclick=function(){d.options.app.pages(this.route)},d.options.app.pages(S[Y].route,{toolbarItem:J,closed:!0})),typeof S[Y].render=="function"&&S[Y].render(J,S[Y])}S[Y].onclick&&(J.onclick=S[Y].onclick.bind(S[Y],E,d,J)),k.appendChild(J)}setTimeout(function(){d.refresh()},0)},d.open=function(){G.classList.add("jtoolbar-arrow-selected"),E.getBoundingClientRect();var S=ne.getBoundingClientRect();S.bottom>window.innerHeight||d.options.bottom?ne.style.bottom="0":ne.style.removeProperty("bottom"),ne.style.right="0",G.children[0].focus(),f(d,!0)},d.close=function(){G.classList.remove("jtoolbar-arrow-selected"),f(d,!1)},d.refresh=function(){if(d.options.responsive==!0){var S=E.parentNode.getBoundingClientRect();d.options.maxWidth||(d.options.maxWidth=S.width);var Y=parseInt(d.options.maxWidth);for(G.parentNode&&G.parentNode.removeChild(G);ne.firstChild;)k.appendChild(ne.firstChild);if(Y<k.offsetWidth)for(Y-=50;k.lastChild&&Y<k.offsetWidth;)ne.insertBefore(k.lastChild,ne.firstChild);ne.children.length>0&&k.appendChild(G)}},d.setReadonly=function(S){S=S?"add":"remove",E.classList[S]("jtoolbar-disabled")},E.onclick=function(S){var Y=c.findElement(S.target,"jtoolbar-item");Y&&d.selectItem(Y),S.target.classList.contains("jtoolbar-arrow")&&d.open()},window.addEventListener("resize",function(){d.refresh()}),E.classList.add("jtoolbar"),E.innerHTML="",d.options.container==!0&&E.classList.add("jtoolbar-container");var k=document.createElement("div");return E.appendChild(k),d.options.app&&E.classList.add("jtoolbar-mobile"),d.create(d.options.items),E.toolbar=d,d}function _e(){var E=function(M,d){var l={type:"editor"};l.options={};var _={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var G in _)d&&d.hasOwnProperty(G)?l.options[G]=d[G]:l.options[G]=_[G];var ne=null,k=null,S=[];l.el=M,typeof l.options.onclick=="function"&&(M.onclick=function(le){l.options.onclick(M,l,le)}),M.classList.add("jeditor-container");var Y=document.createElement("div");Y.className="jsnippet",Y.setAttribute("contenteditable",!1);var J=document.createElement("div");if(J.className="jeditor-toolbar",l.editor=document.createElement("div"),l.editor.setAttribute("contenteditable",!0),l.editor.setAttribute("spellcheck",!1),l.editor.classList.add("jeditor"),l.options.placeholder&&l.editor.setAttribute("data-placeholder",l.options.placeholder),(l.options.maxHeight||l.options.height)&&(l.editor.style.overflowY="auto",l.options.maxHeight&&(l.editor.style.maxHeight=l.options.maxHeight),l.options.height&&(l.editor.style.height=l.options.height)),l.options.url)O({url:l.options.url,dataType:"html",success:function(le){l.editor.innerHTML=le,E.setCursor(l.editor,l.options.focus=="initial")}});else if(l.options.value)l.editor.innerHTML=l.options.value;else for(var ie=0;ie<M.children.length;ie++)l.editor.appendChild(M.children[ie]);M.innerHTML="";var xe=function(le){typeof l.options.onchange=="function"&&l.options.onchange(M,l,le),l.options.value=l.getData(),M.value!=l.options.value&&(M.value=l.options.value,typeof M.oninput=="function"&&M.oninput({type:"input",target:M,value:M.value}))},ge=function(le){var Ae=document.createElement("div");Ae.innerHTML=le;var Ne=Ae.querySelectorAll("img");if(Ne.length)for(var nt=0;nt<Ne.length;nt++)l.addImage(Ne[nt].src)},fe=function(){var le=null;if(le=Y.children[0]){le.classList.contains("jslider-grid")||le.classList.add("jslider-grid");var Ae=le.children.length;le.setAttribute("data-number",Ae>4?4:Ae),Ae>4?le.setAttribute("data-total",Ae-4):le.removeAttribute("data-total")}},Re=function(le){Y.innerHTML||l.appendSnippet({}),Y.children[0].appendChild(le),fe()};l.appendSnippet=function(le){Y.innerHTML="";for(var Ae=["image","title","description","host","url"],Ne=0;Ne<Ae.length;Ne++){var nt=document.createElement("div");if(nt.className="jsnippet-"+Ae[Ne],nt.setAttribute("data-k",Ae[Ne]),Y.appendChild(nt),le[Ae[Ne]])if(Ae[Ne]=="image"){Array.isArray(le.image)||(le.image=[le.image]);for(var ht=0;ht<le.image.length;ht++){var ut=document.createElement("img");ut.src=le.image[ht],nt.appendChild(ut)}}else nt.innerHTML=le[Ae[Ne]]}l.editor.appendChild(document.createElement("br")),l.editor.appendChild(Y)},l.setData=function(le){typeof le=="object"?l.editor.innerHTML=le.content:l.editor.innerHTML=le,l.options.focus&&E.setCursor(l.editor,!0),S=[]},l.getFiles=function(){for(var le=l.editor.querySelectorAll(".jfile"),Ae=[],Ne=0;Ne<le.length;Ne++)S[le[Ne].src]&&Ae.push(S[le[Ne].src]);return Ae},l.getText=function(){return l.editor.innerText},l.getData=function(le){if(le){var Ae={content:""};if(Y.innerHTML){Ae.snippet={};for(var Ne=0;Ne<Y.children.length;Ne++){var nt=Y.children[Ne].getAttribute("data-k");if(nt)if(nt=="image"){Ae.snippet.image||(Ae.snippet.image=[]);for(var ht=0;ht<Y.children[Ne].children.length;ht++)Ae.snippet.image.push(Y.children[Ne].children[ht].getAttribute("src"))}else Ae.snippet[nt]=Y.children[Ne].innerHTML}}var ut=Object.keys(S);if(ut.length){Ae.files=[];for(var Ne=0;Ne<ut.length;Ne++)Ae.files.push(S[ut[Ne]])}var mt=document.createElement("div");mt.innerHTML=l.editor.innerHTML;var jt=mt.querySelector(".jsnippet");jt&&jt.remove();var rt=mt.innerHTML;rt=rt.replace(/<br>/g,`
`),rt=rt.replace(/<\/div>/g,`</div>
`),rt=rt.replace(/<(?:.|\n)*?>/gm,""),Ae.content=rt.trim(),Ze("getData",Ae)}else var Ae=l.editor.innerHTML;return Ae},l.reset=function(){l.editor.innerHTML="",Y.innerHTML="",S=[]},l.addPdf=function(le){if(le.result.substr(0,4)!="data")console.error("Invalid source");else{var Ae=document.createElement("canvas");Ae.width=60,Ae.height=60;var Ne=new Image,nt=Ae.getContext("2d");nt.drawImage(Ne,0,0,Ae.width,Ae.height),Ae.toBlob(function(ht){var ut=document.createElement("img");ut.src=window.URL.createObjectURL(ht),ut.title=le.name,ut.className="jfile pdf",S[ut.src]={file:ut.src,extension:"pdf",content:le.result},document.execCommand("insertHtml",!1,ut.outerHTML)})}},l.addImage=function(le,Ae){if(le||(le=""),le.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(le.substr(0,4)=="data"){var Ne=le.split(";");Ne=Ne[0].split("/"),Ne=Ne[1]}else{var Ne=le.substr(le.lastIndexOf(".")+1);le=l.options.remoteParser+le}var nt=new Image;nt.onload=function(){var ut=document.createElement("canvas");ut.width=nt.width,ut.height=nt.height;var mt=ut.getContext("2d");mt.drawImage(nt,0,0,ut.width,ut.height),ut.toBlob(function(jt){var rt=document.createElement("img");rt.src=window.URL.createObjectURL(jt),rt.classList.add("jfile"),rt.setAttribute("tabindex","900"),rt.setAttribute("width",nt.width),rt.setAttribute("height",nt.height),S[rt.src]={file:rt.src,extension:Ne,content:ut.toDataURL()},l.options.dropAsSnippet||Ae?(Re(rt),S[rt.src].snippet=!0):document.execCommand("insertHtml",!1,rt.outerHTML),xe()})},nt.src=le}},l.addFile=function(le){for(var Ae=[],Ne=0;Ne<le.length;Ne++)if(le[Ne].size>l.options.maxFileSize)alert("The file is too big");else{var nt=le[Ne].type.split("/");nt[0]=="image"?nt=1:nt[1]=="pdf"?nt=2:nt=0,nt?(Ae[Ne]=new FileReader,Ae[Ne].index=Ne,Ae[Ne].type=nt,Ae[Ne].name=le[Ne].name,Ae[Ne].date=le[Ne].lastModified,Ae[Ne].size=le[Ne].size,Ae[Ne].addEventListener("load",function(ht){ht.target.type==2?l.options.acceptFiles==!0&&l.addPdf(ht.target):l.addImage(ht.target.result)},!1),Ae[Ne].readAsDataURL(le[Ne])):alert("The extension is not allowed")}},l.destroy=function(){l.editor.removeEventListener("mouseup",Te),l.editor.removeEventListener("mousedown",Ge),l.editor.removeEventListener("mousemove",De),l.editor.removeEventListener("keyup",re),l.editor.removeEventListener("keydown",he),l.editor.removeEventListener("dragstart",K),l.editor.removeEventListener("dragenter",ae),l.editor.removeEventListener("dragover",A),l.editor.removeEventListener("drop",W),l.editor.removeEventListener("paste",Z),l.editor.removeEventListener("blur",ee),l.editor.removeEventListener("focus",me),M.editor=null,M.classList.remove("jeditor-container"),J.remove(),Y.remove(),l.editor.remove()},l.upload=function(){c.click(l.file)};var We=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],Je=["width","height","align","border","src","tabindex"],Me=["color","font-weight","font-size","background","background-color","margin"],ze=function(le){if(le.attributes&&le.attributes.length){var Ae=null,Ne=le.getAttribute("style");if(Ne){Ae=[];for(var nt=Ne.split(";"),ht=0;ht<nt.length;ht++){var ut=nt[ht].trim().split(":");if(Me.indexOf(ut[0].trim())>=0){var mt=ut.shift(),ut=ut.join(":");Ae.push(mt+":"+ut)}}}le.tagName.toUpperCase()=="IMG"&&(!l.options.acceptImages||!le.src?le.parentNode.removeChild(le):(le.setAttribute("tabindex","900"),l.addImage(le.src)));for(var jt=[],rt=0;rt<le.attributes.length;rt++)jt.push(le.attributes[rt].name);jt.length&&jt.forEach(function(st){Je.indexOf(st)==-1?le.removeAttribute(st):le.attributes[rt].value.indexOf("<")!==-1&&le.attributes[rt].value.replace("<","&#60;")}),le.style="",Ae&&Ae.length&&le.setAttribute("style",Ae.join(";"))}if(le.children.length)for(var rt=0;rt<le.children.length;rt++)ze(le.children[rt]);We.indexOf(le.constructor)>=0&&le.remove()},pe=function(le){var Ae=window.getSelection(),Ne=document.createRange();Ne.selectNode(le),Ae.addRange(Ne)},He=function(le){le&&(le=le.replace(new RegExp("<!--(.*?)-->","gsi"),""));var Ae=new DOMParser,Ne=Ae.parseFromString(le,"text/html");ze(Ne);var nt=document.createElement("span");return nt.innerHTML=Ne.firstChild.innerHTML,nt},Z=function(le){if(l.options.filterPaste==!0){if(le.clipboardData||le.originalEvent.clipboardData)var Ae=(le.originalEvent||le).clipboardData.getData("text/html"),Ne=(le.originalEvent||le).clipboardData.getData("text/plain"),nt=(le.originalEvent||le).clipboardData.files;else if(window.clipboardData)var Ae=window.clipboardData.getData("Html"),Ne=window.clipboardData.getData("Text"),nt=window.clipboardData.files;if(nt.length)l.addFile(nt);else if(!Ae)Ae=Ne.split(`\r
`),le.target.innerText?(Ae=Ae.map(function(ut){return"<div>"+ut+"</div>"}),document.execCommand("insertHtml",!1,Ae.join(""))):Ae.map(function(ut){var mt=document.createElement("div");mt.innerText=ut,l.editor.appendChild(mt)});else{var ht=He(Ae);document.execCommand("insertHtml",!1,ht.innerHTML)}le.preventDefault()}},K=function(le){k&&k.e&&le.preventDefault()},ae=function(le){k||l.options.dropZone==!1||(M.classList.add("jeditor-dragging"),le.preventDefault())},A=function(le){k||l.options.dropZone==!1||(ne&&clearTimeout(ne),ne=setTimeout(function(){M.classList.remove("jeditor-dragging")},100),le.preventDefault())},W=function(le){if(!(k||l.options.dropZone==!1)){var Ae=null;document.caretRangeFromPoint?Ae=document.caretRangeFromPoint(le.clientX,le.clientY):le.rangeParent&&(Ae=document.createRange(),Ae.setStart(le.rangeParent,le.rangeOffset));var Ne=window.getSelection();Ne.removeAllRanges(),Ne.addRange(Ae),Ne.anchorNode.parentNode.focus();var nt=(le.originalEvent||le).dataTransfer.getData("text/html"),ht=(le.originalEvent||le).dataTransfer.getData("text/plain"),ut=(le.originalEvent||le).dataTransfer.files;ut.length?l.addFile(ut):ht&&ge(nt),M.classList.remove("jeditor-dragging"),le.preventDefault()}},ee=function(le){Ze("onevent",le),xe(le),typeof l.options.onblur=="function"&&l.options.onblur(M,l,le)},me=function(le){typeof l.options.onfocus=="function"&&l.options.onfocus(M,l,le)},re=function(le){l.editor.innerHTML||(l.editor.innerHTML="<div><br></div>"),typeof l.options.onkeyup=="function"&&l.options.onkeyup(M,l,le)},he=function(le){if(Ze("onevent",le),le.key=="Delete"&&le.target.tagName=="IMG"){var Ae=le.target.parentNode;pe(le.target),Ae.classList.contains("jsnippet-image")&&fe()}typeof l.options.onkeydown=="function"&&l.options.onkeydown(M,l,le)},Te=function(le){if(k&&k.e&&(k.e.classList.remove("resizing"),k.e.changed==!0)){var Ae=k.e.cloneNode();Ae.width=parseInt(k.e.style.width)||k.e.getAttribute("width"),Ae.height=parseInt(k.e.style.height)||k.e.getAttribute("height"),k.e.style.width="",k.e.style.height="",pe(k.e),document.execCommand("insertHtml",!1,Ae.outerHTML)}k=!1},Ge=function(le){var Ae=function(ut){var mt=ut.getBoundingClientRect();mt.width-(le.clientX-mt.left)<40&&le.clientY-mt.top<40&&(ut.innerHTML="",ut.remove())};if(le.target.tagName=="IMG")if(le.target.style.cursor){var Ne=le.target.getBoundingClientRect();k={e:le.target,x:le.clientX,y:le.clientY,w:Ne.width,h:Ne.height,d:le.target.style.cursor},le.target.getAttribute("width")||le.target.setAttribute("width",Ne.width),le.target.getAttribute("height")||le.target.setAttribute("height",Ne.height);var nt=window.getSelection();if(nt.rangeCount)for(var ht=0;ht<nt.rangeCount;ht++)nt.removeRange(nt.getRangeAt(ht));le.target.classList.add("resizing")}else k=!0;else le.target.classList.contains("jsnippet")?Ae(le.target):le.target.parentNode.classList.contains("jsnippet")&&Ae(le.target.parentNode),k=!0},De=function(le){if(le.target.tagName=="IMG"&&!le.target.parentNode.classList.contains("jsnippet-image")&&l.options.allowImageResize==!0&&le.target.getAttribute("tabindex")){var Ae=le.target.getBoundingClientRect();le.clientY-Ae.top<5?Ae.width-(le.clientX-Ae.left)<5?le.target.style.cursor="ne-resize":le.clientX-Ae.left<5?le.target.style.cursor="nw-resize":le.target.style.cursor="n-resize":Ae.height-(le.clientY-Ae.top)<5?Ae.width-(le.clientX-Ae.left)<5?le.target.style.cursor="se-resize":le.clientX-Ae.left<5?le.target.style.cursor="sw-resize":le.target.style.cursor="s-resize":Ae.width-(le.clientX-Ae.left)<5?le.target.style.cursor="e-resize":le.clientX-Ae.left<5?le.target.style.cursor="w-resize":le.target.style.cursor=""}if(le.which==1&&k&&k.d){if(k.d=="e-resize"||k.d=="ne-resize"||k.d=="se-resize")if(k.e.style.width=k.w+(le.clientX-k.x),le.shiftKey){var Ne=(le.clientX-k.x)*(k.h/k.w);k.e.style.height=k.h+Ne}else var Ne=null;Ne||(k.d=="s-resize"||k.d=="se-resize"||k.d=="sw-resize")&&(le.shiftKey||(k.e.style.height=k.h+(le.clientY-k.y))),k.e.changed=!0}},Ze=function(le,Ae){if(l.options.extensions){var Ne=Object.keys(l.options.extensions);if(Ne.length)for(var nt=0;nt<Ne.length;nt++)l.options.extensions[Ne[nt]]&&typeof l.options.extensions[Ne[nt]][le]=="function"&&l.options.extensions[Ne[nt]][le].call(l,Ae)}},it=function(){if(l.options.extensions){var le=Object.keys(l.options.extensions);if(le.length)for(var Ae=0;Ae<le.length;Ae++)l.options.extensions[le[Ae]]&&typeof l.options.extensions[le[Ae]]=="function"&&(l.options.extensions[le[Ae]]=l.options.extensions[le[Ae]](M,l))}};if(document.addEventListener("mouseup",Te),document.addEventListener("mousemove",De),l.editor.addEventListener("mousedown",Ge),l.editor.addEventListener("keyup",re),l.editor.addEventListener("keydown",he),l.editor.addEventListener("dragstart",K),l.editor.addEventListener("dragenter",ae),l.editor.addEventListener("dragover",A),l.editor.addEventListener("drop",W),l.editor.addEventListener("paste",Z),l.editor.addEventListener("focus",me),l.editor.addEventListener("blur",ee),M.appendChild(l.editor),l.options.snippet&&l.appendSnippet(l.options.snippet),l.options.toolbar){if(Array.isArray(l.options.toolbar))var dt={container:!0,responsive:!0,items:l.options.toolbar};else if(l.options.toolbar===!0)var dt={container:!0,responsive:!0,items:[]};else var dt=l.options.toolbar;dt.items&&dt.items.length||(dt.items=E.getDefaultToolbar(l)),l.options.toolbarOnTop?(M.classList.add("toolbar-on-top"),M.insertBefore(J,M.firstChild)):(l.editor.style.padding="15px",M.appendChild(J)),qe(J,dt),J.addEventListener("click",function(){l.editor.focus()})}return l.file=document.createElement("input"),l.file.style.display="none",l.file.type="file",l.file.setAttribute("accept","image/*"),l.file.onchange=function(){l.addFile(this.files)},M.appendChild(l.file),l.options.focus&&E.setCursor(l.editor,l.options.focus=="initial"),M.change=l.setData,M.val=function(le){if(le===void 0){var Ae=M.getAttribute("data-html")!=="true";return l.getData(Ae)}else l.setData(le)},it(),M.editor=l,typeof l.options.onload=="function"&&l.options.onload(M,l,l.editor),l};return E.setCursor=function(M,d){M.focus(),document.execCommand("selectAll");var l=window.getSelection(),_=l.getRangeAt(0);if(d==!0)var G=_.startContainer,ne=0;else var G=_.endContainer,ne=G.length;_.setStart(G,ne),_.setEnd(G,ne),l.removeAllRanges(),l.addRange(_)},E.getDefaultToolbar=function(M){var d=function(_,G,ne){ne.color||(oe(ne,{onchange:function(k,S){ne.k==="color"?document.execCommand("foreColor",!1,S):document.execCommand("backColor",!1,S)}}),ne.color.open())},l=[];return l.push({content:"undo",onclick:function(){document.execCommand("undo")}}),l.push({content:"redo",onclick:function(){document.execCommand("redo")}}),l.push({type:"divisor"}),M.options.toolbarOnTop&&(l.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(_){return'<span style="font-family:'+_+'">'+_+"</span>"},onchange:function(_,G,ne,k,S){document.execCommand("fontName",!1,k)}}),l.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(_){return'<span style="font-size:'+_+'">'+_+"</span>"},onchange:function(_,G,ne,k,S){document.execCommand("fontSize",!1,parseInt(S)+1)}}),l.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(_){return'<i class="material-icons">'+_+"</i>"},onchange:function(_,G,ne,k,S){var Y=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(Y[S])}}),l.push({type:"divisor"}),l.push({content:"format_color_text",k:"color",onclick:d}),l.push({content:"format_color_fill",k:"background-color",onclick:d})),l.push({content:"format_bold",onclick:function(_,G,ne){document.execCommand("bold"),document.queryCommandState("bold")?ne.classList.add("selected"):ne.classList.remove("selected")}}),l.push({content:"format_italic",onclick:function(_,G,ne){document.execCommand("italic"),document.queryCommandState("italic")?ne.classList.add("selected"):ne.classList.remove("selected")}}),l.push({content:"format_underline",onclick:function(_,G,ne){document.execCommand("underline"),document.queryCommandState("underline")?ne.classList.add("selected"):ne.classList.remove("selected")}}),l.push({type:"divisor"}),l.push({content:"format_list_bulleted",onclick:function(_,G,ne){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ne.classList.add("selected"):ne.classList.remove("selected")}}),l.push({content:"format_list_numbered",onclick:function(_,G,ne){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ne.classList.add("selected"):ne.classList.remove("selected")}}),l.push({content:"format_indent_increase",onclick:function(_,G,ne){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ne.classList.add("selected"):ne.classList.remove("selected")}}),l.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),M.options.toolbarOnTop&&(l.push({type:"divisor"}),l.push({content:"photo",onclick:function(){M.upload()}}),l.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(_,G){G&&(G.onmouseover=this.onmouseover,_=_.split("x"),G.setAttribute("data-x",_[0]),G.setAttribute("data-y",_[1]));var ne=document.createElement("div");return G.style.margin="1px",G.style.border="1px solid #ddd",ne},onmouseover:function(_){for(var G=parseInt(_.target.getAttribute("data-x")),ne=parseInt(_.target.getAttribute("data-y")),k=0;k<_.target.parentNode.children.length;k++){var S=_.target.parentNode.children[k],Y=parseInt(S.getAttribute("data-x")),J=parseInt(S.getAttribute("data-y"));Y<=G&&J<=ne?(S.style.backgroundColor="#cae1fc",S.style.borderColor="#2977ff"):(S.style.backgroundColor="",S.style.borderColor="#ddd")}},onchange:function(_,G,ne){ne=ne.split("x");for(var k=document.createElement("table"),S=document.createElement("tbody"),Y=0;Y<=ne[1];Y++){for(var J=document.createElement("tr"),ie=0;ie<=ne[0];ie++){var xe=document.createElement("td");xe.innerHTML="",J.appendChild(xe)}S.appendChild(J)}k.appendChild(S),k.setAttribute("width","100%"),k.setAttribute("cellpadding","6"),k.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,k.outerHTML)}})),l},E}var Xe=_e();function at(){var E=function(M,d){var l={};l.options={};var _={type:"big",title:"Untitled",width:510,height:472};for(var G in _)d&&d.hasOwnProperty(G)?l.options[G]=d[G]:l.options[G]=_[G];var ne=function(){for(var Y=document.createElement("div");M.children[0];)Y.appendChild(M.children[0]);for(l.content=document.createElement("div"),l.content.className="jfloating_content",l.content.innerHTML=M.innerHTML;Y.children[0];)l.content.appendChild(Y.children[0]);l.container=document.createElement("div"),l.container.className="jfloating",l.container.appendChild(l.content),l.options.title?l.container.setAttribute("title",l.options.title):l.container.classList.add("no-title"),l.options.width&&(l.container.style.width=parseInt(l.options.width)+"px"),l.options.height&&(l.container.style.height=parseInt(l.options.height)+"px"),M.innerHTML="",M.appendChild(l.container)},k=function(){l.container&&l.container.addEventListener("click",function(Y){var J=Y.target.getBoundingClientRect();if(Y.target.classList.contains("jfloating")){if(Y.changedTouches&&Y.changedTouches[0])var ie=Y.changedTouches[0].clientX,xe=Y.changedTouches[0].clientY;else var ie=Y.clientX,xe=Y.clientY;J.width-(ie-J.left)<50&&xe-J.top<50?setTimeout(function(){l.close()},100):l.setState()}})},S=function(){l.container.classList.add("jfloating-"+l.options.type)};return l.state={isMinized:!1},l.setState=function(){l.state.isMinized?l.container.classList.remove("jfloating-minimized"):l.container.classList.add("jfloating-minimized"),l.state.isMinized=!l.state.isMinized},l.close=function(){Components.elements.splice(E.elements.indexOf(l.container),1),l.updatePosition(),M.remove()},l.updatePosition=function(){for(var Y=0;Y<E.elements.length;Y++){var J=E.elements[Y],ie=E.elements[Y-1];J.style.right=Y*(ie?ie.offsetWidth:J.offsetWidth)*1.01+"px"}},l.init=function(){ne(),k(),S(),E.elements.push(l.container),l.updatePosition(),M.floating=l},l.init(),l};return E.elements=[],E}var z=at();function Le(){const E=function(k){return!isNaN(k)&&k!==null&&(typeof k!="string"||k.trim()!=="")},M={between:function(k,S){return k>=S[0]&&k<=S[1]},"not between":function(k,S){return k<S[0]||k>S[1]},"<":function(k,S){return k<S[0]},"<=":function(k,S){return k<=S[0]},">":function(k,S){return k>S[0]},">=":function(k,S){return k>=S[0]},"=":function(k,S){return k==S[0]},"!=":function(k,S){return k!=S[0]}},d={"valid date":function(){return!0},"=":function(k,S){return k===S[0]},"!=":function(k,S){return k!==S[0]},"<":function(k,S){return k<S[0]},"<=":function(k,S){return k<=S[0]},">":function(k,S){return k>S[0]},">=":function(k,S){return k>=S[0]},between:function(k,S){return k>=S[0]&&k<=S[1]},"not between":function(k,S){return k<S[0]||k>S[1]}},l={contains:function(k,S){return k.includes(S[0])},"not contains":function(k,S){return!k.includes(S[0])},"begins with":function(k,S){return k.startsWith(S[0])},"ends with":function(k,S){return k.endsWith(S[0])},"=":function(k,S){return k===S[0]},"!=":function(k,S){return k!==S[0]},"valid email":function(k){var S=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return S.test(k)},"valid url":function(k){var S=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return S.test(k)}},_=function(k,S){return typeof _[S.type]=="function"?S.allowBlank&&(typeof k>"u"||k===""||k===null)?!0:_[S.type](k,S):null};_.url=function(k){var S=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!S.test(k)},_.email=function(k){var S=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(k&&S.test(k))},_.required=function(k){return!!(k&&k.trim())},_.empty=function(k){return typeof k>"u"||k===null||typeof k=="string"&&!k.toString().trim()},_["not exist"]=_.empty,_.notEmpty=function(k){return!_.empty(k)},_.exist=_.notEmpty,_.number=function(k,S){if(!E(k))return!1;if(!S||!S.criteria)return!0;if(!M[S.criteria])return!1;let Y=S.value.map(function(J){return parseFloat(J)});return M[S.criteria](k,Y)},_.login=function(k){let S=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(k&&S.test(k))},_.list=function(k,S){let Y=typeof k;if(Y!=="string"&&Y!=="number")return!1;let J;return typeof S.value[0]=="string"?J=S.value[0].split(","):J=S.value[0],Array.isArray(J)?J.findIndex(function(xe){return xe==k})>-1:!1};const G=function(){let k=new Date;return k.setHours(0,0,0,0),k},ne={"one year ago":function(){let k=G();return k.setFullYear(k.getFullYear()-1),k},"one month ago":function(){let k=G();return k.setMonth(k.getMonth()-1),k},"one week ago":function(){let k=G();return k.setDate(k.getDate()-7),k},yesterday:function(){let k=G();return k.setDate(k.getDate()-1),k},today:G,tomorrow:function(){let k=G();return k.setDate(k.getDate()+1),k}};return _.date=function(k,S){if(E(k)&&k>0&&k<1e6&&(k=g.numToDate(k)),new Date(k)=="Invalid Date")return!1;if(!S||!S.criteria)return!0;if(!d[S.criteria])return!1;let Y=S.value.map(function(J){return typeof J=="string"&&ne[J]?ne[J]().getTime():new Date(J).getTime()});return d[S.criteria](new Date(k).getTime(),Y)},_.text=function(k,S){if(typeof k>"u"||k===null)k="";else if(typeof k!="string")return!1;return!S||!S.criteria?!0:l[S.criteria]?l[S.criteria](k,S.value):!1},_.textLength=function(k,S){return k=k.toString(),_.number(k.length,S)},_}var Qe=Le();function ft(){var E=function(M,d){var l={};l.options={};var _={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(S,Y){alert(Y)}};for(var G in _)d&&d.hasOwnProperty(G)?l.options[G]=d[G]:l.options[G]=_[G];l.options.validations||(l.options.validations={}),l.options.submitButton||(l.options.submitButton=M.querySelector("input[type=submit]")),l.options.submitButton&&l.options.url&&(l.options.submitButton.onclick=function(){l.save()}),l.options.validations.email||(l.options.validations.email=Qe.email),l.options.validations.length||(l.options.validations.length=Qe.length),l.options.validations.required||(l.options.validations.required=Qe.required),l.setUrl=function(S){l.options.url=S},l.load=function(){O({url:l.options.url,method:"GET",dataType:"json",queue:!0,success:function(S){if(typeof l.options.onbeforeload=="function"){var Y=l.options.onbeforeload(M,S);Y&&(S=Y)}E.setElements(M,S),typeof l.options.onload=="function"&&l.options.onload(M,S)}})},l.save=function(){var S=l.validate();if(S)l.options.onerror(M,S);else{var Y=E.getElements(M,!0);if(typeof l.options.onbeforesave=="function"){var Y=l.options.onbeforesave(M,Y);if(Y===!1)return}O({url:l.options.url,method:"POST",dataType:"json",data:Y,success:function(J){typeof l.options.onsave=="function"&&l.options.onsave(M,Y,J)}})}},l.remove=function(){if(typeof l.options.onbeforeremove=="function"){var S=l.options.onbeforeremove(M,l);if(S===!1)return!1}O({url:l.options.url,method:"DELETE",dataType:"json",success:function(Y){typeof l.options.onremove=="function"&&l.options.onremove(M,l,Y),l.reset()}})};var ne=function(S){S.classList.add("error"),l.options.submitButton&&l.options.submitButton.setAttribute("disabled",!0);var Y=S.getAttribute("data-error")||"There is an error in the form";return S.setAttribute("title",Y),Y},k=function(S){var Y=!1;S.classList.remove("error"),S.removeAttribute("title");for(var J=M.querySelectorAll("input, select, textarea, div[name]"),ie=0;ie<J.length;ie++)J[ie].getAttribute("data-validation")&&J[ie].classList.contains("error")&&(Y=!0);l.options.submitButton&&(Y?l.options.submitButton.setAttribute("disabled",!0):l.options.submitButton.removeAttribute("disabled"))};return l.validateElement=function(S){var Y=!1,J=E.getValue(S),ie=S.getAttribute("data-validation");return typeof l.options.validations[ie]=="function"&&!l.options.validations[ie](J,S)?Y=ne(S):S.classList.contains("error")&&k(S),Y},l.reset=function(){for(var S=M.querySelectorAll("input, select, textarea, div[name]"),Y=0;Y<S.length;Y++)S[Y].getAttribute("name")&&(S[Y].type=="checkbox"||S[Y].type=="radio"?S[Y].checked=!1:typeof S[Y].val=="function"?S[Y].val(""):S[Y].value="")},l.validate=function(){for(var S=[],Y=M.querySelectorAll("input, select, textarea, div[name]"),J=0;J<Y.length;J++)if(Y[J].getAttribute("data-validation")){var ie=l.validateElement(Y[J]);ie&&S.push(ie)}return S.length>0?S.join("<br>"):!1},l.getError=function(){return!!l.validation()},l.setHash=function(){return l.getHash(E.getElements(M))},l.getHash=function(S){var Y=0,J,ie;if(S.length===0)return Y;for(J=0;J<S.length;J++)ie=S.charCodeAt(J),Y=(Y<<5)-Y+ie,Y|=0;return Y},l.isChanged=function(){var S=l.setHash();return l.options.currentHash!=S},l.resetTracker=function(){l.options.currentHash=l.setHash(),l.options.ignore=!1},l.setIgnore=function(S){l.options.ignore=!!S},setTimeout(function(){l.options.currentHash=l.setHash()},1e3),M.addEventListener("keyup",function(S){S.target.getAttribute("data-validation")&&l.validateElement(S.target)}),E.hasEvents||(window.addEventListener("beforeunload",function(S){if(l.isChanged()&&l.options.ignore==!1){var Y=l.options.message?l.options.message:"o/";return Y?(typeof S>"u"&&(S=window.event),S&&(S.returnValue=Y),Y):void 0}}),E.hasEvents=!0),M.form=l,l};return E.getValue=function(M){var d=null;if(M.type=="checkbox")M.checked==!0&&(d=M.value||!0);else if(M.type=="radio")M.checked==!0&&(d=M.value);else if(M.type=="file")d=M.files;else if(M.tagName=="select"&&M.multiple==!0){d=[];for(var l=M.querySelectorAll("options[selected]"),_=0;_<l.length;_++)d.push(l[_].value)}else typeof M.val=="function"?d=M.val():d=M.value||"";return d},E.getElements=function(M,d){for(var l={},_=null,G=M.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<G.length;ne++)(_=G[ne].getAttribute("name"))&&(l[_]=E.getValue(G[ne])||"");return d==!0?l:JSON.stringify(l)},E.setElements=function(M,d){for(var l=null,_=null,G=M.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<G.length;ne++){var k=G[ne].getAttribute("type");if(l=G[ne].getAttribute("name")){if(l=l.replace(new RegExp(/\[(.*?)\]/ig),".$1"),_=null,l.match(/\./)){var S=j.call(d,l)||"";typeof S<"u"&&(_=S)}else typeof d[l]<"u"&&(_=d[l]);_!==null&&(k=="checkbox"||k=="radio"?G[ne].checked=!!_:k=="file"||(typeof G[ne].val=="function"?G[ne].val(_):G[ne].value=_))}}},E}var Ie=ft();function Oe(){var E=function(){var d=null,l=function(k){if(k.which==27)for(var S=document.querySelectorAll(".jmodal"),Y=0;Y<S.length;Y++)S[Y].parentNode.modal.close()},_=function(k){let S=k.composedPath();var Y=c.findElement(S[0],"jmodal");if(Y){var J=Y.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var ie=k.changedTouches[0].clientX,xe=k.changedTouches[0].clientY;else var ie=k.clientX,xe=k.clientY;J.width-(ie-J.left)<50&&xe-J.top<50&&Y.parentNode.modal.close()}d&&(d.element.style.cursor="auto",d=null)},G=function(k){let S=k.composedPath();var Y=c.findElement(S[0],"jmodal");if(Y){var J=Y.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var ie=k.changedTouches[0].clientX,xe=k.changedTouches[0].clientY;else var ie=k.clientX,xe=k.clientY;J.width-(ie-J.left)<50&&xe-J.top<50||xe-J.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),d={left:J.left,top:J.top,x:k.clientX,y:k.clientY,width:J.width,height:J.height,element:Y})}},ne=function(k){if(d){if(k=k||window.event,k.buttons)var S=k.buttons;else if(k.button)var S=k.button;else var S=k.which;S?(d.element.style.top=d.top+(k.clientY-d.y)+d.height/2+"px",d.element.style.left=d.left+(k.clientX-d.x)+d.width/2+"px",d.element.style.cursor="move"):d.element.style.cursor="auto"}};document.addEventListener("keydown",l),document.addEventListener("mouseup",_),document.addEventListener("mousedown",G),document.addEventListener("mousemove",ne)},M=function(d,l){var _={};_.options={};var G={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ne in G)l&&l.hasOwnProperty(ne)?_.options[ne]=l[ne]:_.options[ne]=G[ne];!_.options.title&&d.getAttribute("title")&&(_.options.title=d.getAttribute("title"));for(var k=document.createElement("div");d.children[0];)k.appendChild(d.children[0]);for(_.title=document.createElement("div"),_.title.className="jmodal_title",_.options.icon&&_.title.setAttribute("data-icon",_.options.icon),_.content=document.createElement("div"),_.content.className="jmodal_content",_.content.innerHTML=d.innerHTML;k.children[0];)_.content.appendChild(k.children[0]);if(_.container=document.createElement("div"),_.container.className="jmodal",_.container.appendChild(_.title),_.container.appendChild(_.content),_.options.padding&&(_.content.style.padding=_.options.padding),_.options.width&&(_.container.style.width=_.options.width),_.options.height&&(_.container.style.height=_.options.height),_.options.title){var S=document.createElement("h4");S.innerText=_.options.title,_.title.appendChild(S)}if(d.innerHTML="",d.style.display="none",d.appendChild(_.container),_.options.backdrop){var Y=document.createElement("div");Y.className="jmodal_backdrop",Y.onclick=function(){_.close()},d.appendChild(Y)}return _.open=function(){d.style.display="block";var J=_.container.getBoundingClientRect();c.getWindowWidth()<J.width?(_.container.style.top="",_.container.style.left="",_.container.classList.add("jmodal_fullscreen"),U.slideBottom(_.container,1)):_.options.backdrop&&(Y.style.display="block"),typeof _.options.onopen=="function"&&_.options.onopen(d,_)},_.resetPosition=function(){_.container.style.top="",_.container.style.left=""},_.isOpen=function(){return d.style.display!="none"},_.close=function(){_.isOpen()&&(d.style.display="none",_.options.backdrop&&(Y.style.display=""),_.container.classList.remove("jmodal_fullscreen"),typeof _.options.onclose=="function"&&_.options.onclose(d,_))},_.options.url?O({url:_.options.url,method:"GET",dataType:"text/html",success:function(J){_.content.innerHTML=J,_.options.closed||_.open(),typeof _.options.onload=="function"&&_.options.onload(_)}}):(_.options.closed||_.open(),typeof _.options.onload=="function"&&_.options.onload(_)),d.modal=_,E(),E=function(){},_};return M}var Ye=Oe();function Fe(){var E=function(M){var d={};d.options={};var l={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var _ in l)M&&M.hasOwnProperty(_)?d.options[_]=M[_]:d.options[_]=l[_];var G=document.createElement("div");G.className="jnotification",d.options.error&&G.classList.add("jnotification-error");var ne=document.createElement("div");ne.className="jnotification-container",G.appendChild(ne);var k=document.createElement("div");k.className="jnotification-header",ne.appendChild(k);var S=document.createElement("div");if(S.className="jnotification-image",k.appendChild(S),d.options.icon){var Y=document.createElement("img");Y.src=d.options.icon,S.appendChild(Y)}var J=document.createElement("div");if(J.className="jnotification-name",J.innerHTML=d.options.name,k.appendChild(J),d.options.closeable==!0){var ie=document.createElement("div");ie.className="jnotification-close",ie.onclick=function(){d.hide()},k.appendChild(ie)}var xe=document.createElement("div");xe.className="jnotification-date",k.appendChild(xe);var ge=document.createElement("div");if(ge.className="jnotification-content",ne.appendChild(ge),d.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=d.options.title,ge.appendChild(fe)}var Re=document.createElement("div");if(Re.className="jnotification-message",Re.innerHTML=d.options.message,ge.appendChild(Re),d.show=function(){document.body.appendChild(G),c.getWindowWidth()>800?U.fadeIn(G):U.slideTop(G,1)},d.hide=function(){c.getWindowWidth()>800?U.fadeOut(G,function(){G.parentNode&&(G.parentNode.removeChild(G),We&&clearTimeout(We))}):U.slideTop(G,0,function(){G.parentNode&&(G.parentNode.removeChild(G),We&&clearTimeout(We))})},d.show(),d.options.autoHide==!0)var We=setTimeout(function(){d.hide()},d.options.timeout);return c.getWindowWidth()<800&&G.addEventListener("swipeup",function(Je){d.hide(),Je.preventDefault(),Je.stopPropagation()}),d};return E.isVisible=function(){var M=document.querySelector(".jnotification");return!!(M&&M.parentNode)},E}var Ke=Fe();function tt(E,M){var d={};d.options={};var l={value:0,onchange:null,width:null};for(var _ in l)M&&M.hasOwnProperty(_)?d.options[_]=M[_]:d.options[_]=l[_];E.classList.add("jprogressbar"),E.setAttribute("tabindex",1),E.setAttribute("data-value",d.options.value);var G=document.createElement("div");G.style.width=d.options.value+"%",G.style.color="#fff",E.appendChild(G),d.options.width&&(E.style.width=d.options.width),d.setValue=function(k){k=parseInt(k),d.options.value=k,G.style.width=k+"%",E.setAttribute("data-value",k+"%"),k<6?E.style.color="#000":E.style.color="#fff",d.options.value=k,typeof d.options.onchange=="function"&&d.options.onchange(E,k),E.value!=d.options.value&&(E.value=d.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},d.getValue=function(){return d.options.value};var ne=function(k){if(k.which){var S=E.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0]){var Y=k.changedTouches[0].clientX;k.changedTouches[0].clientY}else{var Y=k.clientX;k.clientY}d.setValue(Math.round((Y-S.left)/S.width*100))}};return"touchstart"in document.documentElement?(E.addEventListener("touchstart",ne),E.addEventListener("touchend",ne)):(E.addEventListener("mousedown",ne),E.addEventListener("mousemove",ne)),E.change=d.setValue,E.val=function(k){if(k===void 0)return d.getValue();d.setValue(k)},E.progressbar=d,d}function ct(E,M){if(E.rating)return E.rating.setOptions(M,!0);var d={};d.options={},d.setOptions=function(_,G){var ne={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var k in ne)_&&_.hasOwnProperty(k)?d.options[k]=_[k]:(typeof d.options[k]>"u"||G===!0)&&(d.options[k]=ne[k]);E.innerHTML="";for(var S=0;S<d.options.number;S++){var Y=document.createElement("div");Y.setAttribute("data-index",S+1),Y.setAttribute("title",d.options.tooltip[S]),E.appendChild(Y)}if(d.options.value)for(var S=0;S<d.options.number;S++)S<d.options.value&&E.children[S].classList.add("jrating-selected");return d},d.setValue=function(_){for(var G=0;G<d.options.number;G++)G<_?E.children[G].classList.add("jrating-selected"):(E.children[G].classList.remove("jrating-over"),E.children[G].classList.remove("jrating-selected"));d.options.value=_,typeof d.options.onchange=="function"&&d.options.onchange(E,_),E.value!=d.options.value&&(E.value=d.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},d.getValue=function(){return d.options.value};var l=function(){d.setOptions(M),E.classList.add("jrating"),E.addEventListener("click",function(_){var G=_.target.getAttribute("data-index");G!=null&&(G==d.options.value?d.setValue(0):d.setValue(G))}),E.addEventListener("mouseover",function(_){for(var G=_.target.getAttribute("data-index"),ne=0;ne<d.options.number;ne++)ne<G?E.children[ne].classList.add("jrating-over"):E.children[ne].classList.remove("jrating-over")}),E.addEventListener("mouseout",function(_){for(var G=0;G<d.options.number;G++)E.children[G].classList.remove("jrating-over")}),E.change=d.setValue,E.val=function(_){if(_===void 0)return d.getValue();d.setValue(_)},E.rating=d};return l(),d}function te(E,M){if(E.search)return E.search;var d=null,l=function(Y){if(Y.target.classList.contains("jsearch_item"))var J=Y.target;else var J=Y.target.parentNode;k.selectIndex(J),Y.preventDefault()},_=function(Y){if(typeof k.options.onsearch=="function"){var J=k.options.onsearch(k,Y);J&&(Y=J)}if(S.innerHTML="",!Y.length)E.style.display="";else{E.style.display="block";for(var ie=Y.length<11?Y.length:10,xe=0;xe<ie;xe++){if(typeof Y[xe]=="string")var ge=Y[xe],fe=Y[xe];else{var ge=Y[xe].text;!ge&&Y[xe].name&&(ge=Y[xe].name);var fe=Y[xe].value;!fe&&Y[xe].id&&(fe=Y[xe].id)}var Re=document.createElement("div");Re.setAttribute("data-value",fe),Re.setAttribute("data-text",ge),Re.className="jsearch_item",Y[xe].id&&Re.setAttribute("id",Y[xe].id),k.options.forceSelect&&xe==0&&Re.classList.add("selected");var We=document.createElement("img");Y[xe].image?We.src=Y[xe].image:We.style.display="none",Re.appendChild(We);var Je=document.createElement("div");Je.innerHTML=ge,Re.appendChild(Je),S.appendChild(Re)}}},G=function(Y){if(Y!=k.terms)if(k.terms=Y,k.options.forceSelect?d=0:d=null,Array.isArray(k.options.data)){var J=function(xe){if(typeof xe=="string"){if((""+xe).toLowerCase().search(Y.toLowerCase())>=0)return!0}else for(var ge in xe){var fe=xe[ge];if((""+fe).toLowerCase().search(Y.toLowerCase())>=0)return!0}return!1},ie=k.options.data.filter(function(xe){return J(xe)});_(ie)}else O({url:k.options.data+Y,method:"GET",dataType:"json",success:function(xe){_(xe)}})},ne=null,k=function(Y){ne&&clearTimeout(ne),ne=setTimeout(function(){G(Y)},500)};M.forceSelect===null&&(M.forceSelect=!0),k.options={data:M.data||null,input:M.input||null,searchByNode:M.searchByNode||null,onselect:M.onselect||null,forceSelect:M.forceSelect,onsearch:M.onsearch||null,onbeforesearch:M.onbeforesearch||null},k.selectIndex=function(Y){var J=Y.getAttribute("id"),ie=Y.getAttribute("data-text"),xe=Y.getAttribute("data-value"),ge=Y.children[0].src||"";typeof k.options.onselect=="function"&&k.options.onselect(k,ie,xe,J,ge),k.close()},k.open=function(){E.style.display="block"},k.close=function(){ne&&clearTimeout(ne),k.terms="",S.innerHTML="",E.style.display=""},k.isOpened=function(){return!!E.style.display},k.keydown=function(Y){k.isOpened()&&(Y.key=="Enter"?d!==null&&S.children[d]?(k.selectIndex(S.children[d]),Y.preventDefault()):k.close():Y.key==="ArrowUp"?(d!==null&&S.children[0]&&(S.children[d].classList.remove("selected"),!k.options.forceSelect&&d===0?d=null:(d=Math.max(0,d-1),S.children[d].classList.add("selected"))),Y.preventDefault()):Y.key==="ArrowDown"&&(d==null?d=-1:S.children[d].classList.remove("selected"),d<9&&S.children[d+1]&&d++,S.children[d].classList.add("selected"),Y.preventDefault()))},k.keyup=function(Y){if(!k.options.searchByNode&&k.options.input)if(k.options.input.tagName==="DIV")var J=k.options.input.innerText;else var J=k.options.input.value;else{var ie=c.getNode();if(ie)var J=ie.innerText}if(typeof k.options.onbeforesearch=="function"){var xe=k.options.onbeforesearch(k,J);if(xe)J=xe;else if(xe===!1)return}k(J)},k.blur=function(Y){k.close()},k.options.input&&(k.options.input.addEventListener("keyup",k.keyup),k.options.input.addEventListener("keydown",k.keydown),k.options.input.addEventListener("blur",k.blur));var S=document.createElement("div");return S.classList.add("jsearch_container"),S.onmousedown=l,E.appendChild(S),E.classList.add("jsearch"),E.search=k,k}function ce(E,M){var d={};if(d.options={},d.currentImage=null,M&&(d.options=M),E.setAttribute("tabindex","900"),d.options.items=[],!E.classList.contains("jslider")){if(E.classList.add("jslider"),E.classList.add("unselectable"),d.options.height&&(E.style.minHeight=parseInt(d.options.height)+"px"),d.options.width&&(E.style.width=parseInt(d.options.width)+"px"),d.options.grid){E.classList.add("jslider-grid");var l=E.children.length;l>4&&E.setAttribute("data-total",l-4),E.setAttribute("data-number",l>4?4:l)}var _=document.createElement("div");if(_.classList.add("jslider-counter"),E.children.length>0)for(var G=0;G<E.children.length;G++){d.options.items.push(E.children[G]);var ne=document.createElement("div");ne.onclick=function(){var ie=Array.prototype.slice.call(_.children).indexOf(this);d.show(d.currentImage=d.options.items[ie])},_.appendChild(ne)}var k=document.createElement("div");k.className="jslider-caption";var S=document.createElement("div"),Y=document.createElement("div");Y.className="jslider-close",Y.innerHTML="",Y.onclick=function(){d.close()},S.appendChild(k),S.appendChild(Y)}d.updateCounter=function(ie){for(var xe=0;xe<_.children.length;xe++)if(_.children[xe].classList.contains("jslider-counter-focus")){_.children[xe].classList.remove("jslider-counter-focus");break}_.children[ie].classList.add("jslider-counter-focus")},d.show=function(ie){if(!ie)var ie=E.children[0];E.classList.add("jslider-focus"),E.classList.remove("jslider-grid"),E.appendChild(S),E.appendChild(_);var xe=d.options.items.indexOf(ie);d.updateCounter(xe);for(var ge=0;ge<E.children.length;ge++)E.children[ge].style.display="";ie.style.display="block",ie.previousElementSibling?E.classList.add("jslider-left"):E.classList.remove("jslider-left"),ie.nextElementSibling&&ie.nextElementSibling.tagName=="IMG"?E.classList.add("jslider-right"):E.classList.remove("jslider-right"),d.currentImage=ie,d.currentImage.offsetHeight>d.currentImage.offsetWidth&&d.currentImage.classList.add("jslider-vertical"),S.children[0].innerText=d.currentImage.getAttribute("title")},d.open=function(){d.show(),typeof d.options.onopen=="function"&&d.options.onopen(E)},d.close=function(){E.classList.remove("jslider-focus"),E.classList.remove("jslider-left"),E.classList.remove("jslider-right"),d.options.grid&&E.classList.add("jslider-grid");for(var ie=0;ie<E.children.length;ie++)E.children[ie].style.display="";_.remove(),S.remove(),d.currentImage=null,typeof d.options.onclose=="function"&&d.options.onclose(E)},d.reset=function(){E.innerHTML=""},d.next=function(){var ie=d.currentImage.nextElementSibling;ie&&ie.tagName==="IMG"&&d.show(d.currentImage.nextElementSibling)},d.prev=function(){d.currentImage.previousElementSibling&&d.show(d.currentImage.previousElementSibling)};var J=function(ie){if(ie.target.tagName=="IMG")d.show(ie.target);else if(!ie.target.classList.contains("jslider-close")&&!(ie.target.parentNode.classList.contains("jslider-counter")||ie.target.classList.contains("jslider-counter"))){var xe=ie.offsetX||ie.changedTouches[0].clientX;ie.target.clientWidth-xe<40?d.next():xe<40&&d.prev()}};return"ontouchend"in document.documentElement?E.addEventListener("touchend",J):E.addEventListener("mouseup",J),E.addEventListener("swipeleft",function(ie){d.next(),ie.preventDefault(),ie.stopPropagation()}),E.addEventListener("swiperight",function(ie){d.prev(),ie.preventDefault(),ie.stopPropagation()}),E.addEventListener("keydown",function(ie){ie.which==27&&d.close()}),E.slider=d,d}function ve(E,M){if(E.tags)return E.tags.setOptions(M,!0);var d={type:"tags"};d.options={};var l=function(){return!!(d.options.limit&&E.children.length>=d.options.limit)},_=null,G=null;d.setOptions=function(pe,He){var Z={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var K in Z)pe&&pe.hasOwnProperty(K)?d.options[K]=pe[K]:(typeof d.options[K]>"u"||He===!0)&&(d.options[K]=Z[K]);return d.options.placeholder?E.setAttribute("data-placeholder",d.options.placeholder):E.removeAttribute("data-placeholder"),E.placeholder=d.options.placeholder,d.setValue(d.options.value),Y(),d.options.search?G||(G=document.createElement("div"),E.parentNode.insertBefore(G,E.nextSibling),_=te(G,{data:d.options.search,onselect:function(ae,A,W){d.selectIndex(A,W)}})):G&&(_=null,G.remove(),G=null),d},d.add=function(pe,He){if(typeof d.options.onbeforechange=="function"){var Z=d.options.onbeforechange(E,d,d.options.value,pe);if(Z===!1)return!1;Z!=null&&(pe=Z)}if(_&&_.close(),l())typeof d.options.onlimit=="function"?d.options.onlimit(d,d.options.limit):alert(m.translate("You reach the limit number of entries")+" "+d.options.limit);else{var K=c.getNode();if(K&&K.parentNode&&K.parentNode.classList.contains("jtags")&&K.nextSibling&&!(K.nextSibling.innerText&&K.nextSibling.innerText.trim()))ae=K.nextSibling;else{if(E.lastChild&&(E.lastChild.innerText.trim()||E.removeChild(E.lastChild)),!pe||typeof pe=="string")var ae=k(pe,pe,K);else for(var A=0;A<=pe.length;A++)if(!l()){if(!pe[A]||typeof pe[A]=="string")var W=pe[A]||"",ee=null;else var W=pe[A].text,ee=pe[A].value;var ae=k(W,ee)}S()}He&&ne(ae)}},d.setLimit=function(pe){for(d.options.limit=pe,E.children.length-pe;E.children.length>pe;)E.removeChild(E.lastChild)},d.remove=function(pe){pe.parentNode.removeChild(pe),E.children.length?S():d.add("",!0)},d.getData=function(){for(var pe=[],He=0;He<E.children.length;He++){var Z=E.children[He].innerText.replace(`
`,""),K=E.children[He].getAttribute("data-value");K||(K=Z),(Z||K)&&pe.push({text:Z,value:K})}return pe},d.getValue=function(pe){var He=null;if(pe!=null)He=E.children[pe].getAttribute("data-value"),He||(He=E.children[pe].innerText.replace(`
`,""));else{for(var Z=[],K=0;K<E.children.length;K++)He=E.children[K].innerText.replace(`
`,""),He&&Z.push(d.getValue(K));He=Z.join(",")}return He},d.setValue=function(pe){if(!pe)d.reset();else if(E.value!=pe)if(Array.isArray(pe))d.add(pe);else{var He=(""+pe).trim(),Z=ie(He);E.innerHTML="",d.add(Z)}},d.reset=function(){E.classList.add("jtags-empty"),E.innerHTML="<div></div>",S()},d.isValid=function(){for(var pe=0,He=0;He<E.children.length;He++)E.children[He].classList.contains("jtags_error")&&pe++;return pe==0},d.selectIndex=function(pe,He){var Z=c.getNode();Z&&(Z.innerText=pe,He&&Z.setAttribute("data-value",He),Z.classList.remove("jtags_error"),l()||d.add("",!0))},d.search=function(pe){pe.innerText},d.destroy=function(){E.removeEventListener("mouseup",We),E.removeEventListener("keydown",ge),E.removeEventListener("keyup",fe),E.removeEventListener("paste",Re),E.removeEventListener("focus",Je),E.removeEventListener("blur",Me),E.parentNode.removeChild(E)};var ne=function(pe){if(E.children.length){var He=document.createRange(),Z=window.getSelection();if(!pe)var pe=E.childNodes[E.childNodes.length-1];He.setStart(pe,pe.length),He.collapse(!0),Z.removeAllRanges(),Z.addRange(He),E.scrollLeft=E.scrollWidth}},k=function(pe,He,Z){var K=document.createElement("div");return K.innerHTML=pe||"",He&&K.setAttribute("data-value",He),Z&&Z.parentNode.classList.contains("jtags")?E.insertBefore(K,Z.nextSibling):E.appendChild(K),K},S=function(){var pe=d.getValue();pe!=d.options.value&&(d.options.value=pe,typeof d.options.onchange=="function"&&d.options.onchange(E,d,d.options.value),E.value!=d.options.value&&(E.value=d.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))),Y()},Y=function(){for(var pe=0;pe<E.children.length;pe++)E.children[pe].tagName==="DIV"&&(d.getValue(pe)?(E.children[pe].classList.add("jtags_label"),typeof d.options.validation=="function"&&d.getValue(pe)?d.options.validation(E.children[pe],E.children[pe].innerText,E.children[pe].getAttribute("data-value"))?E.children[pe].classList.remove("jtags_error"):E.children[pe].classList.add("jtags_error"):E.children[pe].classList.remove("jtags_error")):E.children[pe].classList.remove("jtags_label"));J()},J=function(){E.innerText.trim()?E.classList.remove("jtags-empty"):(!E.children.length||E.children[0].tagName==="BR")&&(E.innerHTML="",ne(k()))},ie=function(pe){var He=[],Z="";if(pe=pe.trim(),pe){for(var K=0;K<pe.length;K++)pe[K]==","||pe[K]==";"||pe[K]==`
`?Z&&(He.push(Z.trim()),Z=""):Z+=pe[K];Z&&He.push(Z)}return He},xe=0,ge=function(pe){if(xe=window.getSelection().anchorOffset,J(),pe.key==="Tab"||pe.key===";"||pe.key===","){var He=window.getSelection().anchorOffset;He>1&&(l()?typeof d.options.onlimit=="function"&&d.options.onlimit(d,d.options.limit):d.add("",!0)),pe.preventDefault()}else if(pe.key=="Enter"){if(!_||!_.isOpened()){var He=window.getSelection().anchorOffset;He>1&&(l()||d.add("",!0)),pe.preventDefault()}}else pe.key=="Backspace"&&E.children.length==1&&window.getSelection().anchorOffset<1&&pe.preventDefault();_&&_.keydown(pe),J()},fe=function(pe){if(pe.which==39){var He=window.getSelection().anchorOffset;He>1&&He==xe&&d.add("",!0)}else pe.which==13||pe.which==38||pe.which==40?pe.preventDefault():_&&_.keyup(pe);Y()},Re=function(pe){if(pe.clipboardData||pe.originalEvent.clipboardData)var He=(pe.originalEvent||pe).clipboardData.getData("text/plain");else if(window.clipboardData)var He=window.clipboardData.getData("Text");var Z=ie(He);if(typeof d.options.onbeforepaste=="function"){var K=d.options.onbeforepaste(E,d,Z);if(K===!1)return pe.preventDefault(),!1;K&&(Z=K)}Z.length>1?(d.add(Z,!0),pe.preventDefault()):Z[0]&&(document.execCommand("insertText",!1,Z[0]),pe.preventDefault())},We=function(pe){if(pe.target.parentNode&&pe.target.parentNode.classList.contains("jtags")&&(pe.target.classList.contains("jtags_label")||pe.target.classList.contains("jtags_error"))){var He=pe.target.getBoundingClientRect();He.width-(pe.clientX-He.left)<16&&d.remove(pe.target)}pe.target==E&&ne()},Je=function(){E.classList.contains("jtags-focus")||((!E.children.length||d.getValue(E.children.length-1))&&(l()||k("")),typeof d.options.onfocus=="function"&&d.options.onfocus(E,d,d.getValue()),E.classList.add("jtags-focus"))},Me=function(){if(E.classList.contains("jtags-focus")){_&&_.close();for(var pe=0;pe<E.children.length-1;pe++)d.getValue(pe)||E.removeChild(E.children[pe]);S(),E.classList.remove("jtags-focus"),typeof d.options.onblur=="function"&&d.options.onblur(E,d,d.getValue())}},ze=function(){"touchend"in document.documentElement?E.addEventListener("touchend",We):E.addEventListener("mouseup",We),E.addEventListener("keydown",ge),E.addEventListener("keyup",fe),E.addEventListener("paste",Re),E.addEventListener("focus",Je),E.addEventListener("blur",Me),E.setAttribute("contenteditable",!0),E.classList.add("jtags"),d.setOptions(M),typeof d.options.onload=="function"&&d.options.onload(E,d),E.change=d.setValue,E.val=function(pe){if(pe===void 0)return d.getValue();d.setValue(pe)},E.tags=d};return ze(),d}function Ce(E,M){var d={};d.options={};var l={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var _ in l)M&&M.hasOwnProperty(_)?d.options[_]=M[_]:d.options[_]=l[_];d.options.multiple==!0&&E.setAttribute("data-multiple",!0),E.content=[],E.classList.add("jupload"),d.options.input==!0&&E.classList.add("input"),d.add=function(S){if(d.options.multiple==!1&&(E.content=[],E.innerText=""),d.options.type=="image"){var Y=document.createElement("img");Y.setAttribute("src",S.file),Y.setAttribute("tabindex",-1),E.getAttribute("name")||(Y.className="jfile",Y.content=S),E.appendChild(Y)}else{if(S.name)var J=S.name;else var J=S.file;var ie=document.createElement("div");ie.innerText=J||d.options.type,ie.classList.add("jupload-item"),ie.setAttribute("tabindex",-1),E.appendChild(ie)}S.content&&(S.file=c.guid()),E.content.push(S),typeof d.options.onchange=="function"&&d.options.onchange(E,S)},d.addFromFile=function(S){var Y=S.type.split("/");if(Y[0]==d.options.type){var J=new FileReader;J.addEventListener("load",function(ie){var xe={file:ie.srcElement.result,extension:S.name.substr(S.name.lastIndexOf(".")+1),name:S.name,size:S.size,lastmodified:S.lastModified,content:ie.srcElement.result};d.add(xe)}),J.readAsDataURL(S)}else alert(m.translate("This extension is not allowed"))},d.addFromUrl=function(S){if(S.substr(0,4)!="data"&&!d.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(S.substr(0,4)=="data"){var Y=S.split(";");Y=Y[0].split("/");var J=Y[0].replace("data:","");if(J==d.options.type){var ie={file:S,name:"",extension:Y[1],content:S};d.add(ie)}else alert(d.options.text.extensionNotAllowed)}else{var Y=S.substr(S.lastIndexOf(".")+1);S=d.options.remoteParser+S,O({url:S,type:"GET",dataType:"blob",success:function(ge){}})}};var G=d.options.type+"/"+d.options.extension,ne=document.createElement("input");ne.type="file",ne.setAttribute("accept",G),ne.onchange=function(){for(var S=0;S<this.files.length;S++)d.addFromFile(this.files[S])},d.options.multiple==!0&&ne.setAttribute("multiple",!0);var k=null;return E.addEventListener("click",function(S){k=null,!E.children.length||S.target===E?c.click(ne):S.target.parentNode==E&&(k=S.target)}),E.addEventListener("dblclick",function(S){c.click(ne)}),E.addEventListener("dragenter",function(S){E.style.border="1px dashed #000"}),E.addEventListener("dragleave",function(S){E.style.border="1px solid #eee"}),E.addEventListener("dragstop",function(S){E.style.border="1px solid #eee"}),E.addEventListener("dragover",function(S){S.preventDefault()}),E.addEventListener("keydown",function(S){if(k&&S.which==46){var Y=Array.prototype.indexOf.call(E.children,k);Y>=0&&(E.content.splice(Y,1),k.remove(),k=null)}}),E.addEventListener("drop",function(S){S.preventDefault(),S.stopPropagation();var Y=(S.originalEvent||S).dataTransfer.getData("text/html"),J=(S.originalEvent||S).dataTransfer.files;if(J.length)for(var ie=0;ie<S.dataTransfer.files.length;ie++)d.addFromFile(S.dataTransfer.files[ie]);else if(Y){d.options.multiple==!1&&(E.innerText="");var xe=document.createElement("div");xe.innerHTML=Y;var ge=xe.querySelectorAll("img");if(ge.length)for(var ie=0;ie<ge.length;ie++)d.addFromUrl(ge[ie].src)}return E.style.border="1px solid #eee",!1}),E.val=function(S){if(S===void 0)return E.content&&E.content.length?E.content:null;if(E.innerText="",E.content=[],S)if(Array.isArray(S))for(var Y=0;Y<S.length;Y++)typeof S[Y]=="string"?d.add({file:S[Y]}):d.add(S[Y]);else typeof S=="string"&&d.add({file:S})},E.upload=E.image=d,d}var Se=h(195),Be=h.n(Se),Pe={...m,...c,version:"5.3.3",setExtensions:function(E){if(typeof E=="object")for(var M=Object.keys(E),d=0;d<M.length;d++)Pe[M[d]]=E[M[d]]},tracking:f,path:j,sorting:C,lazyLoading:b,ajax:O,animation:U,calendar:V,color:oe,contextmenu:Ee,dropdown:se,editor:Xe,floating:z,form:Ie,mask:I,modal:Ye,notification:Ke,palette:Q,picker:we,progressbar:tt,rating:ct,search:te,slider:ce,tabs:de,tags:ve,toolbar:qe,upload:Ce,validations:Qe};Pe.image=Ce,Pe.image.create=function(E){var M=document.createElement("img");return M.setAttribute("src",E.file),M.className="jfile",M.setAttribute("tabindex",-1),M.content=E,M},Pe.tracker=Ie,Pe.loading=U.loading,Pe.sha512=Be();const Ve=function(){document.jsuitesComponents=[];const E=function(Me,ze){return Me[ze.type]&&Me[ze.type]==ze||Me.component&&Me.component==ze?!0:Me.parentNode?E(Me.parentNode,ze):!1},M=function(Me){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var ze=0;ze<document.jsuitesComponents.length;ze++)document.jsuitesComponents[ze]&&!E(Me,document.jsuitesComponents[ze])&&document.jsuitesComponents[ze].close()};let d=15,l=null,_=!1,G={x:null,y:null},ne=document.createElement("div");ne.classList.add("jtooltip");const k=function(Me){if(Me.changedTouches&&Me.changedTouches[0])var ze=Me.changedTouches[0].clientX,pe=Me.changedTouches[0].clientY;else var ze=Me.clientX,pe=Me.clientY;let He=Me.target&&Me.target.tagName==="DIV"&&Me.target.getAttribute("contentEditable"),Z=Pe.findElement(Me.target,"jpanel");if(Z&&!Z.classList.contains("readonly")&&!He){let A=Z.getBoundingClientRect(),W=0;Z.style.rotate&&(W=parseFloat(Z.style.rotate));let ee="move";Me.target.getAttribute("data-action")?ee=Me.target.getAttribute("data-action"):Z.style.cursor?ee="resize":Z.style.cursor="move",_={action:ee,a:W,e:Z,x:ze,y:pe,l:A.left,t:A.top,b:A.bottom,r:A.right,w:A.width,h:A.height,d:Z.style.cursor,actioned:!1},Z.style.width||(Z.style.width=A.width+"px"),Z.style.height||(Z.style.height=A.height+"px")}else _=!1;var K=Me.path||Me.composedPath&&Me.composedPath();if(K)l=K[0];else{if(Me.target&&Me.target.shadowRoot)var ae=Me.target.shadowRoot;else var ae=document;l=ae.elementFromPoint(ze,pe)}M(l)},S=function(Me,ze,pe,He,Z,K){const ae=pe-Me,A=He-ze,W=Z-Me,ee=K-ze;let me=Math.atan2(A,ae),he=Math.atan2(ee,W)-me;return he=he*(180/Math.PI),he<0&&(he+=360),he},Y=function(Me){_&&_.e&&(typeof _.e.refresh=="function"&&G.actioned&&_.e.refresh(),_.e.style.cursor=""),G={x:null,y:null},_=!1},J=function(Me){if(_){let K=Me.clientX||Me.pageX,ae=Me.clientY||Me.pageY;if(G.x==null&&G.y==null&&(G.x=K,G.y=ae),_.action==="move"){var ze=K-G.x,pe=ae-G.y,He=_.e.offsetTop+pe,Z=_.e.offsetLeft+ze;_.e.style.top=He+"px",_.e.style.left=Z+"px",typeof _.e.refresh=="function"&&(G.actioned=!0,_.e.refresh("position",He,Z))}else if(_.action==="rotate"){let A=_.l+_.w/2,W=_.t+_.h/2,ee=S(A,W,_.x,_.y,K,ae);ee=ee+_.a%360,ee=Math.round(ee/2)*2,_.e.style.rotate=`${ee}deg`,typeof _.e.refresh=="function"&&(G.actioned=!0,_.e.refresh("rotate",ee))}else if(_.action==="resize"){let A=null,W=null,ee=null,me=null;_.d=="e-resize"||_.d=="ne-resize"||_.d=="se-resize"?(ee=_.e.offsetWidth+(K-G.x),Me.shiftKey&&(me=_.e.offsetHeight+(K-G.x)*(_.e.offsetHeight/_.e.offsetWidth))):(_.d==="w-resize"||_.d=="nw-resize"||_.d=="sw-resize")&&(W=_.e.offsetLeft+(K-G.x),ee=_.e.offsetLeft+_.e.offsetWidth-W,Me.shiftKey&&(me=_.e.offsetHeight-(K-G.x)*(_.e.offsetHeight/_.e.offsetWidth))),_.d=="s-resize"||_.d=="se-resize"||_.d=="sw-resize"?me||(me=_.e.offsetHeight+(ae-G.y)):(_.d==="n-resize"||_.d=="ne-resize"||_.d=="nw-resize")&&(A=_.e.offsetTop+(ae-G.y),me=_.e.offsetTop+_.e.offsetHeight-A),A&&(_.e.style.top=A+"px"),W&&(_.e.style.left=W+"px"),ee&&(_.e.style.width=ee+"px"),me&&(_.e.style.height=me+"px"),typeof _.e.refresh=="function"&&(G.actioned=!0,_.e.refresh("dimensions",ee,me))}G.x=K,G.y=ae}else{let K=Pe.findElement(Me.target,"jpanel");if(K){if(K.classList.contains("jpanel-controls")){let A=Me.target.getAttribute("data-position");A?K.style.cursor=A:K.style.cursor=""}else if(K.getAttribute("tabindex")){let A=K.getBoundingClientRect();Me.clientY-A.top<d?A.width-(Me.clientX-A.left)<d?K.style.cursor="ne-resize":Me.clientX-A.left<d?K.style.cursor="nw-resize":K.style.cursor="n-resize":A.height-(Me.clientY-A.top)<d?A.width-(Me.clientX-A.left)<d?K.style.cursor="se-resize":Me.clientX-A.left<d?K.style.cursor="sw-resize":K.style.cursor="s-resize":A.width-(Me.clientX-A.left)<d?K.style.cursor="e-resize":Me.clientX-A.left<d?K.style.cursor="w-resize":K.style.cursor=""}}}};let ie=["n","ne","e","se","s","sw","w","nw","rotate"];ie.forEach(function(Me,ze){ie[ze]=document.createElement("div"),ie[ze].classList.add("jpanel-action"),Me==="rotate"?ie[ze].setAttribute("data-action","rotate"):(ie[ze].setAttribute("data-action","resize"),ie[ze].setAttribute("data-position",Me+"-resize"))});const xe=function(Me){let ze=Pe.findElement(Me.target,"jpanel");ze&&!ze.classList.contains("readonly")&&ze.classList.contains("jpanel-controls")&&(ze.append(...ie),ze.classList.contains("jpanel-rotate")||ie[ie.length-1].remove())},ge=function(Me){let ze=Pe.findElement(Me.target,"jpanel");ze&&ze.classList.contains("jpanel-controls")&&ie.forEach(function(pe){pe.remove()})},fe=function(Me){var ze=Me.target.getAttribute("data-tooltip");if(ze){if(ne.innerText=ze,Me.changedTouches&&Me.changedTouches[0])var pe=Me.changedTouches[0].clientX,He=Me.changedTouches[0].clientY;else var pe=Me.clientX,He=Me.clientY;ne.style.top=He+"px",ne.style.left=pe+"px",document.body.appendChild(ne)}else ne.innerText&&(ne.innerText="",document.body.removeChild(ne))},Re=function(Me){var ze=document.activeElement;if(ze&&typeof ze.contextmenu=="function")ze.contextmenu(Me),Me.preventDefault(),Me.stopImmediatePropagation();else if(ze=Pe.findElement(Me.target,function(He){return He.tagName&&He.getAttribute("aria-contextmenu-id")}),ze){var pe=document.querySelector("#"+ze);pe?(pe.contextmenu.open(Me),Me.preventDefault(),Me.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+ze)}},We=function(Me){let ze=document.activeElement;ze&&Me.key==="Delete"&&typeof ze.delete=="function"&&(ze.delete(),Me.preventDefault(),Me.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(ze=document.jsuitesComponents[document.jsuitesComponents.length-1],ze&&Me.key==="Escape"&&typeof ze.isOpened=="function"&&typeof ze.close=="function"&&ze.isOpened()&&(ze.close(),Me.preventDefault(),Me.stopImmediatePropagation()))},Je=function(Me){(Me.target.getAttribute("data-mask")||Me.target.mask)&&Pe.mask(Me)};document.addEventListener("focusin",xe),document.addEventListener("focusout",ge),document.addEventListener("mouseup",Y),document.addEventListener("mousedown",k),document.addEventListener("mousemove",J),document.addEventListener("mouseover",fe),document.addEventListener("keydown",We),document.addEventListener("contextmenu",Re),document.addEventListener("input",Je)};typeof document<"u"&&!document.jsuitesComponents&&Ve();var Ue=Pe}(),w=w.default,w}()})})(jsuites);var jsuitesExports=jsuites.exports;function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist={exports:{}};(function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=jsuitesExports;(function(e,n){module.exports=n()})(self,function(){return function(){var __webpack_modules__={243:function(e){var n;e.exports=(function(){var o={765:function(L,c){var a;a=function(g){g.version="1.0.2";var D=Math;function H(ye,se){for(var we=0,qe=0;we<ye.length;++we)qe=se*qe+ye[we];return qe}function m(ye,se,we,qe,_e){if(se===0)return we;if(se===1)return qe;for(var Xe=2/ye,at=qe,z=1;z<se;++z)at=qe*z*Xe+_e*we,we=qe,qe=at;return at}function f(ye,se,we,qe,_e){return function(Xe,at){if(qe){if(Xe===0)return qe==1?-1/0:1/0;if(Xe<0)return NaN}return at===0?ye(Xe):at===1?se(Xe):at<0?NaN:m(Xe,at|=0,ye(Xe),se(Xe),_e)}}var j,C,b,T,O,F,U,B,I,P,V,R,Q,de=function(){var ye=.636619772,se=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),we=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),qe=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),_e=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Xe(Ie){var Oe=0,Ye=0,Fe=0,Ke=Ie*Ie;if(Ie<8)Oe=(Ye=H(se,Ke))/(Fe=H(we,Ke));else{var tt=Ie-.785398164;Ye=H(qe,Ke=64/Ke),Fe=H(_e,Ke),Oe=D.sqrt(ye/Ie)*(D.cos(tt)*Ye-D.sin(tt)*Fe*8/Ie)}return Oe}var at=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),z=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Le=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Qe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function ft(Ie){var Oe=0,Ye=0,Fe=0,Ke=Ie*Ie,tt=D.abs(Ie)-2.356194491;return Math.abs(Ie)<8?Oe=(Ye=Ie*H(at,Ke))/(Fe=H(z,Ke)):(Ye=H(Le,Ke=64/Ke),Fe=H(Qe,Ke),Oe=D.sqrt(ye/D.abs(Ie))*(D.cos(tt)*Ye-D.sin(tt)*Fe*8/D.abs(Ie)),Ie<0&&(Oe=-Oe)),Oe}return function Ie(Oe,Ye){if(Ye=Math.round(Ye),!isFinite(Oe))return isNaN(Oe)?Oe:0;if(Ye<0)return(Ye%2?-1:1)*Ie(Oe,-Ye);if(Oe<0)return(Ye%2?-1:1)*Ie(-Oe,Ye);if(Ye===0)return Xe(Oe);if(Ye===1)return ft(Oe);if(Oe===0)return 0;var Fe=0;if(Oe>Ye)Fe=m(Oe,Ye,Xe(Oe),ft(Oe),-1);else{for(var Ke=!1,tt=0,ct=0,te=1,ce=0,ve=2/Oe,Ce=2*D.floor((Ye+D.floor(D.sqrt(40*Ye)))/2);Ce>0;Ce--)ce=Ce*ve*te-tt,tt=te,te=ce,D.abs(te)>1e10&&(te*=1e-10,tt*=1e-10,Fe*=1e-10,ct*=1e-10),Ke&&(ct+=te),Ke=!Ke,Ce==Ye&&(Fe=tt);Fe/=ct=2*ct-te}return Fe}}(),oe=(j=.636619772,C=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),b=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),T=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),O=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),F=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),U=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),B=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),I=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),f(function(ye){var se=0,we=0,qe=0,_e=ye*ye,Xe=ye-.785398164;return ye<8?se=(we=H(C,_e))/(qe=H(b,_e))+j*de(ye,0)*D.log(ye):(we=H(T,_e=64/_e),qe=H(O,_e),se=D.sqrt(j/ye)*(D.sin(Xe)*we+D.cos(Xe)*qe*8/ye)),se},function(ye){var se=0,we=0,qe=0,_e=ye*ye,Xe=ye-2.356194491;return ye<8?se=(we=ye*H(F,_e))/(qe=H(U,_e))+j*(de(ye,1)*D.log(ye)-1/ye):(we=H(B,_e=64/_e),qe=H(I,_e),se=D.sqrt(j/ye)*(D.sin(Xe)*we+D.cos(Xe)*qe*8/ye)),se},0,1,-1)),be=(P=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),V=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),R=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Q=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function ye(se,we){if((we=Math.round(we))===0)return function(Qe){return Qe<=3.75?H(P,Qe*Qe/14.0625):D.exp(D.abs(Qe))/D.sqrt(D.abs(Qe))*H(V,3.75/D.abs(Qe))}(se);if(we===1)return function(Qe){return Qe<3.75?Qe*H(R,Qe*Qe/14.0625):(Qe<0?-1:1)*D.exp(D.abs(Qe))/D.sqrt(D.abs(Qe))*H(Q,3.75/D.abs(Qe))}(se);if(we<0)return NaN;if(D.abs(se)===0)return 0;if(se==1/0)return 1/0;var qe,_e=0,Xe=2/D.abs(se),at=0,z=1,Le=0;for(qe=2*D.round((we+D.round(D.sqrt(40*we)))/2);qe>0;qe--)Le=qe*Xe*z+at,at=z,z=Le,D.abs(z)>1e10&&(z*=1e-10,at*=1e-10,_e*=1e-10),qe==we&&(_e=at);return _e*=ye(se,0)/z,se<0&&we%2?-_e:_e}),Ee=function(){var ye=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),se=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),we=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),qe=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return f(function(_e){return _e<=2?-D.log(_e/2)*be(_e,0)+H(ye,_e*_e/4):D.exp(-_e)/D.sqrt(_e)*H(se,2/_e)},function(_e){return _e<=2?D.log(_e/2)*be(_e,1)+1/_e*H(we,_e*_e/4):D.exp(-_e)/D.sqrt(_e)*H(qe,2/_e)},0,2,1)}();g.besselj=de,g.bessely=oe,g.besseli=be,g.besselk=Ee},a(typeof DO_NOT_EXPORT_BESSEL>"u"?c:{})},162:function(L){var c;L.exports=(c=function(a,g){var D=Array.prototype.concat,H=Array.prototype.slice,m=Object.prototype.toString;function f(I,P){var V=I>P?I:P;return a.pow(10,17-~~(a.log(V>0?V:-V)*a.LOG10E))}var j=Array.isArray||function(I){return m.call(I)==="[object Array]"};function C(I){return m.call(I)==="[object Function]"}function b(I){return typeof I=="number"&&I-I==0}function T(){return new T._init(arguments)}function O(){return 0}function F(){return 1}function U(I,P){return I===P?1:0}T.fn=T.prototype,T._init=function(I){if(j(I[0]))if(j(I[0][0])){C(I[1])&&(I[0]=T.map(I[0],I[1]));for(var P=0;P<I[0].length;P++)this[P]=I[0][P];this.length=I[0].length}else this[0]=C(I[1])?T.map(I[0],I[1]):I[0],this.length=1;else if(b(I[0]))this[0]=T.seq.apply(null,I),this.length=1;else{if(I[0]instanceof T)return T(I[0].toArray());this[0]=[],this.length=1}return this},T._init.prototype=T.prototype,T._init.constructor=T,T.utils={calcRdx:f,isArray:j,isFunction:C,isNumber:b,toVector:function(I){return D.apply([],I)}},T._random_fn=a.random,T.setRandom=function(I){if(typeof I!="function")throw new TypeError("fn is not a function");T._random_fn=I},T.extend=function(I){var P,V;if(arguments.length===1){for(V in I)T[V]=I[V];return this}for(P=1;P<arguments.length;P++)for(V in arguments[P])I[V]=arguments[P][V];return I},T.rows=function(I){return I.length||1},T.cols=function(I){return I[0].length||1},T.dimensions=function(I){return{rows:T.rows(I),cols:T.cols(I)}},T.row=function(I,P){return j(P)?P.map(function(V){return T.row(I,V)}):I[P]},T.rowa=function(I,P){return T.row(I,P)},T.col=function(I,P){if(j(P)){var V=T.arange(I.length).map(function(){return new Array(P.length)});return P.forEach(function(de,oe){T.arange(I.length).forEach(function(be){V[be][oe]=I[be][de]})}),V}for(var R=new Array(I.length),Q=0;Q<I.length;Q++)R[Q]=[I[Q][P]];return R},T.cola=function(I,P){return T.col(I,P).map(function(V){return V[0]})},T.diag=function(I){for(var P=T.rows(I),V=new Array(P),R=0;R<P;R++)V[R]=[I[R][R]];return V},T.antidiag=function(I){for(var P=T.rows(I)-1,V=new Array(P),R=0;P>=0;P--,R++)V[R]=[I[R][P]];return V},T.transpose=function(I){var P,V,R,Q,de,oe=[];for(j(I[0])||(I=[I]),V=I.length,R=I[0].length,de=0;de<R;de++){for(P=new Array(V),Q=0;Q<V;Q++)P[Q]=I[Q][de];oe.push(P)}return oe.length===1?oe[0]:oe},T.map=function(I,P,V){var R,Q,de,oe,be;for(j(I[0])||(I=[I]),Q=I.length,de=I[0].length,oe=V?I:new Array(Q),R=0;R<Q;R++)for(oe[R]||(oe[R]=new Array(de)),be=0;be<de;be++)oe[R][be]=P(I[R][be],R,be);return oe.length===1?oe[0]:oe},T.cumreduce=function(I,P,V){var R,Q,de,oe,be;for(j(I[0])||(I=[I]),Q=I.length,de=I[0].length,oe=V?I:new Array(Q),R=0;R<Q;R++)for(oe[R]||(oe[R]=new Array(de)),de>0&&(oe[R][0]=I[R][0]),be=1;be<de;be++)oe[R][be]=P(oe[R][be-1],I[R][be]);return oe.length===1?oe[0]:oe},T.alter=function(I,P){return T.map(I,P,!0)},T.create=function(I,P,V){var R,Q,de=new Array(I);for(C(P)&&(V=P,P=I),R=0;R<I;R++)for(de[R]=new Array(P),Q=0;Q<P;Q++)de[R][Q]=V(R,Q);return de},T.zeros=function(I,P){return b(P)||(P=I),T.create(I,P,O)},T.ones=function(I,P){return b(P)||(P=I),T.create(I,P,F)},T.rand=function(I,P){return b(P)||(P=I),T.create(I,P,T._random_fn)},T.identity=function(I,P){return b(P)||(P=I),T.create(I,P,U)},T.symmetric=function(I){var P,V,R=I.length;if(I.length!==I[0].length)return!1;for(P=0;P<R;P++)for(V=0;V<R;V++)if(I[V][P]!==I[P][V])return!1;return!0},T.clear=function(I){return T.alter(I,O)},T.seq=function(I,P,V,R){C(R)||(R=!1);var Q,de=[],oe=f(I,P),be=(P*oe-I*oe)/((V-1)*oe),Ee=I;for(Q=0;Ee<=P&&Q<V;Ee=(I*oe+be*oe*++Q)/oe)de.push(R?R(Ee,Q):Ee);return de},T.arange=function(I,P,V){var R,Q=[];if(V=V||1,P===g&&(P=I,I=0),I===P||V===0)return[];if(I<P&&V<0)return[];if(I>P&&V>0)return[];if(V>0)for(R=I;R<P;R+=V)Q.push(R);else for(R=I;R>P;R+=V)Q.push(R);return Q},T.slice=function(){function I(P,V,R,Q){var de,oe=[],be=P.length;if(V===g&&R===g&&Q===g)return T.copy(P);if(Q=Q||1,(V=(V=V||0)>=0?V:be+V)===(R=(R=R||P.length)>=0?R:be+R)||Q===0)return[];if(V<R&&Q<0)return[];if(V>R&&Q>0)return[];if(Q>0)for(de=V;de<R;de+=Q)oe.push(P[de]);else for(de=V;de>R;de+=Q)oe.push(P[de]);return oe}return function(P,V){var R,Q;return b((V=V||{}).row)?b(V.col)?P[V.row][V.col]:I(T.rowa(P,V.row),(R=V.col||{}).start,R.end,R.step):b(V.col)?I(T.cola(P,V.col),(Q=V.row||{}).start,Q.end,Q.step):(Q=V.row||{},R=V.col||{},I(P,Q.start,Q.end,Q.step).map(function(de){return I(de,R.start,R.end,R.step)}))}}(),T.sliceAssign=function(I,P,V){var R,Q;if(b(P.row)){if(b(P.col))return I[P.row][P.col]=V;P.col=P.col||{},P.col.start=P.col.start||0,P.col.end=P.col.end||I[0].length,P.col.step=P.col.step||1,R=T.arange(P.col.start,a.min(I.length,P.col.end),P.col.step);var de=P.row;return R.forEach(function(be,Ee){I[de][be]=V[Ee]}),I}if(b(P.col)){P.row=P.row||{},P.row.start=P.row.start||0,P.row.end=P.row.end||I.length,P.row.step=P.row.step||1,Q=T.arange(P.row.start,a.min(I[0].length,P.row.end),P.row.step);var oe=P.col;return Q.forEach(function(be,Ee){I[be][oe]=V[Ee]}),I}return V[0].length===g&&(V=[V]),P.row.start=P.row.start||0,P.row.end=P.row.end||I.length,P.row.step=P.row.step||1,P.col.start=P.col.start||0,P.col.end=P.col.end||I[0].length,P.col.step=P.col.step||1,Q=T.arange(P.row.start,a.min(I.length,P.row.end),P.row.step),R=T.arange(P.col.start,a.min(I[0].length,P.col.end),P.col.step),Q.forEach(function(be,Ee){R.forEach(function(ye,se){I[be][ye]=V[Ee][se]})}),I},T.diagonal=function(I){var P=T.zeros(I.length,I.length);return I.forEach(function(V,R){P[R][R]=V}),P},T.copy=function(I){return I.map(function(P){return b(P)?P:P.map(function(V){return V})})};var B=T.prototype;return B.length=0,B.push=Array.prototype.push,B.sort=Array.prototype.sort,B.splice=Array.prototype.splice,B.slice=Array.prototype.slice,B.toArray=function(){return this.length>1?H.call(this):H.call(this)[0]},B.map=function(I,P){return T(T.map(this,I,P))},B.cumreduce=function(I,P){return T(T.cumreduce(this,I,P))},B.alter=function(I){return T.alter(this,I),this},function(I){for(var P=0;P<I.length;P++)(function(V){B[V]=function(R){var Q,de=this;return R?(setTimeout(function(){R.call(de,B[V].call(de))}),this):(Q=T[V](this),j(Q)?T(Q):Q)}})(I[P])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(I){for(var P=0;P<I.length;P++)(function(V){B[V]=function(R,Q){var de=this;return Q?(setTimeout(function(){Q.call(de,B[V].call(de,R))}),this):T(T[V](this,R))}})(I[P])}("row col".split(" ")),function(I){for(var P=0;P<I.length;P++)(function(V){B[V]=function(){return T(T[V].apply(null,arguments))}})(I[P])}("create zeros ones rand identity".split(" ")),T}(Math),function(a,g){var D=a.utils.isFunction;function H(j,C){return j-C}function m(j,C,b){return g.max(C,g.min(j,b))}a.sum=function(j){for(var C=0,b=j.length;--b>=0;)C+=j[b];return C},a.sumsqrd=function(j){for(var C=0,b=j.length;--b>=0;)C+=j[b]*j[b];return C},a.sumsqerr=function(j){for(var C,b=a.mean(j),T=0,O=j.length;--O>=0;)T+=(C=j[O]-b)*C;return T},a.sumrow=function(j){for(var C=0,b=j.length;--b>=0;)C+=j[b];return C},a.product=function(j){for(var C=1,b=j.length;--b>=0;)C*=j[b];return C},a.min=function(j){for(var C=j[0],b=0;++b<j.length;)j[b]<C&&(C=j[b]);return C},a.max=function(j){for(var C=j[0],b=0;++b<j.length;)j[b]>C&&(C=j[b]);return C},a.unique=function(j){for(var C={},b=[],T=0;T<j.length;T++)C[j[T]]||(C[j[T]]=!0,b.push(j[T]));return b},a.mean=function(j){return a.sum(j)/j.length},a.meansqerr=function(j){return a.sumsqerr(j)/j.length},a.geomean=function(j){var C=j.map(g.log),b=a.mean(C);return g.exp(b)},a.median=function(j){var C=j.length,b=j.slice().sort(H);return 1&C?b[C/2|0]:(b[C/2-1]+b[C/2])/2},a.cumsum=function(j){return a.cumreduce(j,function(C,b){return C+b})},a.cumprod=function(j){return a.cumreduce(j,function(C,b){return C*b})},a.diff=function(j){var C,b=[],T=j.length;for(C=1;C<T;C++)b.push(j[C]-j[C-1]);return b},a.rank=function(j){var C,b=[],T={};for(C=0;C<j.length;C++)T[B=j[C]]?T[B]++:(T[B]=1,b.push(B));var O=b.sort(H),F={},U=1;for(C=0;C<O.length;C++){var B,I=T[B=O[C]],P=(U+(U+I-1))/2;F[B]=P,U+=I}return j.map(function(V){return F[V]})},a.mode=function(j){var C,b=j.length,T=j.slice().sort(H),O=1,F=0,U=0,B=[];for(C=0;C<b;C++)T[C]===T[C+1]?O++:(O>F?(B=[T[C]],F=O,U=0):O===F&&(B.push(T[C]),U++),O=1);return U===0?B[0]:B},a.range=function(j){return a.max(j)-a.min(j)},a.variance=function(j,C){return a.sumsqerr(j)/(j.length-(C?1:0))},a.pooledvariance=function(j){return j.reduce(function(C,b){return C+a.sumsqerr(b)},0)/(j.reduce(function(C,b){return C+b.length},0)-j.length)},a.deviation=function(j){for(var C=a.mean(j),b=j.length,T=new Array(b),O=0;O<b;O++)T[O]=j[O]-C;return T},a.stdev=function(j,C){return g.sqrt(a.variance(j,C))},a.pooledstdev=function(j){return g.sqrt(a.pooledvariance(j))},a.meandev=function(j){for(var C=a.mean(j),b=[],T=j.length-1;T>=0;T--)b.push(g.abs(j[T]-C));return a.mean(b)},a.meddev=function(j){for(var C=a.median(j),b=[],T=j.length-1;T>=0;T--)b.push(g.abs(j[T]-C));return a.median(b)},a.coeffvar=function(j){return a.stdev(j)/a.mean(j)},a.quartiles=function(j){var C=j.length,b=j.slice().sort(H);return[b[g.round(C/4)-1],b[g.round(C/2)-1],b[g.round(3*C/4)-1]]},a.quantiles=function(j,C,b,T){var O,F,U,B,I,P=j.slice().sort(H),V=[C.length],R=j.length;for(b===void 0&&(b=.375),T===void 0&&(T=.375),O=0;O<C.length;O++)U=R*(F=C[O])+(b+F*(1-b-T)),B=g.floor(m(U,1,R-1)),I=m(U-B,0,1),V[O]=(1-I)*P[B-1]+I*P[B];return V},a.percentile=function(j,C,b){var T=j.slice().sort(H),O=C*(T.length+(b?1:-1))+(b?0:1),F=parseInt(O),U=O-F;return F+1<T.length?T[F-1]+U*(T[F]-T[F-1]):T[F-1]},a.percentileOfScore=function(j,C,b){var T,O,F=0,U=j.length,B=!1;for(b==="strict"&&(B=!0),O=0;O<U;O++)T=j[O],(B&&T<C||!B&&T<=C)&&F++;return F/U},a.histogram=function(j,C){C=C||4;var b,T=a.min(j),O=(a.max(j)-T)/C,F=j.length,U=[];for(b=0;b<C;b++)U[b]=0;for(b=0;b<F;b++)U[g.min(g.floor((j[b]-T)/O),C-1)]+=1;return U},a.covariance=function(j,C){var b,T=a.mean(j),O=a.mean(C),F=j.length,U=new Array(F);for(b=0;b<F;b++)U[b]=(j[b]-T)*(C[b]-O);return a.sum(U)/(F-1)},a.corrcoeff=function(j,C){return a.covariance(j,C)/a.stdev(j,1)/a.stdev(C,1)},a.spearmancoeff=function(j,C){return j=a.rank(j),C=a.rank(C),a.corrcoeff(j,C)},a.stanMoment=function(j,C){for(var b=a.mean(j),T=a.stdev(j),O=j.length,F=0,U=0;U<O;U++)F+=g.pow((j[U]-b)/T,C);return F/j.length},a.skewness=function(j){return a.stanMoment(j,3)},a.kurtosis=function(j){return a.stanMoment(j,4)-3};var f=a.prototype;(function(j){for(var C=0;C<j.length;C++)(function(b){f[b]=function(T,O){var F=[],U=0,B=this;if(D(T)&&(O=T,T=!1),O)return setTimeout(function(){O.call(B,f[b].call(B,T))}),this;if(this.length>1){for(B=T===!0?this:this.transpose();U<B.length;U++)F[U]=a[b](B[U]);return F}return a[b](this[0],T)}})(j[C])})("cumsum cumprod".split(" ")),function(j){for(var C=0;C<j.length;C++)(function(b){f[b]=function(T,O){var F=[],U=0,B=this;if(D(T)&&(O=T,T=!1),O)return setTimeout(function(){O.call(B,f[b].call(B,T))}),this;if(this.length>1){for(b!=="sumrow"&&(B=T===!0?this:this.transpose());U<B.length;U++)F[U]=a[b](B[U]);return T===!0?a[b](a.utils.toVector(F)):F}return a[b](this[0],T)}})(j[C])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(j){for(var C=0;C<j.length;C++)(function(b){f[b]=function(){var T,O=[],F=0,U=this,B=Array.prototype.slice.call(arguments);if(D(B[B.length-1])){T=B[B.length-1];var I=B.slice(0,B.length-1);return setTimeout(function(){T.call(U,f[b].apply(U,I))}),this}T=void 0;var P=function(V){return a[b].apply(U,[V].concat(B))};if(this.length>1){for(U=U.transpose();F<U.length;F++)O[F]=P(U[F]);return O}return P(this[0])}})(j[C])}("quantiles percentileOfScore".split(" "))}(c,Math),function(a,g){a.gammaln=function(D){var H,m,f,j=0,C=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],b=1.000000000190015;for(f=(m=H=D)+5.5,f-=(H+.5)*g.log(f);j<6;j++)b+=C[j]/++m;return g.log(2.5066282746310007*b/H)-f},a.loggam=function(D){var H,m,f,j,C,b,T,O=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(H=D,T=0,D==1||D==2)return 0;for(D<=7&&(H=D+(T=g.floor(7-D))),m=1/(H*H),f=2*g.PI,C=O[9],b=8;b>=0;b--)C*=m,C+=O[b];if(j=C/H+.5*g.log(f)+(H-.5)*g.log(H)-H,D<=7)for(b=1;b<=T;b++)j-=g.log(H-1),H-=1;return j},a.gammafn=function(D){var H,m,f,j,C=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],b=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],T=!1,O=0,F=0,U=0,B=D;if(D>171.6243769536076)return 1/0;if(B<=0){if(!(j=B%1+36e-17))return 1/0;T=(1&B?-1:1)*g.PI/g.sin(g.PI*j),B=1-B}for(f=B,m=B<1?B++:(B-=O=(0|B)-1)-1,H=0;H<8;++H)U=(U+C[H])*m,F=F*m+b[H];if(j=U/F+1,f<B)j/=f;else if(f>B)for(H=0;H<O;++H)j*=B,B++;return T&&(j=T/j),j},a.gammap=function(D,H){return a.lowRegGamma(D,H)*a.gammafn(D)},a.lowRegGamma=function(D,H){var m,f=a.gammaln(D),j=D,C=1/D,b=C,T=H+1-D,O=1/1e-30,F=1/T,U=F,B=1,I=-~(8.5*g.log(D>=1?D:1/D)+.4*D+17);if(H<0||D<=0)return NaN;if(H<D+1){for(;B<=I;B++)C+=b*=H/++j;return C*g.exp(-H+D*g.log(H)-f)}for(;B<=I;B++)U*=(F=1/(F=(m=-B*(B-D))*F+(T+=2)))*(O=T+m/O);return 1-U*g.exp(-H+D*g.log(H)-f)},a.factorialln=function(D){return D<0?NaN:a.gammaln(D+1)},a.factorial=function(D){return D<0?NaN:a.gammafn(D+1)},a.combination=function(D,H){return D>170||H>170?g.exp(a.combinationln(D,H)):a.factorial(D)/a.factorial(H)/a.factorial(D-H)},a.combinationln=function(D,H){return a.factorialln(D)-a.factorialln(H)-a.factorialln(D-H)},a.permutation=function(D,H){return a.factorial(D)/a.factorial(D-H)},a.betafn=function(D,H){if(!(D<=0||H<=0))return D+H>170?g.exp(a.betaln(D,H)):a.gammafn(D)*a.gammafn(H)/a.gammafn(D+H)},a.betaln=function(D,H){return a.gammaln(D)+a.gammaln(H)-a.gammaln(D+H)},a.betacf=function(D,H,m){var f,j,C,b,T=1e-30,O=1,F=H+m,U=H+1,B=H-1,I=1,P=1-F*D/U;for(g.abs(P)<T&&(P=T),b=P=1/P;O<=100&&(P=1+(j=O*(m-O)*D/((B+(f=2*O))*(H+f)))*P,g.abs(P)<T&&(P=T),I=1+j/I,g.abs(I)<T&&(I=T),b*=(P=1/P)*I,P=1+(j=-(H+O)*(F+O)*D/((H+f)*(U+f)))*P,g.abs(P)<T&&(P=T),I=1+j/I,g.abs(I)<T&&(I=T),b*=C=(P=1/P)*I,!(g.abs(C-1)<3e-7));O++);return b},a.gammapinv=function(D,H){var m,f,j,C,b,T,O=0,F=H-1,U=a.gammaln(H);if(D>=1)return g.max(100,H+100*g.sqrt(H));if(D<=0)return 0;for(H>1?(b=g.log(F),T=g.exp(F*(b-1)-U),C=D<.5?D:1-D,m=(2.30753+.27061*(f=g.sqrt(-2*g.log(C))))/(1+f*(.99229+.04481*f))-f,D<.5&&(m=-m),m=g.max(.001,H*g.pow(1-1/(9*H)-m/(3*g.sqrt(H)),3))):m=D<(f=1-H*(.253+.12*H))?g.pow(D/f,1/H):1-g.log(1-(D-f)/(1-f));O<12;O++){if(m<=0)return 0;if((m-=f=(j=(a.lowRegGamma(H,m)-D)/(f=H>1?T*g.exp(-(m-F)+F*(g.log(m)-b)):g.exp(-m+F*g.log(m)-U)))/(1-.5*g.min(1,j*((H-1)/m-1))))<=0&&(m=.5*(m+f)),g.abs(f)<1e-8*m)break}return m},a.erf=function(D){var H,m,f,j,C=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],b=C.length-1,T=!1,O=0,F=0;for(D<0&&(D=-D,T=!0),m=4*(H=2/(2+D))-2;b>0;b--)f=O,O=m*O-F+C[b],F=f;return j=H*g.exp(-D*D+.5*(C[0]+m*O)-F),T?j-1:1-j},a.erfc=function(D){return 1-a.erf(D)},a.erfcinv=function(D){var H,m,f,j,C=0;if(D>=2)return-100;if(D<=0)return 100;for(j=D<1?D:2-D,H=-.70711*((2.30753+.27061*(f=g.sqrt(-2*g.log(j/2))))/(1+f*(.99229+.04481*f))-f);C<2;C++)H+=(m=a.erfc(H)-j)/(1.1283791670955126*g.exp(-H*H)-H*m);return D<1?H:-H},a.ibetainv=function(D,H,m){var f,j,C,b,T,O,F,U,B,I,P=H-1,V=m-1,R=0;if(D<=0)return 0;if(D>=1)return 1;for(H>=1&&m>=1?(C=D<.5?D:1-D,O=(2.30753+.27061*(b=g.sqrt(-2*g.log(C))))/(1+b*(.99229+.04481*b))-b,D<.5&&(O=-O),F=(O*O-3)/6,U=2/(1/(2*H-1)+1/(2*m-1)),B=O*g.sqrt(F+U)/U-(1/(2*m-1)-1/(2*H-1))*(F+.8333333333333334-2/(3*U)),O=H/(H+m*g.exp(2*B))):(f=g.log(H/(H+m)),j=g.log(m/(H+m)),O=D<(b=g.exp(H*f)/H)/(B=b+(T=g.exp(m*j)/m))?g.pow(H*B*D,1/H):1-g.pow(m*B*(1-D),1/m)),I=-a.gammaln(H)-a.gammaln(m)+a.gammaln(H+m);R<10;R++){if(O===0||O===1)return O;if((O-=b=(T=(a.ibeta(O,H,m)-D)/(b=g.exp(P*g.log(O)+V*g.log(1-O)+I)))/(1-.5*g.min(1,T*(P/O-V/(1-O)))))<=0&&(O=.5*(O+b)),O>=1&&(O=.5*(O+b+1)),g.abs(b)<1e-8*O&&R>0)break}return O},a.ibeta=function(D,H,m){var f=D===0||D===1?0:g.exp(a.gammaln(H+m)-a.gammaln(H)-a.gammaln(m)+H*g.log(D)+m*g.log(1-D));return!(D<0||D>1)&&(D<(H+1)/(H+m+2)?f*a.betacf(D,H,m)/H:1-f*a.betacf(1-D,m,H)/m)},a.randn=function(D,H){var m,f,j,C,b;if(H||(H=D),D)return a.create(D,H,function(){return a.randn()});do m=a._random_fn(),f=1.7156*(a._random_fn()-.5),b=(j=m-.449871)*j+(C=g.abs(f)+.386595)*(.196*C-.25472*j);while(b>.27597&&(b>.27846||f*f>-4*g.log(m)*m*m));return f/m},a.randg=function(D,H,m){var f,j,C,b,T,O,F=D;if(m||(m=H),D||(D=1),H)return(O=a.zeros(H,m)).alter(function(){return a.randg(D)}),O;D<1&&(D+=1),f=D-.3333333333333333,j=1/g.sqrt(9*f);do{do b=1+j*(T=a.randn());while(b<=0);b*=b*b,C=a._random_fn()}while(C>1-.331*g.pow(T,4)&&g.log(C)>.5*T*T+f*(1-b+g.log(b)));if(D==F)return f*b;do C=a._random_fn();while(C===0);return g.pow(C,1/F)*f*b},function(D){for(var H=0;H<D.length;H++)(function(m){a.fn[m]=function(){return a(a.map(this,function(f){return a[m](f)}))}})(D[H])}("gammaln gammafn factorial factorialln".split(" ")),function(D){for(var H=0;H<D.length;H++)(function(m){a.fn[m]=function(){return a(a[m].apply(null,arguments))}})(D[H])}("randn".split(" "))}(c,Math),function(a,g){function D(m,f,j,C){for(var b,T=0,O=1,F=1,U=1,B=0,I=0;g.abs((F-I)/F)>C;)I=F,O=U+(b=-(f+B)*(f+j+B)*m/(f+2*B)/(f+2*B+1))*O,F=(T=F+b*T)+(b=(B+=1)*(j-B)*m/(f+2*B-1)/(f+2*B))*F,T/=U=O+b*U,O/=U,F/=U,U=1;return F/f}function H(m,f,j){var C=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],b=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],T=.5*m;if(T>=8)return 1;var O,F=2*a.normal.cdf(T,0,1,1,0)-1;F=F>=g.exp(-50/j)?g.pow(F,j):0;for(var U=T,B=(8-T)/(O=m>3?2:3),I=U+B,P=0,V=j-1,R=1;R<=O;R++){for(var Q=0,de=.5*(I+U),oe=.5*(I-U),be=1;be<=12;be++){var Ee,ye=de+oe*(6<be?C[(Ee=12-be+1)-1]:-C[(Ee=be)-1]),se=ye*ye;if(se>60)break;var we=2*a.normal.cdf(ye,0,1,1,0)*.5-2*a.normal.cdf(ye,m,1,1,0)*.5;we>=g.exp(-30/V)&&(Q+=we=b[Ee-1]*g.exp(-.5*se)*g.pow(we,V))}P+=Q*=2*oe*j/g.sqrt(2*g.PI),U=I,I+=B}return(F+=P)<=g.exp(-30/f)?0:(F=g.pow(F,f))>=1?1:F}(function(m){for(var f=0;f<m.length;f++)(function(j){a[j]=function C(b,T,O){return this instanceof C?(this._a=b,this._b=T,this._c=O,this):new C(b,T,O)},a.fn[j]=function(C,b,T){var O=a[j](C,b,T);return O.data=this,O},a[j].prototype.sample=function(C){var b=this._a,T=this._b,O=this._c;return C?a.alter(C,function(){return a[j].sample(b,T,O)}):a[j].sample(b,T,O)},function(C){for(var b=0;b<C.length;b++)(function(T){a[j].prototype[T]=function(O){var F=this._a,U=this._b,B=this._c;return O||O===0||(O=this.data),typeof O!="number"?a.fn.map.call(O,function(I){return a[j][T](I,F,U,B)}):a[j][T](O,F,U,B)}})(C[b])}("pdf cdf inv".split(" ")),function(C){for(var b=0;b<C.length;b++)(function(T){a[j].prototype[T]=function(){return a[j][T](this._a,this._b,this._c)}})(C[b])}("mean median mode variance".split(" "))})(m[f])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),a.extend(a.beta,{pdf:function(m,f,j){return m>1||m<0?0:f==1&&j==1?1:f<512&&j<512?g.pow(m,f-1)*g.pow(1-m,j-1)/a.betafn(f,j):g.exp((f-1)*g.log(m)+(j-1)*g.log(1-m)-a.betaln(f,j))},cdf:function(m,f,j){return m>1||m<0?1*(m>1):a.ibeta(m,f,j)},inv:function(m,f,j){return a.ibetainv(m,f,j)},mean:function(m,f){return m/(m+f)},median:function(m,f){return a.ibetainv(.5,m,f)},mode:function(m,f){return(m-1)/(m+f-2)},sample:function(m,f){var j=a.randg(m);return j/(j+a.randg(f))},variance:function(m,f){return m*f/(g.pow(m+f,2)*(m+f+1))}}),a.extend(a.centralF,{pdf:function(m,f,j){var C;return m<0?0:f<=2?m===0&&f<2?1/0:m===0&&f===2?1:1/a.betafn(f/2,j/2)*g.pow(f/j,f/2)*g.pow(m,f/2-1)*g.pow(1+f/j*m,-(f+j)/2):(C=f*m/(j+m*f),f*(j/(j+m*f))/2*a.binomial.pdf((f-2)/2,(f+j-2)/2,C))},cdf:function(m,f,j){return m<0?0:a.ibeta(f*m/(f*m+j),f/2,j/2)},inv:function(m,f,j){return j/(f*(1/a.ibetainv(m,f/2,j/2)-1))},mean:function(m,f){return f>2?f/(f-2):void 0},mode:function(m,f){return m>2?f*(m-2)/(m*(f+2)):void 0},sample:function(m,f){return 2*a.randg(m/2)/m/(2*a.randg(f/2)/f)},variance:function(m,f){if(!(f<=4))return 2*f*f*(m+f-2)/(m*(f-2)*(f-2)*(f-4))}}),a.extend(a.cauchy,{pdf:function(m,f,j){return j<0?0:j/(g.pow(m-f,2)+g.pow(j,2))/g.PI},cdf:function(m,f,j){return g.atan((m-f)/j)/g.PI+.5},inv:function(m,f,j){return f+j*g.tan(g.PI*(m-.5))},median:function(m){return m},mode:function(m){return m},sample:function(m,f){return a.randn()*g.sqrt(1/(2*a.randg(.5)))*f+m}}),a.extend(a.chisquare,{pdf:function(m,f){return m<0?0:m===0&&f===2?.5:g.exp((f/2-1)*g.log(m)-m/2-f/2*g.log(2)-a.gammaln(f/2))},cdf:function(m,f){return m<0?0:a.lowRegGamma(f/2,m/2)},inv:function(m,f){return 2*a.gammapinv(m,.5*f)},mean:function(m){return m},median:function(m){return m*g.pow(1-2/(9*m),3)},mode:function(m){return m-2>0?m-2:0},sample:function(m){return 2*a.randg(m/2)},variance:function(m){return 2*m}}),a.extend(a.exponential,{pdf:function(m,f){return m<0?0:f*g.exp(-f*m)},cdf:function(m,f){return m<0?0:1-g.exp(-f*m)},inv:function(m,f){return-g.log(1-m)/f},mean:function(m){return 1/m},median:function(m){return 1/m*g.log(2)},mode:function(){return 0},sample:function(m){return-1/m*g.log(a._random_fn())},variance:function(m){return g.pow(m,-2)}}),a.extend(a.gamma,{pdf:function(m,f,j){return m<0?0:m===0&&f===1?1/j:g.exp((f-1)*g.log(m)-m/j-a.gammaln(f)-f*g.log(j))},cdf:function(m,f,j){return m<0?0:a.lowRegGamma(f,m/j)},inv:function(m,f,j){return a.gammapinv(m,f)*j},mean:function(m,f){return m*f},mode:function(m,f){if(m>1)return(m-1)*f},sample:function(m,f){return a.randg(m)*f},variance:function(m,f){return m*f*f}}),a.extend(a.invgamma,{pdf:function(m,f,j){return m<=0?0:g.exp(-(f+1)*g.log(m)-j/m-a.gammaln(f)+f*g.log(j))},cdf:function(m,f,j){return m<=0?0:1-a.lowRegGamma(f,j/m)},inv:function(m,f,j){return j/a.gammapinv(1-m,f)},mean:function(m,f){return m>1?f/(m-1):void 0},mode:function(m,f){return f/(m+1)},sample:function(m,f){return f/a.randg(m)},variance:function(m,f){if(!(m<=2))return f*f/((m-1)*(m-1)*(m-2))}}),a.extend(a.kumaraswamy,{pdf:function(m,f,j){return m===0&&f===1?j:m===1&&j===1?f:g.exp(g.log(f)+g.log(j)+(f-1)*g.log(m)+(j-1)*g.log(1-g.pow(m,f)))},cdf:function(m,f,j){return m<0?0:m>1?1:1-g.pow(1-g.pow(m,f),j)},inv:function(m,f,j){return g.pow(1-g.pow(1-m,1/j),1/f)},mean:function(m,f){return f*a.gammafn(1+1/m)*a.gammafn(f)/a.gammafn(1+1/m+f)},median:function(m,f){return g.pow(1-g.pow(2,-1/f),1/m)},mode:function(m,f){if(m>=1&&f>=1&&m!==1&&f!==1)return g.pow((m-1)/(m*f-1),1/m)},variance:function(){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(m,f,j){return m<=0?0:g.exp(-g.log(m)-.5*g.log(2*g.PI)-g.log(j)-g.pow(g.log(m)-f,2)/(2*j*j))},cdf:function(m,f,j){return m<0?0:.5+.5*a.erf((g.log(m)-f)/g.sqrt(2*j*j))},inv:function(m,f,j){return g.exp(-1.4142135623730951*j*a.erfcinv(2*m)+f)},mean:function(m,f){return g.exp(m+f*f/2)},median:function(m){return g.exp(m)},mode:function(m,f){return g.exp(m-f*f)},sample:function(m,f){return g.exp(a.randn()*f+m)},variance:function(m,f){return(g.exp(f*f)-1)*g.exp(2*m+f*f)}}),a.extend(a.noncentralt,{pdf:function(m,f,j){return g.abs(j)<1e-14?a.studentt.pdf(m,f):g.abs(m)<1e-14?g.exp(a.gammaln((f+1)/2)-j*j/2-.5*g.log(g.PI*f)-a.gammaln(f/2)):f/m*(a.noncentralt.cdf(m*g.sqrt(1+2/f),f+2,j)-a.noncentralt.cdf(m,f,j))},cdf:function(m,f,j){var C=1e-14;if(g.abs(j)<C)return a.studentt.cdf(m,f);var b=!1;m<0&&(b=!0,j=-j);for(var T=a.normal.cdf(-j,0,1),O=C+1,F=O,U=m*m/(m*m+f),B=0,I=g.exp(-j*j/2),P=g.exp(-j*j/2-.5*g.log(2)-a.gammaln(1.5))*j;B<200||F>C||O>C;)F=O,B>0&&(I*=j*j/(2*B),P*=j*j/(2*(B+.5))),T+=.5*(O=I*a.beta.cdf(U,B+.5,f/2)+P*a.beta.cdf(U,B+1,f/2)),B++;return b?1-T:T}}),a.extend(a.normal,{pdf:function(m,f,j){return g.exp(-.5*g.log(2*g.PI)-g.log(j)-g.pow(m-f,2)/(2*j*j))},cdf:function(m,f,j){return .5*(1+a.erf((m-f)/g.sqrt(2*j*j)))},inv:function(m,f,j){return-1.4142135623730951*j*a.erfcinv(2*m)+f},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},sample:function(m,f){return a.randn()*f+m},variance:function(m,f){return f*f}}),a.extend(a.pareto,{pdf:function(m,f,j){return m<f?0:j*g.pow(f,j)/g.pow(m,j+1)},cdf:function(m,f,j){return m<f?0:1-g.pow(f/m,j)},inv:function(m,f,j){return f/g.pow(1-m,1/j)},mean:function(m,f){if(!(f<=1))return f*g.pow(m,f)/(f-1)},median:function(m,f){return m*(f*g.SQRT2)},mode:function(m){return m},variance:function(m,f){if(!(f<=2))return m*m*f/(g.pow(f-1,2)*(f-2))}}),a.extend(a.studentt,{pdf:function(m,f){return f=f>1e100?1e100:f,1/(g.sqrt(f)*a.betafn(.5,f/2))*g.pow(1+m*m/f,-(f+1)/2)},cdf:function(m,f){var j=f/2;return a.ibeta((m+g.sqrt(m*m+f))/(2*g.sqrt(m*m+f)),j,j)},inv:function(m,f){var j=a.ibetainv(2*g.min(m,1-m),.5*f,.5);return j=g.sqrt(f*(1-j)/j),m>.5?j:-j},mean:function(m){return m>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(m){return a.randn()*g.sqrt(m/(2*a.randg(m/2)))},variance:function(m){return m>2?m/(m-2):m>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(m,f,j){return m<0||f<0||j<0?0:j/f*g.pow(m/f,j-1)*g.exp(-g.pow(m/f,j))},cdf:function(m,f,j){return m<0?0:1-g.exp(-g.pow(m/f,j))},inv:function(m,f,j){return f*g.pow(-g.log(1-m),1/j)},mean:function(m,f){return m*a.gammafn(1+1/f)},median:function(m,f){return m*g.pow(g.log(2),1/f)},mode:function(m,f){return f<=1?0:m*g.pow((f-1)/f,1/f)},sample:function(m,f){return m*g.pow(-g.log(a._random_fn()),1/f)},variance:function(m,f){return m*m*a.gammafn(1+2/f)-g.pow(a.weibull.mean(m,f),2)}}),a.extend(a.uniform,{pdf:function(m,f,j){return m<f||m>j?0:1/(j-f)},cdf:function(m,f,j){return m<f?0:m<j?(m-f)/(j-f):1},inv:function(m,f,j){return f+m*(j-f)},mean:function(m,f){return .5*(m+f)},median:function(m,f){return a.mean(m,f)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,f){return m/2+f/2+(f/2-m/2)*(2*a._random_fn()-1)},variance:function(m,f){return g.pow(f-m,2)/12}}),a.extend(a.binomial,{pdf:function(m,f,j){return j===0||j===1?f*j===m?1:0:a.combination(f,m)*g.pow(j,m)*g.pow(1-j,f-m)},cdf:function(m,f,j){var C,b=1e-10;if(m<0)return 0;if(m>=f)return 1;if(j<0||j>1||f<=0)return NaN;var T=j,O=(m=g.floor(m))+1,F=f-m,U=O+F,B=g.exp(a.gammaln(U)-a.gammaln(F)-a.gammaln(O)+O*g.log(T)+F*g.log(1-T));return C=T<(O+1)/(U+2)?B*D(T,O,F,b):1-B*D(1-T,F,O,b),g.round(1/b*(1-C))/(1/b)}}),a.extend(a.negbin,{pdf:function(m,f,j){return m===m>>>0&&(m<0?0:a.combination(m+f-1,f-1)*g.pow(1-j,m)*g.pow(j,f))},cdf:function(m,f,j){var C=0,b=0;if(m<0)return 0;for(;b<=m;b++)C+=a.negbin.pdf(b,f,j);return C}}),a.extend(a.hypgeom,{pdf:function(m,f,j,C){if(m!=m|0)return!1;if(m<0||m<j-(f-C)||m>C||m>j)return 0;if(2*j>f)return 2*C>f?a.hypgeom.pdf(f-j-C+m,f,f-j,f-C):a.hypgeom.pdf(C-m,f,f-j,C);if(2*C>f)return a.hypgeom.pdf(j-m,f,j,f-C);if(j<C)return a.hypgeom.pdf(m,f,C,j);for(var b=1,T=0,O=0;O<m;O++){for(;b>1&&T<C;)b*=1-j/(f-T),T++;b*=(C-O)*(j-O)/((O+1)*(f-j-C+O+1))}for(;T<C;T++)b*=1-j/(f-T);return g.min(1,g.max(0,b))},cdf:function(m,f,j,C){if(m<0||m<j-(f-C))return 0;if(m>=C||m>=j)return 1;if(2*j>f)return 2*C>f?a.hypgeom.cdf(f-j-C+m,f,f-j,f-C):1-a.hypgeom.cdf(C-m-1,f,f-j,C);if(2*C>f)return 1-a.hypgeom.cdf(j-m-1,f,j,f-C);if(j<C)return a.hypgeom.cdf(m,f,C,j);for(var b=1,T=1,O=0,F=0;F<m;F++){for(;b>1&&O<C;){var U=1-j/(f-O);T*=U,b*=U,O++}b+=T*=(C-F)*(j-F)/((F+1)*(f-j-C+F+1))}for(;O<C;O++)b*=1-j/(f-O);return g.min(1,g.max(0,b))}}),a.extend(a.poisson,{pdf:function(m,f){return f<0||m%1!=0||m<0?0:g.pow(f,m)*g.exp(-f)/a.factorial(m)},cdf:function(m,f){var j=[],C=0;if(m<0)return 0;for(;C<=m;C++)j.push(a.poisson.pdf(C,f));return a.sum(j)},mean:function(m){return m},variance:function(m){return m},sampleSmall:function(m){var f=1,j=0,C=g.exp(-m);do j++,f*=a._random_fn();while(f>C);return j-1},sampleLarge:function(m){var f,j,C,b,T,O,F,U,B,I,P=m;for(b=g.sqrt(P),T=g.log(P),O=.02483*(F=.931+2.53*b)-.059,U=1.1239+1.1328/(F-3.4),B=.9277-3.6224/(F-2);;)if(j=g.random()-.5,C=g.random(),I=.5-g.abs(j),f=g.floor((2*O/I+F)*j+P+.43),I>=.07&&C<=B||!(f<0||I<.013&&C>I)&&g.log(C)+g.log(U)-g.log(O/(I*I)+F)<=f*T-P-a.loggam(f+1))return f},sample:function(m){return m<10?this.sampleSmall(m):this.sampleLarge(m)}}),a.extend(a.triangular,{pdf:function(m,f,j,C){return j<=f||C<f||C>j?NaN:m<f||m>j?0:m<C?2*(m-f)/((j-f)*(C-f)):m===C?2/(j-f):2*(j-m)/((j-f)*(j-C))},cdf:function(m,f,j,C){return j<=f||C<f||C>j?NaN:m<=f?0:m>=j?1:m<=C?g.pow(m-f,2)/((j-f)*(C-f)):1-g.pow(j-m,2)/((j-f)*(j-C))},inv:function(m,f,j,C){return j<=f||C<f||C>j?NaN:m<=(C-f)/(j-f)?f+(j-f)*g.sqrt(m*((C-f)/(j-f))):f+(j-f)*(1-g.sqrt((1-m)*(1-(C-f)/(j-f))))},mean:function(m,f,j){return(m+f+j)/3},median:function(m,f,j){return j<=(m+f)/2?f-g.sqrt((f-m)*(f-j))/g.sqrt(2):j>(m+f)/2?m+g.sqrt((f-m)*(j-m))/g.sqrt(2):void 0},mode:function(m,f,j){return j},sample:function(m,f,j){var C=a._random_fn();return C<(j-m)/(f-m)?m+g.sqrt(C*(f-m)*(j-m)):f-g.sqrt((1-C)*(f-m)*(f-j))},variance:function(m,f,j){return(m*m+f*f+j*j-m*f-m*j-f*j)/18}}),a.extend(a.arcsine,{pdf:function(m,f,j){return j<=f?NaN:m<=f||m>=j?0:2/g.PI*g.pow(g.pow(j-f,2)-g.pow(2*m-f-j,2),-.5)},cdf:function(m,f,j){return m<f?0:m<j?2/g.PI*g.asin(g.sqrt((m-f)/(j-f))):1},inv:function(m,f,j){return f+(.5-.5*g.cos(g.PI*m))*(j-f)},mean:function(m,f){return f<=m?NaN:(m+f)/2},median:function(m,f){return f<=m?NaN:(m+f)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,f){return(m+f)/2+(f-m)/2*g.sin(2*g.PI*a.uniform.sample(0,1))},variance:function(m,f){return f<=m?NaN:g.pow(f-m,2)/8}}),a.extend(a.laplace,{pdf:function(m,f,j){return j<=0?0:g.exp(-g.abs(m-f)/j)/(2*j)},cdf:function(m,f,j){return j<=0?0:m<f?.5*g.exp((m-f)/j):1-.5*g.exp(-(m-f)/j)},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},variance:function(m,f){return 2*f*f},sample:function(m,f){var j,C=a._random_fn()-.5;return m-f*((j=C)/g.abs(j))*g.log(1-2*g.abs(C))}}),a.extend(a.tukey,{cdf:function(m,f,j){var C=f,b=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],T=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(m<=0)return 0;if(j<2||C<2)return NaN;if(!Number.isFinite(m))return 1;if(j>25e3)return H(m,1,C);var O,F=.5*j,U=F*g.log(j)-j*g.log(2)-a.gammaln(F),B=F-1,I=.25*j;O=j<=100?1:j<=800?.5:j<=5e3?.25:.125,U+=g.log(O);for(var P=0,V=1;V<=50;V++){for(var R=0,Q=(2*V-1)*O,de=1;de<=16;de++){var oe,be;8<de?(oe=de-8-1,be=U+B*g.log(Q+b[oe]*O)-(b[oe]*O+Q)*I):(oe=de-1,be=U+B*g.log(Q-b[oe]*O)+(b[oe]*O-Q)*I),be>=-30&&(R+=H(8<de?m*g.sqrt(.5*(b[oe]*O+Q)):m*g.sqrt(.5*(-b[oe]*O+Q)),1,C)*T[oe]*g.exp(be))}if(V*O>=1&&R<=1e-14)break;P+=R}if(R>1e-14)throw new Error("tukey.cdf failed to converge");return P>1&&(P=1),P},inv:function(m,f,j){if(j<2||f<2)return NaN;if(m<0||m>1)return NaN;if(m===0)return 0;if(m===1)return 1/0;var C,b=function(B,I,P){var V=.5-.5*B,R=g.sqrt(g.log(1/(V*V))),Q=R+((((-453642210148e-16*R-.204231210125)*R-.342242088547)*R-1)*R+.322232421088)/((((.0038560700634*R+.10353775285)*R+.531103462366)*R+.588581570495)*R+.099348462606);P<120&&(Q+=(Q*Q*Q+Q)/P/4);var de=.8832-.2368*Q;return P<120&&(de+=-1.214/P+1.208*Q/P),Q*(de*g.log(I-1)+1.4142)}(m,f,j),T=a.tukey.cdf(b,f,j)-m;C=T>0?g.max(0,b-1):b+1;for(var O,F=a.tukey.cdf(C,f,j)-m,U=1;U<50;U++)if(O=C-F*(C-b)/(F-T),T=F,b=C,O<0&&(O=0,F=-m),F=a.tukey.cdf(O,f,j)-m,C=O,g.abs(C-b)<1e-4)return O;throw new Error("tukey.inv failed to converge")}})}(c,Math),function(a,g){var D,H,m=Array.prototype.push,f=a.utils.isArray;function j(C){return f(C)||C instanceof a}a.extend({add:function(C,b){return j(b)?(j(b[0])||(b=[b]),a.map(C,function(T,O,F){return T+b[O][F]})):a.map(C,function(T){return T+b})},subtract:function(C,b){return j(b)?(j(b[0])||(b=[b]),a.map(C,function(T,O,F){return T-b[O][F]||0})):a.map(C,function(T){return T-b})},divide:function(C,b){return j(b)?(j(b[0])||(b=[b]),a.multiply(C,a.inv(b))):a.map(C,function(T){return T/b})},multiply:function(C,b){var T,O,F,U,B,I,P,V;if(C.length===void 0&&b.length===void 0)return C*b;if(B=C.length,I=C[0].length,P=a.zeros(B,F=j(b)?b[0].length:I),V=0,j(b)){for(;V<F;V++)for(T=0;T<B;T++){for(U=0,O=0;O<I;O++)U+=C[T][O]*b[O][V];P[T][V]=U}return B===1&&V===1?P[0][0]:P}return a.map(C,function(R){return R*b})},outer:function(C,b){return a.multiply(C.map(function(T){return[T]}),[b])},dot:function(C,b){j(C[0])||(C=[C]),j(b[0])||(b=[b]);for(var T,O,F=C[0].length===1&&C.length!==1?a.transpose(C):C,U=b[0].length===1&&b.length!==1?a.transpose(b):b,B=[],I=0,P=F.length,V=F[0].length;I<P;I++){for(B[I]=[],T=0,O=0;O<V;O++)T+=F[I][O]*U[I][O];B[I]=T}return B.length===1?B[0]:B},pow:function(C,b){return a.map(C,function(T){return g.pow(T,b)})},exp:function(C){return a.map(C,function(b){return g.exp(b)})},log:function(C){return a.map(C,function(b){return g.log(b)})},abs:function(C){return a.map(C,function(b){return g.abs(b)})},norm:function(C,b){var T=0,O=0;for(isNaN(b)&&(b=2),j(C[0])&&(C=C[0]);O<C.length;O++)T+=g.pow(g.abs(C[O]),b);return g.pow(T,1/b)},angle:function(C,b){return g.acos(a.dot(C,b)/(a.norm(C)*a.norm(b)))},aug:function(C,b){var T,O=[];for(T=0;T<C.length;T++)O.push(C[T].slice());for(T=0;T<O.length;T++)m.apply(O[T],b[T]);return O},inv:function(C){for(var b,T=C.length,O=C[0].length,F=a.identity(T,O),U=a.gauss_jordan(C,F),B=[],I=0;I<T;I++)for(B[I]=[],b=O;b<U[0].length;b++)B[I][b-O]=U[I][b];return B},det:function C(b){if(b.length===2)return b[0][0]*b[1][1]-b[0][1]*b[1][0];for(var T=0,O=0;O<b.length;O++){for(var F=[],U=1;U<b.length;U++){F[U-1]=[];for(var B=0;B<b.length;B++)B<O?F[U-1][B]=b[U][B]:B>O&&(F[U-1][B-1]=b[U][B])}var I=O%2?-1:1;T+=C(F)*b[0][O]*I}return T},gauss_elimination:function(C,b){var T,O,F,U,B=0,I=0,P=C.length,V=C[0].length,R=1,Q=0,de=[];for(T=(C=a.aug(C,b))[0].length,B=0;B<P;B++){for(O=C[B][B],I=B,U=B+1;U<V;U++)O<g.abs(C[U][B])&&(O=C[U][B],I=U);if(I!=B)for(U=0;U<T;U++)F=C[B][U],C[B][U]=C[I][U],C[I][U]=F;for(I=B+1;I<P;I++)for(R=C[I][B]/C[B][B],U=B;U<T;U++)C[I][U]=C[I][U]-R*C[B][U]}for(B=P-1;B>=0;B--){for(Q=0,I=B+1;I<=P-1;I++)Q+=de[I]*C[B][I];de[B]=(C[B][T-1]-Q)/C[B][B]}return de},gauss_jordan:function(C,b){var T,O,F,U=a.aug(C,b),B=U.length,I=U[0].length,P=0;for(O=0;O<B;O++){var V=O;for(F=O+1;F<B;F++)g.abs(U[F][O])>g.abs(U[V][O])&&(V=F);var R=U[O];for(U[O]=U[V],U[V]=R,F=O+1;F<B;F++)for(P=U[F][O]/U[O][O],T=O;T<I;T++)U[F][T]-=U[O][T]*P}for(O=B-1;O>=0;O--){for(P=U[O][O],F=0;F<O;F++)for(T=I-1;T>O-1;T--)U[F][T]-=U[O][T]*U[F][O]/P;for(U[O][O]/=P,T=B;T<I;T++)U[O][T]/=P}return U},triaUpSolve:function(C,b){var T,O=C[0].length,F=a.zeros(1,O)[0],U=!1;return b[0].length!=null&&(b=b.map(function(B){return B[0]}),U=!0),a.arange(O-1,-1,-1).forEach(function(B){T=a.arange(B+1,O).map(function(I){return F[I]*C[B][I]}),F[B]=(b[B]-a.sum(T))/C[B][B]}),U?F.map(function(B){return[B]}):F},triaLowSolve:function(C,b){var T,O=C[0].length,F=a.zeros(1,O)[0],U=!1;return b[0].length!=null&&(b=b.map(function(B){return B[0]}),U=!0),a.arange(O).forEach(function(B){T=a.arange(B).map(function(I){return C[B][I]*F[I]}),F[B]=(b[B]-a.sum(T))/C[B][B]}),U?F.map(function(B){return[B]}):F},lu:function(C){var b,T=C.length,O=a.identity(T),F=a.zeros(C.length,C[0].length);return a.arange(T).forEach(function(U){F[0][U]=C[0][U]}),a.arange(1,T).forEach(function(U){a.arange(U).forEach(function(B){b=a.arange(B).map(function(I){return O[U][I]*F[I][B]}),O[U][B]=(C[U][B]-a.sum(b))/F[B][B]}),a.arange(U,T).forEach(function(B){b=a.arange(U).map(function(I){return O[U][I]*F[I][B]}),F[U][B]=C[b.length][B]-a.sum(b)})}),[O,F]},cholesky:function(C){var b,T=C.length,O=a.zeros(C.length,C[0].length);return a.arange(T).forEach(function(F){b=a.arange(F).map(function(U){return g.pow(O[F][U],2)}),O[F][F]=g.sqrt(C[F][F]-a.sum(b)),a.arange(F+1,T).forEach(function(U){b=a.arange(F).map(function(B){return O[F][B]*O[U][B]}),O[U][F]=(C[F][U]-a.sum(b))/O[F][F]})}),O},gauss_jacobi:function(C,b,T,O){for(var F,U,B,I,P=0,V=0,R=C.length,Q=[],de=[],oe=[];P<R;P++)for(Q[P]=[],de[P]=[],oe[P]=[],V=0;V<R;V++)P>V?(Q[P][V]=C[P][V],de[P][V]=oe[P][V]=0):P<V?(de[P][V]=C[P][V],Q[P][V]=oe[P][V]=0):(oe[P][V]=C[P][V],Q[P][V]=de[P][V]=0);for(B=a.multiply(a.multiply(a.inv(oe),a.add(Q,de)),-1),U=a.multiply(a.inv(oe),b),F=T,I=a.add(a.multiply(B,T),U),P=2;g.abs(a.norm(a.subtract(I,F)))>O;)F=I,I=a.add(a.multiply(B,F),U),P++;return I},gauss_seidel:function(C,b,T,O){for(var F,U,B,I,P,V=0,R=C.length,Q=[],de=[],oe=[];V<R;V++)for(Q[V]=[],de[V]=[],oe[V]=[],F=0;F<R;F++)V>F?(Q[V][F]=C[V][F],de[V][F]=oe[V][F]=0):V<F?(de[V][F]=C[V][F],Q[V][F]=oe[V][F]=0):(oe[V][F]=C[V][F],Q[V][F]=de[V][F]=0);for(I=a.multiply(a.multiply(a.inv(a.add(oe,Q)),de),-1),B=a.multiply(a.inv(a.add(oe,Q)),b),U=T,P=a.add(a.multiply(I,T),B),V=2;g.abs(a.norm(a.subtract(P,U)))>O;)U=P,P=a.add(a.multiply(I,U),B),V+=1;return P},SOR:function(C,b,T,O,F){for(var U,B,I,P,V,R=0,Q=C.length,de=[],oe=[],be=[];R<Q;R++)for(de[R]=[],oe[R]=[],be[R]=[],U=0;U<Q;U++)R>U?(de[R][U]=C[R][U],oe[R][U]=be[R][U]=0):R<U?(oe[R][U]=C[R][U],de[R][U]=be[R][U]=0):(be[R][U]=C[R][U],de[R][U]=oe[R][U]=0);for(P=a.multiply(a.inv(a.add(be,a.multiply(de,F))),a.subtract(a.multiply(be,1-F),a.multiply(oe,F))),I=a.multiply(a.multiply(a.inv(a.add(be,a.multiply(de,F))),b),F),B=T,V=a.add(a.multiply(P,T),I),R=2;g.abs(a.norm(a.subtract(V,B)))>O;)B=V,V=a.add(a.multiply(P,B),I),R++;return V},householder:function(C){for(var b,T,O,F,U=C.length,B=C[0].length,I=0,P=[],V=[];I<U-1;I++){for(b=0,F=I+1;F<B;F++)b+=C[F][I]*C[F][I];for(b=(C[I+1][I]>0?-1:1)*g.sqrt(b),T=g.sqrt((b*b-C[I+1][I]*b)/2),(P=a.zeros(U,1))[I+1][0]=(C[I+1][I]-b)/(2*T),O=I+2;O<U;O++)P[O][0]=C[O][I]/(2*T);V=a.subtract(a.identity(U,B),a.multiply(a.multiply(P,a.transpose(P)),2)),C=a.multiply(V,a.multiply(C,V))}return C},QR:(D=a.sum,H=a.arange,function(C){var b,T,O,F=C.length,U=C[0].length,B=a.zeros(U,U);for(C=a.copy(C),T=0;T<U;T++){for(B[T][T]=g.sqrt(D(H(F).map(function(I){return C[I][T]*C[I][T]}))),b=0;b<F;b++)C[b][T]=C[b][T]/B[T][T];for(O=T+1;O<U;O++)for(B[T][O]=D(H(F).map(function(I){return C[I][T]*C[I][O]})),b=0;b<F;b++)C[b][O]=C[b][O]-C[b][T]*B[T][O]}return[C,B]}),lstsq:function(C,b){var T=!1;b[0].length===void 0&&(b=b.map(function(Q){return[Q]}),T=!0);var O=a.QR(C),F=O[0],U=O[1],B=C[0].length,I=a.slice(F,{col:{end:B}}),P=function(Q){var de=(Q=a.copy(Q)).length,oe=a.identity(de);return a.arange(de-1,-1,-1).forEach(function(be){a.sliceAssign(oe,{row:be},a.divide(a.slice(oe,{row:be}),Q[be][be])),a.sliceAssign(Q,{row:be},a.divide(a.slice(Q,{row:be}),Q[be][be])),a.arange(be).forEach(function(Ee){var ye=a.multiply(Q[Ee][be],-1),se=a.slice(Q,{row:Ee}),we=a.multiply(a.slice(Q,{row:be}),ye);a.sliceAssign(Q,{row:Ee},a.add(se,we));var qe=a.slice(oe,{row:Ee}),_e=a.multiply(a.slice(oe,{row:be}),ye);a.sliceAssign(oe,{row:Ee},a.add(qe,_e))})}),oe}(a.slice(U,{row:{end:B}})),V=a.transpose(I);V[0].length===void 0&&(V=[V]);var R=a.multiply(a.multiply(P,V),b);return R.length===void 0&&(R=[[R]]),T?R.map(function(Q){return Q[0]}):R},jacobi:function(C){for(var b,T,O,F,U,B,I,P=1,V=C.length,R=a.identity(V,V),Q=[];P===1;){for(U=C[0][1],O=0,F=1,b=0;b<V;b++)for(T=0;T<V;T++)b!=T&&U<g.abs(C[b][T])&&(U=g.abs(C[b][T]),O=b,F=T);for(B=C[O][O]===C[F][F]?C[O][F]>0?g.PI/4:-g.PI/4:g.atan(2*C[O][F]/(C[O][O]-C[F][F]))/2,(I=a.identity(V,V))[O][O]=g.cos(B),I[O][F]=-g.sin(B),I[F][O]=g.sin(B),I[F][F]=g.cos(B),R=a.multiply(R,I),C=a.multiply(a.multiply(a.inv(I),C),I),P=0,b=1;b<V;b++)for(T=1;T<V;T++)b!=T&&g.abs(C[b][T])>.001&&(P=1)}for(b=0;b<V;b++)Q.push(C[b][b]);return[R,Q]},rungekutta:function(C,b,T,O,F,U){var B,I,P;if(U===2)for(;O<=T;)F+=((B=b*C(O,F))+(I=b*C(O+b,F+B)))/2,O+=b;if(U===4)for(;O<=T;)F+=((B=b*C(O,F))+2*(I=b*C(O+b/2,F+B/2))+2*(P=b*C(O+b/2,F+I/2))+b*C(O+b,F+P))/6,O+=b;return F},romberg:function(C,b,T,O){for(var F,U,B,I,P,V=0,R=(T-b)/2,Q=[],de=[],oe=[];V<O/2;){for(P=C(b),B=b,I=0;B<=T;B+=R,I++)Q[I]=B;for(F=Q.length,B=1;B<F-1;B++)P+=(B%2!=0?4:2)*C(Q[B]);P=R/3*(P+C(T)),oe[V]=P,R/=2,V++}for(U=oe.length,F=1;U!==1;){for(B=0;B<U-1;B++)de[B]=(g.pow(4,F)*oe[B+1]-oe[B])/(g.pow(4,F)-1);U=de.length,oe=de,de=[],F++}return oe},richardson:function(C,b,T,O){function F(be,Ee){for(var ye,se=0,we=be.length;se<we;se++)be[se]===Ee&&(ye=se);return ye}for(var U,B,I,P,V,R=g.abs(T-C[F(C,T)+1]),Q=0,de=[],oe=[];O>=R;)U=F(C,T+O),B=F(C,T),de[Q]=(b[U]-2*b[B]+b[2*B-U])/(O*O),O/=2,Q++;for(P=de.length,I=1;P!=1;){for(V=0;V<P-1;V++)oe[V]=(g.pow(4,I)*de[V+1]-de[V])/(g.pow(4,I)-1);P=oe.length,de=oe,oe=[],I++}return de},simpson:function(C,b,T,O){for(var F,U=(T-b)/O,B=C(b),I=[],P=b,V=0,R=1;P<=T;P+=U,V++)I[V]=P;for(F=I.length;R<F-1;R++)B+=(R%2!=0?4:2)*C(I[R]);return U/3*(B+C(T))},hermite:function(C,b,T,O){for(var F,U=C.length,B=0,I=0,P=[],V=[],R=[],Q=[];I<U;I++){for(P[I]=1,F=0;F<U;F++)I!=F&&(P[I]*=(O-C[F])/(C[I]-C[F]));for(V[I]=0,F=0;F<U;F++)I!=F&&(V[I]+=1/(C[I]-C[F]));R[I]=(1-2*(O-C[I])*V[I])*(P[I]*P[I]),Q[I]=(O-C[I])*(P[I]*P[I]),B+=R[I]*b[I]+Q[I]*T[I]}return B},lagrange:function(C,b,T){for(var O,F,U=0,B=0,I=C.length;B<I;B++){for(F=b[B],O=0;O<I;O++)B!=O&&(F*=(T-C[O])/(C[B]-C[O]));U+=F}return U},cubic_spline:function(C,b,T){for(var O,F,U=C.length,B=0,I=[],P=[],V=[],R=[],Q=[],de=[];B<U-1;B++)R[B]=C[B+1]-C[B];for(V[0]=0,B=1;B<U-1;B++)V[B]=3/R[B]*(b[B+1]-b[B])-3/R[B-1]*(b[B]-b[B-1]);for(B=1;B<U-1;B++)I[B]=[],P[B]=[],I[B][B-1]=R[B-1],I[B][B]=2*(R[B-1]+R[B]),I[B][B+1]=R[B],P[B][0]=V[B];for(F=a.multiply(a.inv(I),P),O=0;O<U-1;O++)Q[O]=(b[O+1]-b[O])/R[O]-R[O]*(F[O+1][0]+2*F[O][0])/3,de[O]=(F[O+1][0]-F[O][0])/(3*R[O]);for(O=0;O<U&&!(C[O]>T);O++);return b[O-=1]+(T-C[O])*Q[O]+a.sq(T-C[O])*F[O]+(T-C[O])*a.sq(T-C[O])*de[O]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(C){var b,T,O,F,U,B=C.length,I=C[0].length,P=0,V=[],R=[],Q=[],de=[],oe=[],be=[],Ee=[];for(P=0;P<B;P++)V[P]=a.sum(C[P])/I;for(P=0;P<I;P++)for(oe[P]=[],b=0;b<B;b++)oe[P][b]=C[b][P]-V[b];for(oe=a.transpose(oe),P=0;P<B;P++)for(be[P]=[],b=0;b<B;b++)be[P][b]=a.dot([oe[P]],[oe[b]])/(I-1);for(U=(O=a.jacobi(be))[0],R=O[1],Ee=a.transpose(U),P=0;P<R.length;P++)for(b=P;b<R.length;b++)R[P]<R[b]&&(T=R[P],R[P]=R[b],R[b]=T,Q=Ee[P],Ee[P]=Ee[b],Ee[b]=Q);for(F=a.transpose(oe),P=0;P<B;P++)for(de[P]=[],b=0;b<F.length;b++)de[P][b]=a.dot([Ee[P]],[F[b]]);return[C,R,Ee,de]}}),function(C){for(var b=0;b<C.length;b++)(function(T){a.fn[T]=function(O,F){var U=this;return F?(setTimeout(function(){F.call(U,a.fn[T].call(U,O))},15),this):typeof a[T](this,O)=="number"?a[T](this,O):a(a[T](this,O))}})(C[b])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(c,Math),function(a,g){var D=[].slice,H=a.utils.isNumber,m=a.utils.isArray;function f(j,C,b,T){if(j>1||b>1||j<=0||b<=0)throw new Error("Proportions should be greater than 0 and less than 1");var O=(j*C+b*T)/(C+T);return(j-b)/g.sqrt(O*(1-O)*(1/C+1/T))}a.extend({zscore:function(){var j=D.call(arguments);return H(j[1])?(j[0]-j[1])/j[2]:(j[0]-a.mean(j[1]))/a.stdev(j[1],j[2])},ztest:function(){var j,C=D.call(arguments);return m(C[1])?(j=a.zscore(C[0],C[1],C[3]),C[2]===1?a.normal.cdf(-g.abs(j),0,1):2*a.normal.cdf(-g.abs(j),0,1)):C.length>2?(j=a.zscore(C[0],C[1],C[2]),C[3]===1?a.normal.cdf(-g.abs(j),0,1):2*a.normal.cdf(-g.abs(j),0,1)):(j=C[0],C[1]===1?a.normal.cdf(-g.abs(j),0,1):2*a.normal.cdf(-g.abs(j),0,1))}}),a.extend(a.fn,{zscore:function(j,C){return(j-this.mean())/this.stdev(C)},ztest:function(j,C,b){var T=g.abs(this.zscore(j,b));return C===1?a.normal.cdf(-T,0,1):2*a.normal.cdf(-T,0,1)}}),a.extend({tscore:function(){var j=D.call(arguments);return j.length===4?(j[0]-j[1])/(j[2]/g.sqrt(j[3])):(j[0]-a.mean(j[1]))/(a.stdev(j[1],!0)/g.sqrt(j[1].length))},ttest:function(){var j,C=D.call(arguments);return C.length===5?(j=g.abs(a.tscore(C[0],C[1],C[2],C[3])),C[4]===1?a.studentt.cdf(-j,C[3]-1):2*a.studentt.cdf(-j,C[3]-1)):H(C[1])?(j=g.abs(C[0]),C[2]==1?a.studentt.cdf(-j,C[1]-1):2*a.studentt.cdf(-j,C[1]-1)):(j=g.abs(a.tscore(C[0],C[1])),C[2]==1?a.studentt.cdf(-j,C[1].length-1):2*a.studentt.cdf(-j,C[1].length-1))}}),a.extend(a.fn,{tscore:function(j){return(j-this.mean())/(this.stdev(!0)/g.sqrt(this.cols()))},ttest:function(j,C){return C===1?1-a.studentt.cdf(g.abs(this.tscore(j)),this.cols()-1):2*a.studentt.cdf(-g.abs(this.tscore(j)),this.cols()-1)}}),a.extend({anovafscore:function(){var j,C,b,T,O,F,U,B,I=D.call(arguments);if(I.length===1){for(O=new Array(I[0].length),U=0;U<I[0].length;U++)O[U]=I[0][U];I=O}for(C=new Array,U=0;U<I.length;U++)C=C.concat(I[U]);for(b=a.mean(C),j=0,U=0;U<I.length;U++)j+=I[U].length*g.pow(a.mean(I[U])-b,2);for(j/=I.length-1,F=0,U=0;U<I.length;U++)for(T=a.mean(I[U]),B=0;B<I[U].length;B++)F+=g.pow(I[U][B]-T,2);return j/(F/(C.length-I.length))},anovaftest:function(){var j,C,b,T,O=D.call(arguments);if(H(O[0]))return 1-a.centralF.cdf(O[0],O[1],O[2]);var F=a.anovafscore(O);for(j=O.length-1,b=0,T=0;T<O.length;T++)b+=O[T].length;return C=b-j-1,1-a.centralF.cdf(F,j,C)},ftest:function(j,C,b){return 1-a.centralF.cdf(j,C,b)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var j,C=0;for(j=0;j<this.length;j++)C+=this[j].length;return a.ftest(this.anovafscore(),this.length-1,C-this.length)}}),a.extend({qscore:function(){var j,C,b,T,O,F=D.call(arguments);return H(F[0])?(j=F[0],C=F[1],b=F[2],T=F[3],O=F[4]):(j=a.mean(F[0]),C=a.mean(F[1]),b=F[0].length,T=F[1].length,O=F[2]),g.abs(j-C)/(O*g.sqrt((1/b+1/T)/2))},qtest:function(){var j,C=D.call(arguments);C.length===3?(j=C[0],C=C.slice(1)):C.length===7?(j=a.qscore(C[0],C[1],C[2],C[3],C[4]),C=C.slice(5)):(j=a.qscore(C[0],C[1],C[2]),C=C.slice(3));var b=C[0],T=C[1];return 1-a.tukey.cdf(j,T,b-T)},tukeyhsd:function(j){for(var C=a.pooledstdev(j),b=j.map(function(I){return a.mean(I)}),T=j.reduce(function(I,P){return I+P.length},0),O=[],F=0;F<j.length;++F)for(var U=F+1;U<j.length;++U){var B=a.qtest(b[F],b[U],j[F].length,j[U].length,C,T,j.length);O.push([[F,U],B])}return O}}),a.extend({normalci:function(){var j,C=D.call(arguments),b=new Array(2);return j=C.length===4?g.abs(a.normal.inv(C[1]/2,0,1)*C[2]/g.sqrt(C[3])):g.abs(a.normal.inv(C[1]/2,0,1)*a.stdev(C[2])/g.sqrt(C[2].length)),b[0]=C[0]-j,b[1]=C[0]+j,b},tci:function(){var j,C=D.call(arguments),b=new Array(2);return j=C.length===4?g.abs(a.studentt.inv(C[1]/2,C[3]-1)*C[2]/g.sqrt(C[3])):g.abs(a.studentt.inv(C[1]/2,C[2].length-1)*a.stdev(C[2],!0)/g.sqrt(C[2].length)),b[0]=C[0]-j,b[1]=C[0]+j,b},significant:function(j,C){return j<C}}),a.extend(a.fn,{normalci:function(j,C){return a.normalci(j,C,this.toArray())},tci:function(j,C){return a.tci(j,C,this.toArray())}}),a.extend(a.fn,{oneSidedDifferenceOfProportions:function(j,C,b,T){var O=f(j,C,b,T);return a.ztest(O,1)},twoSidedDifferenceOfProportions:function(j,C,b,T){var O=f(j,C,b,T);return a.ztest(O,2)}})}(c,Math),c.models=function(){function a(g,D){var H=g.length,m=D[0].length-1,f=H-m-1,j=c.lstsq(D,g),C=c.multiply(D,j.map(function(B){return[B]})).map(function(B){return B[0]}),b=c.subtract(g,C),T=c.mean(g),O=c.sum(C.map(function(B){return Math.pow(B-T,2)})),F=c.sum(g.map(function(B,I){return Math.pow(B-C[I],2)})),U=O+F;return{exog:D,endog:g,nobs:H,df_model:m,df_resid:f,coef:j,predict:C,resid:b,ybar:T,SST:U,SSE:O,SSR:F,R2:O/U}}return{ols:function(g,D){var H=a(g,D),m=function(C){var b,T,O=(b=C.exog,T=b[0].length,c.arange(T).map(function(R){var Q=c.arange(T).filter(function(de){return de!==R});return a(c.col(b,R).map(function(de){return de[0]}),c.col(b,Q))})),F=Math.sqrt(C.SSR/C.df_resid),U=O.map(function(R){var Q=R.SST,de=R.R2;return F/Math.sqrt(Q*(1-de))}),B=C.coef.map(function(R,Q){return(R-0)/U[Q]}),I=B.map(function(R){var Q=c.studentt.cdf(R,C.df_resid);return 2*(Q>.5?1-Q:Q)}),P=c.studentt.inv(.975,C.df_resid),V=C.coef.map(function(R,Q){var de=P*U[Q];return[R-de,R+de]});return{se:U,t:B,p:I,sigmaHat:F,interval95:V}}(H),f=function(C){var b,T,O,F=C.R2/C.df_model/((1-C.R2)/C.df_resid);return{F_statistic:F,pvalue:1-(b=F,T=C.df_model,O=C.df_resid,c.beta.cdf(b/(O/T+b),T/2,O/2))}}(H),j=1-(1-H.R2)*((H.nobs-1)/H.df_resid);return H.t=m,H.f=f,H.adjust_R2=j,H}}}(),c.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),g=0;g<arguments.length;g++)a[g]=[1].concat(arguments[g]);return c(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),g=0;g<arguments[0].length;g++)a[g]=[1].concat(arguments[0][g]);return c(a)},buildjxmatrix:function(a){for(var g=new Array(a.length),D=0;D<a.length;D++)g[D]=a[D];return c.builddxmatrix(g)},buildymatrix:function(a){return c(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,g){var D,H,m,f,j;if(a.cols()==g.rows()){if(g.rows()>1){for(f=[],D=0;D<a.rows();D++)for(f[D]=[],H=0;H<g.cols();H++){for(j=0,m=0;m<a.cols();m++)j+=a.toArray()[D][m]*g.toArray()[m][H];f[D][H]=j}return c(f)}for(f=[],D=0;D<a.rows();D++)for(f[D]=[],H=0;H<g.cols();H++){for(j=0,m=0;m<a.cols();m++)j+=a.toArray()[D][m]*g.toArray()[H];f[D][H]=j}return c(f)}},regress:function(a,g){var D=c.xtranspxinv(a),H=a.transpose(),m=c.matrixmult(c(D),H);return c.matrixmult(m,g)},regresst:function(a,g,D){var H=c.regress(a,g),m={anova:{}},f=c.jMatYBar(a,H);m.yBar=f;var j=g.mean();m.anova.residuals=c.residuals(g,f),m.anova.ssr=c.ssr(f,j),m.anova.msr=m.anova.ssr/(a[0].length-1),m.anova.sse=c.sse(g,f),m.anova.mse=m.anova.sse/(g.length-(a[0].length-1)-1),m.anova.sst=c.sst(g,j),m.anova.mst=m.anova.sst/(g.length-1),m.anova.r2=1-m.anova.sse/m.anova.sst,m.anova.r2<0&&(m.anova.r2=0),m.anova.fratio=m.anova.msr/m.anova.mse,m.anova.pvalue=c.anovaftest(m.anova.fratio,a[0].length-1,g.length-(a[0].length-1)-1),m.anova.rmse=Math.sqrt(m.anova.mse),m.anova.r2adj=1-m.anova.mse/m.anova.mst,m.anova.r2adj<0&&(m.anova.r2adj=0),m.stats=new Array(a[0].length);for(var C,b,T,O=c.xtranspxinv(a),F=0;F<H.length;F++)C=Math.sqrt(m.anova.mse*Math.abs(O[F][F])),b=Math.abs(H[F]/C),T=c.ttest(b,g.length-a[0].length-1,D),m.stats[F]=[H[F],C,b,T];return m.regress=H,m},xtranspx:function(a){return c.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var g=c.matrixmult(a.transpose(),a);return c.inv(g)},jMatYBar:function(a,g){var D=c.matrixmult(a,g);return new c(D)},residuals:function(a,g){return c.matrixsubtract(a,g)},ssr:function(a,g){for(var D=0,H=0;H<a.length;H++)D+=Math.pow(a[H]-g,2);return D},sse:function(a,g){for(var D=0,H=0;H<a.length;H++)D+=Math.pow(a[H]-g[H],2);return D},sst:function(a,g){for(var D=0,H=0;H<a.length;H++)D+=Math.pow(a[H]-g,2);return D},matrixsubtract:function(a,g){for(var D=new Array(a.length),H=0;H<a.length;H++){D[H]=new Array(a[H].length);for(var m=0;m<a[H].length;m++)D[H][m]=a[H][m]-g[H][m]}return c(D)}}),c.jStat=c,c)},960:function(L,c,a){const g=a(592);L.exports=function(D){function H(F,U){const B=U.split(".");let I=F;for(const P of B){if(I==null)return;I=I[P]}return I}for(let F=0;F<Object.keys(g).length;F++){let U,B=Object.keys(g)[F],I=[];if(typeof g[B]=="object"){I=Object.keys(g[B]),U=Object.values(g[B]);for(let P=0;P<U.length;P++)if(typeof U[P]=="object"){let V=I[P];g[B][V]&&(I=[...I,...Object.keys(g[B][V]).map(R=>V+"."+R)],I.splice(I.indexOf(V),1))}}if(I.length<1)D[B]=g[B];else for(let P=0;P<I.length;P++)typeof H(g[B],I[P])=="function"&&(D[B]=H(g[B],I[P]))}let m=function(F){return typeof F=="number"&&(F=parseInt(F)),F},f=null,j=null,C=null;D.TABLE=function(){return C},D.COLUMN=D.COL=function(){return C.tracking&&C.tracking.push(O.getColumnNameFromCoords(m(f),m(j))),m(f)+1},D.ROW=function(){return C.tracking&&C.tracking.push(O.getColumnNameFromCoords(m(f),m(j))),m(j)+1},D.CELL=function(){return O.getColumnNameFromCoords(f,j)},D.VALUE=function(F,U,B){return C.getValueFromCoords(m(F)-1,m(U)-1,B)},D.THISROWCELL=function(F){return C.getValueFromCoords(m(F)-1,m(j))};const b=function(F,U){for(let B=0;B<F.length;B++){let I=O.getTokensFromRange(F[B]);U=U.replace(F[B],"["+I.join(",")+"]")}return U},T=function(F){return typeof F=="string"&&(F=F.trim()),!isNaN(F)&&F!==null&&F!==""},O=function(F,U,B,I,P){C=P,f=B,j=I;let V="",R={};if(U)if(U.size){let oe,be=null;U.forEach(function(Ee,ye){oe=ye.replace(/!/g,"."),oe.indexOf(".")!==-1&&(oe=oe.split("."),R[oe[0]]=!0)}),oe=Object.keys(R);for(let Ee=0;Ee<oe.length;Ee++)V+="var "+oe[Ee]+" = {};";U.forEach(function(Ee,ye){oe=ye.replace(/!/g,"."),Ee===null||T(Ee)||(be=Ee.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),be&&be.length&&(Ee=updateRanges(be,Ee))),oe.indexOf(".")>0?V+=oe+" = "+U.get(ye)+`;
`:V+="var "+oe+" = "+Ee+`;
`})}else{let oe=Object.keys(U);if(oe.length){let be,Ee={};for(let ye=0;ye<oe.length;ye++)if(be=oe[ye].replace(/\!/g,"."),be.indexOf(".")>0){let se=se.split(".");Ee[se[0]]={}}be=Object.keys(Ee);for(let ye=0;ye<be.length;ye++)V+="var "+be[ye]+" = {};";for(let ye=0;ye<oe.length;ye++){if(be=oe[ye].replace(/!/g,"."),U[oe[ye]]!==null&&!T(U[oe[ye]])){let se=U[oe[ye]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(U[oe[ye]]=b(se,U[oe[ye]]))}be.indexOf(".")>0?V+=be+" = "+U[oe[ye]]+`;
`:V+="var "+be+" = "+U[oe[ye]]+`;
`}}}let Q=(F=function(oe,be){let Ee="",ye=0,se=["=","!",">","<"];for(let we=0;we<oe.length;we++)oe[we]==='"'&&(ye=ye===0?1:0),ye===1?Ee+=oe[we]:(Ee+=oe[we].toUpperCase(),we>0&&oe[we]==="="&&se.indexOf(oe[we-1])===-1&&se.indexOf(oe[we+1])===-1&&(Ee+="="));return Ee=Ee.replace(/\^/g,"**"),Ee=Ee.replace(/<>/g,"!="),Ee=Ee.replace(/&/g,"+"),Ee=Ee.replace(/\$/g,""),Ee}(F=(F=F.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);Q&&Q.length&&(F=b(Q,F));let de=new Function(V+"; return "+F)();return de===null&&(de=0),de};return O.getColumnNameFromCoords=function(F,U){return I="",(B=parseInt(F))>701?(I+=String.fromCharCode(64+parseInt(B/676)),I+=String.fromCharCode(64+parseInt(B%676/26))):B>25&&(I+=String.fromCharCode(64+parseInt(B/26))),I+String.fromCharCode(65+B%26)+(parseInt(U)+1);var B,I},O.getCoordsFromColumnName=function(F){var U=/^[a-zA-Z]+/.exec(F);if(U){for(var B=0,I=0;I<U[0].length;I++)B+=parseInt(U[0].charCodeAt(I)-64)*Math.pow(26,U[0].length-1-I);--B<0&&(B=0);var P=parseInt(/[0-9]+$/.exec(F))||null;return P>0&&P--,[B,P]}},O.getRangeFromTokens=function(F){F=F.filter(function(P){return P!="#REF!"});for(var U="",B="",I=0;I<F.length;I++)F[I].indexOf(".")>=0?U=".":F[I].indexOf("!")>=0&&(U="!"),U&&(B=F[I].split(U),F[I]=B[1],B=B[0]+U);return F.sort(function(P,V){var R=Helpers.getCoordsFromColumnName(P),Q=Helpers.getCoordsFromColumnName(V);return R[1]>Q[1]?1:R[1]<Q[1]?-1:R[0]>Q[0]?1:R[0]<Q[0]?-1:0}),F.length?B+(F[0]+":")+F[F.length-1]:"#REF!"},O.getTokensFromRange=function(F){if(F.indexOf(".")>0){var U=F.split(".");F=U[1],U=U[0]+"."}else F.indexOf("!")>0?(U=F.split("!"),F=U[1],U=U[0]+"!"):U="";F=F.split(":");var B=O.getCoordsFromColumnName(F[0]),I=O.getCoordsFromColumnName(F[1]);if(B[0]<=I[0])var P=B[0],V=I[0];else P=I[0],V=B[0];if(B[1]===null&&I[1]==null)for(var R=null,Q=null,de=Object.keys(vars),oe=0;oe<de.length;oe++){var be=O.getCoordsFromColumnName(de[oe]);be[0]===B[0]&&(R===null||be[1]<R)&&(R=be[1]),be[0]===I[0]&&(Q===null||be[1]>Q)&&(Q=be[1])}else B[1]<=I[1]?(R=B[1],Q=I[1]):(R=I[1],Q=B[1]);for(var Ee=[],ye=R;ye<=Q;ye++){var se=[];for(oe=P;oe<=V;oe++)se.push(U+O.getColumnNameFromCoords(oe,ye));Ee.push(se)}return Ee},O.setFormula=function(F){let U=Object.keys(F);for(let B=0;B<U.length;B++)typeof F[U[B]]=="function"&&(D[U[B]]=F[U[B]])},O.basic=!0,O}(typeof window>"u"?a.g:window)},592:function(L,c,a){var g=a(162),D=a(765);const H=new Error("#NULL!"),m=new Error("#DIV/0!"),f=new Error("#VALUE!"),j=new Error("#REF!"),C=new Error("#NAME?"),b=new Error("#NUM!"),T=new Error("#N/A"),O=new Error("#ERROR!"),F=new Error("#GETTING_DATA");var U=Object.freeze({__proto__:null,data:F,div0:m,error:O,na:T,name:C,nil:H,num:b,ref:j,value:f});function B(t){const r=[];return I(t,u=>{r.push(u)}),r}function I(t,r){let u=-1;const v=t.length;for(;++u<v&&r(t[u],u,t)!==!1;);return t}function P(t){let r,u=t.length;for(;u--;)if(r=t[u],typeof r!="number")if(r!==!0)if(r!==!1){if(typeof r=="string"){const v=z(r);t[u]=v instanceof Error?0:v}}else t[u]=0;else t[u]=1;return t}function V(t,r){if(!t)return f;t.every(N=>Array.isArray(N))&&t.length!==0||(t=[[...t]]),t.map((N,q)=>{N.map((X,ue)=>{X||(t[q][ue]=0)})});const u=t.reduce((N,q,X)=>q.length>t[N].length?X:N,0),v=t[u].length;return t.map(N=>[...N,...Array(v-N.length).fill(r||0)])}function R(){let t;if(arguments.length===1){const u=arguments[0];t=(r=u)!=null&&typeof r.length=="number"&&typeof r!="string"?B.apply(null,arguments):[u]}else t=Array.from(arguments);for(var r;!de(t);)t=Q(t);return t}function Q(t){return t&&t.reduce?t.reduce((r,u)=>{const v=Array.isArray(r),N=Array.isArray(u);return v&&N?r.concat(u):v?(r.push(u),r):N?[r].concat(u):[r,u]}):[t]}function de(t){if(!t)return!1;for(let r=0;r<t.length;++r)if(Array.isArray(t[r]))return!1;return!0}function oe(t,r){return r=r||1,t&&typeof t.slice=="function"?t.slice(r):t}function be(t){return t?t[0].map((r,u)=>t.map(v=>v[u])):f}function Ee(t,r){let u=null;return I(t,(v,N)=>{if(v[0]===r)return u=N,!1}),u??f}function ye(){for(let t=0;t<arguments.length;t++)if(arguments[t]instanceof Error)return arguments[t]}function se(){let t=arguments.length;for(;t--;)if(arguments[t]instanceof Error)return!0;return!1}function we(t){return Math.round(t*1e14)/1e14}function qe(){return R.apply(null,arguments).filter(t=>typeof t=="number")}function _e(t){if(typeof t=="boolean"||t instanceof Error)return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){const r=t.toUpperCase();if(r==="TRUE")return!0;if(r==="FALSE")return!1}return t instanceof Date&&!isNaN(t)||f}function Xe(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);const r=parseFloat(t);return r<0||r>=2958466?b:function(u){u<60&&(u+=1);const v=Math.floor(u-25569),N=new Date(86400*v*1e3),q=u-Math.floor(u)+1e-7;let X=Math.floor(86400*q);const ue=X%60;X-=ue;const je=Math.floor(X/3600),ke=Math.floor(X/60)%60;let $e=N.getUTCDate(),ot=N.getUTCMonth();return u>=60&&u<61&&($e=29,ot=1),new Date(N.getUTCFullYear(),ot,$e,je,ke,ue)}(r)}return typeof t!="string"||(t=/(\d{4})-(\d\d?)-(\d\d?)$/.test(t)?new Date(t+"T00:00:00.000"):new Date(t),isNaN(t))?f:t}function at(t){let r,u=t.length;for(;u--;){if(r=Xe(t[u]),r===f)return r;t[u]=r}return t}function z(t){return t instanceof Error?t:t==null?0:(typeof t=="boolean"&&(t=+t),isNaN(t)||t===""?f:parseFloat(t))}function Le(t){let r,u;if(!t||(r=t.length)===0)return f;for(;r--;){if(t[r]instanceof Error)return t[r];if(u=z(t[r]),u instanceof Error)return u;t[r]=u}return t}function Qe(t){return t instanceof Error?t:t==null?"":t.toString()}function ft(){let t=arguments.length;for(;t--;)if(typeof arguments[t]=="string")return!0;return!1}function Ie(t){return t!=null}const Oe="=",Ye=[">",">=","<","<=","=","<>"],Fe="operator",Ke="literal",tt=[Fe,Ke],ct=Fe,te=Ke;function ce(t,r){if(tt.indexOf(r)===-1)throw new Error("Unsupported token type: "+r);return{value:t,type:r}}function ve(t){return function(r){let u="";const v=[];for(let N=0;N<r.length;N++){const q=r[N];N===0&&Ye.indexOf(q)>=0?v.push(ce(q,ct)):u+=q}return u.length>0&&v.push(ce(function(N){return typeof N!="string"||/^\d+(\.\d+)?$/.test(N)&&(N=N.indexOf(".")===-1?parseInt(N,10):parseFloat(N)),N}(u),te)),v.length>0&&v[0].type!==ct&&v.unshift(ce(Oe,ct)),v}(function(r){const u=r.length,v=[];let N=0,q="",X="";for(;N<u;){const ue=r.charAt(N);switch(ue){case">":case"<":case"=":X+=ue,q.length>0&&(v.push(q),q="");break;default:X.length>0&&(v.push(X),X=""),q+=ue}N++}return q.length>0&&v.push(q),X.length>0&&v.push(X),v}(t))}const Ce=function(t){const r=[];let u;for(let v=0;v<t.length;v++){const N=t[v];switch(N.type){case ct:u=N.value;break;case te:r.push(N.value)}}return function(v,N){let q=!1;switch(N){case">":q=v[0]>v[1];break;case">=":q=v[0]>=v[1];break;case"<":q=v[0]<v[1];break;case"<=":q=v[0]<=v[1];break;case"=":q=v[0]==v[1];break;case"<>":q=v[0]!=v[1]}return q}(r,u)},Se={};function Be(t){return[f,j,m,b,C,H].indexOf(t)>=0||typeof t=="number"&&(isNaN(t)||!isFinite(t))}function Pe(t){return Be(t)||t===T}function Ve(t){return t===!0||t===!1}function Ue(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function E(t){return typeof t=="string"}function M(){const t=[];for(let r=0;r<arguments.length;++r){let u=!1;const v=arguments[r];for(let N=0;N<t.length&&(u=t[N]===v,!u);++N);u||t.push(v)}return t}function d(t,r,u,v){if(!r||!u)return T;v=!(v===0||v===!1);let N=T;const q=typeof t=="number";let X=!1;for(let ue=0;ue<r.length;ue++){const je=r[ue];if(je[0]===t){N=u<je.length+1?je[u-1]:j;break}!X&&(q&&v&&je[0]<=t||v&&typeof je[0]=="string"&&je[0].localeCompare(t)<0)&&(N=u<je.length+1?je[u-1]:j),q&&je[0]>t&&(X=!0)}return N}function l(){const t=R(arguments).filter(Ie);if(t.length===0)return m;const r=ye.apply(void 0,t);if(r)return r;const u=qe(t),v=u.length;let N,q=0,X=0;for(let ue=0;ue<v;ue++)q+=u[ue],X+=1;return N=q/X,isNaN(N)&&(N=b),N}function _(){const t=R(arguments).filter(Ie);if(t.length===0)return m;const r=ye.apply(void 0,t);if(r)return r;const u=t,v=u.length;let N,q=0,X=0;for(let ue=0;ue<v;ue++){const je=u[ue];typeof je=="number"&&(q+=je),je===!0&&q++,je!==null&&X++}return N=q/X,isNaN(N)&&(N=b),N}Se.TYPE=t=>{switch(t){case H:return 1;case m:return 2;case f:return 3;case j:return 4;case C:return 5;case b:return 6;case T:return 7;case F:return 8}return T};const G={DIST:function(t,r,u,v,N,q){return arguments.length<4?f:(N=N===void 0?0:N,q=q===void 0?1:q,se(t=z(t),r=z(r),u=z(u),N=z(N),q=z(q))?f:(t=(t-N)/(q-N),v?g.beta.cdf(t,r,u):g.beta.pdf(t,r,u)))},INV:(t,r,u,v,N)=>(v=v===void 0?0:v,N=N===void 0?1:N,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N))?f:g.beta.inv(t,r,u)*(N-v)+v)},ne={DIST:(t,r,u,v)=>se(t=z(t),r=z(r),u=z(u),v=z(v))?f:v?g.binomial.cdf(t,r,u):g.binomial.pdf(t,r,u)};ne.DIST.RANGE=(t,r,u,v)=>{if(v=v===void 0?u:v,se(t=z(t),r=z(r),u=z(u),v=z(v)))return f;let N=0;for(let q=u;q<=v;q++)N+=jt(t,q)*Math.pow(r,q)*Math.pow(1-r,t-q);return N},ne.INV=(t,r,u)=>{if(se(t=z(t),r=z(r),u=z(u)))return f;let v=0;for(;v<=t;){if(g.binomial.cdf(v,t,r)>=u)return v;v++}};const k={DIST:(t,r,u)=>se(t=z(t),r=z(r))?f:u?g.chisquare.cdf(t,r):g.chisquare.pdf(t,r)};k.DIST.RT=(t,r)=>!t|!r?T:t<1||r>Math.pow(10,10)?b:typeof t!="number"||typeof r!="number"?f:1-g.chisquare.cdf(t,r),k.INV=(t,r)=>se(t=z(t),r=z(r))?f:g.chisquare.inv(t,r),k.INV.RT=(t,r)=>!t|!r?T:t<0||t>1||r<1||r>Math.pow(10,10)?b:typeof t!="number"||typeof r!="number"?f:g.chisquare.inv(1-t,r),k.TEST=function(t,r){if(arguments.length!==2)return T;if(!(t instanceof Array&&r instanceof Array)||t.length!==r.length||t[0]&&r[0]&&t[0].length!==r[0].length)return f;const u=t.length;let v,N,q;for(N=0;N<u;N++)t[N]instanceof Array||(v=t[N],t[N]=[],t[N].push(v)),r[N]instanceof Array||(v=r[N],r[N]=[],r[N].push(v));const X=t[0].length,ue=X===1?u-1:(u-1)*(X-1);let je=0;const ke=Math.PI;for(N=0;N<u;N++)for(q=0;q<X;q++)je+=Math.pow(t[N][q]-r[N][q],2)/r[N][q];return Math.round(1e6*function($e,ot){let et=Math.exp(-.5*$e);ot%2==1&&(et*=Math.sqrt(2*$e/ke));let lt=ot;for(;lt>=2;)et=et*$e/lt,lt-=2;let pt=et,gt=ot;for(;pt>1e-10*et;)gt+=2,pt=pt*$e/gt,et+=pt;return 1-et}(je,ue))/1e6};const S={};function Y(){return qe(R(arguments)).length}function J(){const t=R(arguments);return t.length-ie(t)}function ie(){const t=R(arguments);let r,u=0;for(let v=0;v<t.length;v++)r=t[v],r!=null&&r!==""||u++;return u}S.NORM=(t,r,u)=>se(t=z(t),r=z(r),u=z(u))?f:g.normalci(1,t,r,u)[1]-1,S.T=(t,r,u)=>se(t=z(t),r=z(r),u=z(u))?f:g.tci(1,t,r,u)[1]-1;const xe={P:(t,r)=>{if(se(t=Le(R(t)),r=Le(R(r))))return f;const u=g.mean(t),v=g.mean(r);let N=0;const q=t.length;for(let X=0;X<q;X++)N+=(t[X]-u)*(r[X]-v);return N/q},S:(t,r)=>se(t=Le(R(t)),r=Le(R(r)))?f:g.covariance(t,r)},ge={DIST:(t,r,u)=>se(t=z(t),r=z(r))?f:u?g.exponential.cdf(t,r):g.exponential.pdf(t,r)},fe={};function Re(t,r,u){if(se(t=z(t),r=Le(R(r)),u=Le(R(u))))return f;const v=g.mean(u),N=g.mean(r),q=u.length;let X=0,ue=0;for(let ke=0;ke<q;ke++)X+=(u[ke]-v)*(r[ke]-N),ue+=Math.pow(u[ke]-v,2);const je=X/ue;return N-je*v+je*t}function We(t){return(t=z(t))instanceof Error?t:t===0||parseInt(t,10)===t&&t<0?b:g.gammafn(t)}function Je(t){return(t=z(t))instanceof Error?t:g.gammaln(t)}fe.DIST=(t,r,u,v)=>se(t=z(t),r=z(r),u=z(u))?f:v?g.centralF.cdf(t,r,u):g.centralF.pdf(t,r,u),fe.DIST.RT=function(t,r,u){return arguments.length!==3?T:t<0||r<1||u<1?b:typeof t!="number"||typeof r!="number"||typeof u!="number"?f:1-g.centralF.cdf(t,r,u)},fe.INV=(t,r,u)=>se(t=z(t),r=z(r),u=z(u))?f:t<=0||t>1?b:g.centralF.inv(t,r,u),fe.INV.RT=function(t,r,u){return arguments.length!==3?T:t<0||t>1||r<1||r>Math.pow(10,10)||u<1||u>Math.pow(10,10)?b:typeof t!="number"||typeof r!="number"||typeof u!="number"?f:g.centralF.inv(1-t,r,u)},fe.TEST=(t,r)=>{if(!t||!r||!(t instanceof Array&&r instanceof Array))return T;if(t.length<2||r.length<2)return m;const u=(q,X)=>{let ue=0;for(let je=0;je<q.length;je++)ue+=Math.pow(q[je]-X,2);return ue},v=It(t)/t.length,N=It(r)/r.length;return u(t,v)/(t.length-1)/(u(r,N)/(r.length-1))},We.DIST=function(t,r,u,v){return arguments.length!==4?T:t<0||r<=0||u<=0||typeof t!="number"||typeof r!="number"||typeof u!="number"?f:v?g.gamma.cdf(t,r,u,!0):g.gamma.pdf(t,r,u,!1)},We.INV=function(t,r,u){return arguments.length!==3?T:t<0||t>1||r<=0||u<=0?b:typeof t!="number"||typeof r!="number"||typeof u!="number"?f:g.gamma.inv(t,r,u)},Je.PRECISE=function(t){return arguments.length!==1?T:t<=0?b:typeof t!="number"?f:g.gammaln(t)};const Me={};function ze(t,r){return se(t=Le(R(t)),r=z(r))?t:r<0||t.length<r?f:t.sort((u,v)=>v-u)[r-1]}function pe(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;const u=g.mean(t),v=g.mean(r),N=r.length;let q=0,X=0;for(let je=0;je<N;je++)q+=(r[je]-v)*(t[je]-u),X+=Math.pow(r[je]-v,2);const ue=q/X;return[ue,u-ue*v]}Me.DIST=(t,r,u,v,N)=>{if(se(t=z(t),r=z(r),u=z(u),v=z(v)))return f;function q(X,ue,je,ke){return jt(je,X)*jt(ke-je,ue-X)/jt(ke,ue)}return N?function(X,ue,je,ke){let $e=0;for(let ot=0;ot<=X;ot++)$e+=q(ot,ue,je,ke);return $e}(t,r,u,v):q(t,r,u,v)};const He={};function Z(){const t=R(arguments),r=ye.apply(void 0,t);if(r)return r;const u=qe(t);return u.length===0?0:Math.max.apply(Math,u)}function K(){const t=R(arguments),r=ye.apply(void 0,t);if(r)return r;const u=P(t);let v=g.median(u);return isNaN(v)&&(v=b),v}function ae(){const t=R(arguments),r=ye.apply(void 0,t);if(r)return r;const u=qe(t);return u.length===0?0:Math.min.apply(Math,u)}He.DIST=(t,r,u,v)=>se(t=z(t),r=z(r),u=z(u))?f:v?g.lognormal.cdf(t,r,u):g.lognormal.pdf(t,r,u),He.INV=(t,r,u)=>se(t=z(t),r=z(r),u=z(u))?f:g.lognormal.inv(t,r,u);const A={MULT:function(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=t.length,u={};let v,N=[],q=0;for(let X=0;X<r;X++)v=t[X],u[v]=u[v]?u[v]+1:1,u[v]>q&&(q=u[v],N=[]),u[v]===q&&(N[N.length]=v);return N},SNGL:function(){const t=Le(R(arguments));return t instanceof Error?t:A.MULT(t).sort((r,u)=>r-u)[0]}},W={DIST:(t,r,u,v)=>se(t=z(t),r=z(r),u=z(u))?f:v?g.negbin.cdf(t,r,u):g.negbin.pdf(t,r,u)},ee={};function me(t,r){if(se(r=Le(R(r)),t=Le(R(t))))return f;const u=g.mean(t),v=g.mean(r),N=t.length;let q=0,X=0,ue=0;for(let je=0;je<N;je++)q+=(t[je]-u)*(r[je]-v),X+=Math.pow(t[je]-u,2),ue+=Math.pow(r[je]-v,2);return q/Math.sqrt(X*ue)}ee.DIST=(t,r,u,v)=>se(t=z(t),r=z(r),u=z(u))?f:u<=0?b:v?g.normal.cdf(t,r,u):g.normal.pdf(t,r,u),ee.INV=(t,r,u)=>se(t=z(t),r=z(r),u=z(u))?f:g.normal.inv(t,r,u),ee.S={},ee.S.DIST=(t,r)=>(t=z(t))instanceof Error?f:r?g.normal.cdf(t,0,1):g.normal.pdf(t,0,1),ee.S.INV=t=>(t=z(t))instanceof Error?f:g.normal.inv(t,0,1);const re={EXC:(t,r)=>{if(se(t=Le(R(t)),r=z(r)))return f;const u=(t=t.sort((q,X)=>q-X)).length;if(r<1/(u+1)||r>1-1/(u+1))return b;const v=r*(u+1)-1,N=Math.floor(v);return we(v===N?t[v]:t[N]+(v-N)*(t[N+1]-t[N]))},INC:(t,r)=>{if(se(t=Le(R(t)),r=z(r)))return f;const u=r*((t=t.sort((N,q)=>N-q)).length-1),v=Math.floor(u);return we(u===v?t[u]:t[v]+(u-v)*(t[v+1]-t[v]))}},he={EXC:(t,r,u)=>{if(u=u===void 0?3:u,se(t=Le(R(t)),r=z(r),u=z(u)))return f;t=t.sort(($e,ot)=>$e-ot);const v=M.apply(null,t),N=t.length,q=v.length,X=Math.pow(10,u);let ue=0,je=!1,ke=0;for(;!je&&ke<q;)r===v[ke]?(ue=(t.indexOf(v[ke])+1)/(N+1),je=!0):r>=v[ke]&&(r<v[ke+1]||ke===q-1)&&(ue=(t.indexOf(v[ke])+1+(r-v[ke])/(v[ke+1]-v[ke]))/(N+1),je=!0),ke++;return Math.floor(ue*X)/X},INC:(t,r,u)=>{if(u=u===void 0?3:u,se(t=Le(R(t)),r=z(r),u=z(u)))return f;t=t.sort(($e,ot)=>$e-ot);const v=M.apply(null,t),N=t.length,q=v.length,X=Math.pow(10,u);let ue=0,je=!1,ke=0;for(;!je&&ke<q;)r===v[ke]?(ue=t.indexOf(v[ke])/(N-1),je=!0):r>=v[ke]&&(r<v[ke+1]||ke===q-1)&&(ue=(t.indexOf(v[ke])+(r-v[ke])/(v[ke+1]-v[ke]))/(N-1),je=!0),ke++;return Math.floor(ue*X)/X}},Te={DIST:(t,r,u)=>se(t=z(t),r=z(r))?f:u?g.poisson.cdf(t,r):g.poisson.pdf(t,r)},Ge={EXC:(t,r)=>{if(se(t=Le(R(t)),r=z(r)))return f;switch(r){case 1:return re.EXC(t,.25);case 2:return re.EXC(t,.5);case 3:return re.EXC(t,.75);default:return b}},INC:(t,r)=>{if(se(t=Le(R(t)),r=z(r)))return f;switch(r){case 1:return re.INC(t,.25);case 2:return re.INC(t,.5);case 3:return re.INC(t,.75);default:return b}}},De={};function Ze(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=g.mean(t),u=t.length;let v=0;for(let N=0;N<u;N++)v+=Math.pow(t[N]-r,3);return u*v/((u-1)*(u-2)*Math.pow(g.stdev(t,!0),3))}function it(t,r){return se(t=Le(R(t)),r=z(r))?t:t.sort((u,v)=>u-v)[r-1]}De.AVG=(t,r,u)=>{if(se(t=z(t),r=Le(R(r))))return f;const v=(u=u||!1)?(X,ue)=>X-ue:(X,ue)=>ue-X,N=(r=(r=R(r)).sort(v)).length;let q=0;for(let X=0;X<N;X++)r[X]===t&&q++;return q>1?(2*r.indexOf(t)+q+1)/2:r.indexOf(t)+1},De.EQ=(t,r,u)=>{if(se(t=z(t),r=Le(R(r))))return f;const v=(u=u||!1)?(N,q)=>N-q:(N,q)=>q-N;return(r=r.sort(v)).indexOf(t)+1},Ze.P=function(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=g.mean(t),u=t.length;let v=0,N=0;for(let q=0;q<u;q++)N+=Math.pow(t[q]-r,3),v+=Math.pow(t[q]-r,2);return N/=u,v/=u,N/Math.pow(v,1.5)};const dt={P:function(){const t=Ae.P.apply(this,arguments);let r=Math.sqrt(t);return isNaN(r)&&(r=b),r},S:function(){const t=Ae.S.apply(this,arguments);return Math.sqrt(t)}},le={DIST:(t,r,u)=>u!==1&&u!==2?b:u===1?le.DIST.RT(t,r):le.DIST["2T"](t,r)};le.DIST["2T"]=function(t,r){return arguments.length!==2?T:t<0||r<1?b:typeof t!="number"||typeof r!="number"?f:2*(1-g.studentt.cdf(t,r))},le.DIST.RT=function(t,r){return arguments.length!==2?T:t<0||r<1?b:typeof t!="number"||typeof r!="number"?f:1-g.studentt.cdf(t,r)},le.INV=(t,r)=>se(t=z(t),r=z(r))?f:g.studentt.inv(t,r),le.INV["2T"]=(t,r)=>(t=z(t),r=z(r),t<=0||t>1||r<1?b:se(t,r)?f:Math.abs(g.studentt.inv(t/2,r))),le.TEST=(t,r)=>{if(se(t=Le(R(t)),r=Le(R(r))))return f;const u=g.mean(t),v=g.mean(r);let N,q=0,X=0;for(N=0;N<t.length;N++)q+=Math.pow(t[N]-u,2);for(N=0;N<r.length;N++)X+=Math.pow(r[N]-v,2);q/=t.length-1,X/=r.length-1;const ue=Math.abs(u-v)/Math.sqrt(q/t.length+X/r.length);return le.DIST["2T"](ue,t.length+r.length-2)};const Ae={};function Ne(){const t=R(arguments),r=t.length;let u=0,v=0;const N=_(t);for(let q=0;q<r;q++){const X=t[q];u+=Math.pow(typeof X=="number"?X-N:X===!0?1-N:0-N,2),X!==null&&v++}return u/(v-1)}function nt(){const t=R(arguments),r=t.length;let u=0,v=0;const N=_(t);let q;for(let X=0;X<r;X++){const ue=t[X];u+=Math.pow(typeof ue=="number"?ue-N:ue===!0?1-N:0-N,2),ue!==null&&v++}return q=u/v,isNaN(q)&&(q=b),q}Ae.P=function(){const t=qe(R(arguments)),r=t.length;let u=0;const v=l(t);let N;for(let q=0;q<r;q++)u+=Math.pow(t[q]-v,2);return N=u/r,isNaN(N)&&(N=b),N},Ae.S=function(){const t=qe(R(arguments)),r=t.length;let u=0;const v=l(t);for(let N=0;N<r;N++)u+=Math.pow(t[N]-v,2);return u/(r-1)};const ht={DIST:(t,r,u,v)=>se(t=z(t),r=z(r),u=z(u))?f:v?1-Math.exp(-Math.pow(t/u,r)):Math.pow(t,r-1)*Math.exp(-Math.pow(t/u,r))*r/Math.pow(u,r)},ut={};function mt(t,r,u){const v=ye(t=z(t),r=z(r),u=z(u));if(v)return v;if(r===0)return 0;r=Math.abs(r);const N=-Math.floor(Math.log(r)/Math.log(10));return t>=0?At(Math.ceil(t/r)*r,N):u===0?-At(Math.floor(Math.abs(t)/r)*r,N):-At(Math.ceil(Math.abs(t)/r)*r,N)}function jt(t,r){return ye(t=z(t),r=z(r))||(t<r?b:st(t)/(st(r)*st(t-r)))}ut.TEST=(t,r,u)=>{if(se(t=Le(R(t)),r=z(r)))return f;u=u||dt.S(t);const v=t.length;return 1-ee.S.DIST((l(t)-r)/(u/Math.sqrt(v)),!0)},mt.MATH=mt,mt.PRECISE=mt;const rt=[];function st(t){if((t=z(t))instanceof Error)return t;const r=Math.floor(t);return r===0||r===1?1:(rt[r]>0||(rt[r]=st(r-1)*r),rt[r])}function Lt(t,r){const u=ye(t=z(t),r=z(r));if(u)return u;if(r===0)return 0;if(!(t>=0&&r>0||t<=0&&r<0))return b;r=Math.abs(r);const v=-Math.floor(Math.log(r)/Math.log(10));return t>=0?At(Math.floor(t/r)*r,v):-At(Math.ceil(Math.abs(t)/r),v)}Lt.MATH=(t,r,u)=>{if(r instanceof Error)return r;r=r===void 0?0:r;const v=ye(t=z(t),r=z(r),u=z(u));if(v)return v;if(r===0)return 0;r=r?Math.abs(r):1;const N=-Math.floor(Math.log(r)/Math.log(10));return t>=0?At(Math.floor(t/r)*r,N):u===0||u===void 0?-At(Math.ceil(Math.abs(t)/r)*r,N):-At(Math.floor(Math.abs(t)/r)*r,N)},Lt.PRECISE=Lt.MATH;const dn={CEILING:mt};function en(t,r){const u=ye(t=z(t),r=z(r));if(u)return u;if(t===0&&r===0)return b;const v=Math.pow(t,r);return isNaN(v)?b:v}function Ut(){const t=R(arguments).filter(v=>v!=null);if(t.length===0)return 0;const r=Le(t);if(r instanceof Error)return r;let u=1;for(let v=0;v<r.length;v++)u*=r[v];return u}function At(t,r){return ye(t=z(t),r=z(r))||+(Math.round(+(t+"e"+r))+"e"+-1*r)}function It(){let t=0;return I(B(arguments),r=>{if(t instanceof Error)return!1;if(r instanceof Error)t=r;else if(typeof r=="number")t+=r;else if(typeof r=="string"){const u=parseFloat(r);!isNaN(u)&&(t+=u)}else if(Array.isArray(r)){const u=It.apply(null,r);u instanceof Error?t=u:t+=u}}),t}var fn=Object.freeze({__proto__:null,ADD:function(t,r){return arguments.length!==2?T:ye(t=z(t),r=z(r))||t+r},DIVIDE:function(t,r){return arguments.length!==2?T:ye(t=z(t),r=z(r))||(r===0?m:t/r)},EQ:function(t,r){return arguments.length!==2?T:t instanceof Error?t:r instanceof Error?r:(t===null&&(t=void 0),r===null&&(r=void 0),t===r)},GT:function(t,r){return arguments.length!==2?T:t instanceof Error?t:r instanceof Error?r:(ft(t,r)?(t=Qe(t),r=Qe(r)):(t=z(t),r=z(r)),ye(t,r)||t>r)},GTE:function(t,r){return arguments.length!==2?T:(ft(t,r)?(t=Qe(t),r=Qe(r)):(t=z(t),r=z(r)),ye(t,r)||t>=r)},LT:function(t,r){return arguments.length!==2?T:(ft(t,r)?(t=Qe(t),r=Qe(r)):(t=z(t),r=z(r)),ye(t,r)||t<r)},LTE:function(t,r){return arguments.length!==2?T:(ft(t,r)?(t=Qe(t),r=Qe(r)):(t=z(t),r=z(r)),ye(t,r)||t<=r)},MINUS:function(t,r){return arguments.length!==2?T:ye(t=z(t),r=z(r))||t-r},MULTIPLY:function(t,r){return arguments.length!==2?T:ye(t=z(t),r=z(r))||t*r},NE:function(t,r){return arguments.length!==2?T:t instanceof Error?t:r instanceof Error?r:(t===null&&(t=void 0),r===null&&(r=void 0),t!==r)},POW:function(t,r){return arguments.length!==2?T:en(t,r)}});const pn=new Date(Date.UTC(1900,0,1)),hn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],gn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],_t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Dt(t,r,u){u=u.toUpperCase(),t=Xe(t),r=Xe(r);const v=t.getFullYear(),N=t.getMonth(),q=t.getDate(),X=r.getFullYear(),ue=r.getMonth(),je=r.getDate();let ke;switch(u){case"Y":ke=Math.floor(qt(t,r));break;case"D":ke=St(r,t);break;case"M":ke=ue-N+12*(X-v),je<q&&ke--;break;case"MD":q<=je?ke=je-q:(ue===0?(t.setFullYear(X-1),t.setMonth(12)):(t.setFullYear(X),t.setMonth(ue-1)),ke=St(r,t));break;case"YM":ke=ue-N+12*(X-v),je<q&&ke--,ke%=12;break;case"YD":ue>N||ue===N&&je<q?t.setFullYear(X):t.setFullYear(X-1),ke=St(r,t)}return ke}function Ft(t){const r=new Date(t);return r.setHours(0,0,0,0),r}function St(t,r){return t=Xe(t),r=Xe(r),t instanceof Error?t:r instanceof Error?r:nn(Ft(t))-nn(Ft(r))}function Mt(t,r,u){if(u=_e(u||"false"),t=Xe(t),r=Xe(r),t instanceof Error)return t;if(r instanceof Error)return r;if(u instanceof Error)return u;const v=t.getMonth();let N,q,X=r.getMonth();if(u)N=t.getDate()===31?30:t.getDate(),q=r.getDate()===31?30:r.getDate();else{const ue=new Date(t.getFullYear(),v+1,0).getDate(),je=new Date(r.getFullYear(),X+1,0).getDate();N=t.getDate()===ue?30:t.getDate(),r.getDate()===je?N<30?(X++,q=1):q=30:q=r.getDate()}return 360*(r.getFullYear()-t.getFullYear())+30*(X-v)+(q-N)}function tn(t){if((t=Xe(t))instanceof Error)return t;(t=Ft(t)).setDate(t.getDate()+4-(t.getDay()||7));const r=new Date(t.getFullYear(),0,1);return Math.ceil(((t-r)/864e5+1)/7)}function kt(t,r,u){return kt.INTL(t,r,1,u)}function Ht(t,r,u){return Ht.INTL(t,r,1,u)}function zt(t){return new Date(t,1,29).getMonth()===1}function Pt(t,r){return Math.ceil((r-t)/1e3/60/60/24)}function qt(t,r,u){if((t=Xe(t))instanceof Error)return t;if((r=Xe(r))instanceof Error)return r;u=u||0;let v=t.getDate();const N=t.getMonth()+1,q=t.getFullYear();let X=r.getDate();const ue=r.getMonth()+1,je=r.getFullYear();switch(u){case 0:return v===31&&X===31?(v=30,X=30):v===31?v=30:v===30&&X===31&&(X=30),(X+30*ue+360*je-(v+30*N+360*q))/360;case 1:{const ke=(lt,pt)=>{const gt=lt.getFullYear(),wt=new Date(gt,2,1);if(zt(gt)&&lt<wt&&pt>=wt)return!0;const yt=pt.getFullYear(),Tt=new Date(yt,2,1);return zt(yt)&&pt>=Tt&&lt<Tt};let $e=365;if(q===je||q+1===je&&(N>ue||N===ue&&v>=X))return(q===je&&zt(q)||ke(t,r)||ue===1&&X===29)&&($e=366),Pt(t,r)/$e;const ot=je-q+1,et=(new Date(je+1,0,1)-new Date(q,0,1))/1e3/60/60/24/ot;return Pt(t,r)/et}case 2:return Pt(t,r)/360;case 3:return Pt(t,r)/365;case 4:return(X+30*ue+360*je-(v+30*N+360*q))/360}}function nn(t){const r=t>-22038912e5?2:1;return Math.ceil((t-pn)/864e5)+r}function rn(t){return(t=z(t))===0?f:t instanceof Error?t:String.fromCharCode(t)}function on(t){if(se(t))return t;let r=(t=t||"").charCodeAt(0);return isNaN(r)&&(r=f),r}function sn(){const t=R(arguments),r=ye.apply(void 0,t);if(r)return r;let u=0;for(;(u=t.indexOf(!0))>-1;)t[u]="TRUE";let v=0;for(;(v=t.indexOf(!1))>-1;)t[v]="FALSE";return t.join("")}kt.INTL=(t,r,u,v)=>{if((t=Xe(t))instanceof Error)return t;if((r=Xe(r))instanceof Error)return r;let N=!1;const q=[],X=[1,2,3,4,5,6,0],ue=new RegExp("^[0|1]{7}$");if(u===void 0)u=_t[1];else if(typeof u=="string"&&ue.test(u)){N=!0,u=u.split("");for(let ot=0;ot<u.length;ot++)u[ot]==="1"&&q.push(X[ot])}else u=_t[u];if(!(u instanceof Array))return f;v===void 0?v=[]:v instanceof Array||(v=[v]);for(let ot=0;ot<v.length;ot++){const et=Xe(v[ot]);if(et instanceof Error)return et;v[ot]=et}const je=Math.round((r-t)/864e5)+1;let ke=je;const $e=t;for(let ot=0;ot<je;ot++){const et=new Date().getTimezoneOffset()>0?$e.getUTCDay():$e.getDay();let lt=N?q.includes(et):et===u[0]||et===u[1];for(let pt=0;pt<v.length;pt++){const gt=v[pt];if(gt.getDate()===$e.getDate()&&gt.getMonth()===$e.getMonth()&&gt.getFullYear()===$e.getFullYear()){lt=!0;break}}lt&&ke--,$e.setDate($e.getDate()+1)}return ke},Ht.INTL=(t,r,u,v)=>{if((t=Xe(t))instanceof Error)return t;if((r=z(r))instanceof Error)return r;if(r<0)return b;if(!((u=u===void 0?_t[1]:_t[u])instanceof Array))return f;v===void 0?v=[]:v instanceof Array||(v=[v]);for(let q=0;q<v.length;q++){const X=Xe(v[q]);if(X instanceof Error)return X;v[q]=X}let N=0;for(;N<r;){t.setDate(t.getDate()+1);const q=t.getDay();if(q!==u[0]&&q!==u[1]){for(let X=0;X<v.length;X++){const ue=v[X];if(ue.getDate()===t.getDate()&&ue.getMonth()===t.getMonth()&&ue.getFullYear()===t.getFullYear()){N--;break}}N++}}return t};const mn=sn;function an(t,r=2,u=!1){if(t=z(t),isNaN(t)||(r=z(r),isNaN(r)))return f;if(r<0){const v=Math.pow(10,-r);t=Math.round(t/v)*v}else t=t.toFixed(r);if(u)t=t.toString().replace(/,/g,"");else{const v=t.toString().split(".");v[0]=v[0].replace(/\B(?=(\d{3})+$)/g,","),t=v.join(".")}return t}function Ct(t,r){return ye(t,r)||(t=Qe(t),(r=z(r))instanceof Error?r:new Array(r+1).join(t))}const bn=rn,vn=on;function Yt(t){return/^[01]{1,10}$/.test(t)}function xt(t,r,u){if(se(t=z(t),r=z(r)))return t;if((u=u===void 0?"i":u)!=="i"&&u!=="j")return f;if(t===0&&r===0)return 0;if(t===0)return r===1?u:r.toString()+u;if(r===0)return t.toString();{const v=r>0?"+":"";return t.toString()+v+(r===1?u:r.toString()+u)}}function Wt(t,r){return r=r===void 0?0:r,se(t=z(t),r=z(r))?f:g.erf(t)}function Kt(t){return isNaN(t)?f:g.erfc(t)}function Xt(t){const r=vt(t),u=bt(t);return se(r,u)?f:Math.sqrt(Math.pow(r,2)+Math.pow(u,2))}function bt(t){if(t===void 0||t===!0||t===!1)return f;if(t===0||t==="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;let r=(t=(t+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),u=t.indexOf("-");r===0&&(r=t.indexOf("+",1)),u===0&&(u=t.indexOf("-",1));const v=t.substring(t.length-1,t.length),N=v==="i"||v==="j";return r>=0||u>=0?N?r>=0?isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?b:Number(t.substring(r+1,t.length-1)):isNaN(t.substring(0,u))||isNaN(t.substring(u+1,t.length-1))?b:-Number(t.substring(u+1,t.length-1)):b:N?isNaN(t.substring(0,t.length-1))?b:t.substring(0,t.length-1):isNaN(t)?b:0}function Gt(t){const r=vt(t),u=bt(t);return se(r,u)?f:r===0&&u===0?m:r===0&&u>0?Math.PI/2:r===0&&u<0?-Math.PI/2:u===0&&r>0?0:u===0&&r<0?-Math.PI:r>0?Math.atan(u/r):r<0&&u>=0?Math.atan(u/r)+Math.PI:Math.atan(u/r)-Math.PI}function Bt(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.cos(r)*(Math.exp(u)+Math.exp(-u))/2,-Math.sin(r)*(Math.exp(u)-Math.exp(-u))/2,v)}function ln(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.cos(u)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(u)*(Math.exp(r)-Math.exp(-r))/2,v)}function Nt(t,r){const u=vt(t),v=bt(t),N=vt(r),q=bt(r);if(se(u,v,N,q))return f;const X=t.substring(t.length-1),ue=r.substring(r.length-1);let je="i";if((X==="j"||ue==="j")&&(je="j"),N===0&&q===0)return b;const ke=N*N+q*q;return xt((u*N+v*q)/ke,(v*N-u*q)/ke,je)}function vt(t){if(t===void 0||t===!0||t===!1)return f;if(t===0||t==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;let r=(t+="").indexOf("+"),u=t.indexOf("-");r===0&&(r=t.indexOf("+",1)),u===0&&(u=t.indexOf("-",1));const v=t.substring(t.length-1,t.length),N=v==="i"||v==="j";return r>=0||u>=0?N?r>=0?isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?b:Number(t.substring(0,r)):isNaN(t.substring(0,u))||isNaN(t.substring(u+1,t.length-1))?b:Number(t.substring(0,u)):b:N?isNaN(t.substring(0,t.length-1))?b:0:isNaN(t)?b:t}function Vt(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.sin(r)*(Math.exp(u)+Math.exp(-u))/2,Math.cos(r)*(Math.exp(u)-Math.exp(-u))/2,v)}function cn(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.cos(u)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(u)*(Math.exp(r)+Math.exp(-r))/2,v)}Wt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Kt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=G.DIST,yn=G.INV,xn=ne.DIST,wn=mt.MATH,Cn=mt.PRECISE,En=k.DIST,An=k.DIST.RT,Mn=k.INV,Tn=k.INV.RT,Ln=k.TEST,In=xe.P,Sn=xe.P,Nn=xe.S,On=ne.INV,Dn=Kt.PRECISE,Rn=Wt.PRECISE,_n=ge.DIST,Fn=fe.DIST,kn=fe.DIST.RT,Hn=fe.INV,Pn=fe.INV.RT,Bn=Lt.MATH,Vn=Lt.PRECISE,Un=fe.TEST,zn=We.DIST,qn=We.INV,Yn=Je.PRECISE,Wn=Me.DIST,Kn=He.INV,Xn=He.DIST,Gn=He.INV,$n=A.MULT,Jn=A.SNGL,Zn=W.DIST,Qn=kt.INTL,er=ee.DIST,tr=ee.INV,nr=ee.S.DIST,rr=ee.S.INV,or=re.EXC,ir=re.INC,sr=he.EXC,ar=he.INC,lr=Te.DIST,cr=Ge.EXC,ur=Ge.INC,dr=De.AVG,fr=De.EQ,pr=Ze.P,hr=dt.P,gr=dt.S,mr=le.DIST,br=le.DIST.RT,vr=le.INV,jr=le.TEST,yr=Ae.P,xr=Ae.S,wr=ht.DIST,Cr=Ht.INTL,Er=ut.TEST;function $t(t){const r=[];return I(t,u=>{u&&r.push(u)}),r}function Et(t,r){const u={};for(let q=1;q<t[0].length;++q)u[q]=!0;let v=r[0].length;for(let q=1;q<r.length;++q)r[q].length>v&&(v=r[q].length);for(let q=1;q<t.length;++q)for(let X=1;X<t[q].length;++X){let ue=!1,je=!1;for(let ke=0;ke<r.length;++ke){const $e=r[ke];if($e.length<v)continue;const ot=$e[0];if(t[q][0]===ot){je=!0;for(let et=1;et<$e.length;++et)if(!ue)if($e[et]===void 0||$e[et]==="*")ue=!0;else{const lt=ve($e[et]+""),pt=[ce(t[q][X],te)].concat(lt);ue=Ce(pt)}}}je&&(u[X]=u[X]&&ue)}const N=[];for(let q=0;q<t[0].length;++q)u[q]&&N.push(q-1);return N}function Jt(t){return t&&t.getTime&&!isNaN(t.getTime())}function Zt(t){return t instanceof Date?t:new Date(t)}function Ot(t,r,u,v,N){if(v=v||0,N=N||0,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N)))return f;let q;if(t===0)q=v+u*r;else{const X=Math.pow(1+t,r);q=N===1?v*X+u*(1+t)*(X-1)/t:v*X+u*(X-1)/t}return-q}function un(t,r,u,v,N,q){if(N=N||0,q=q||0,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N),q=z(q)))return f;const X=Rt(t,u,v,N,q);return(r===1?q===1?0:-v:q===1?Ot(t,r-2,X,v,1)-X:Ot(t,r-1,X,v,0))*t}function Qt(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=t[0];let u=0;for(let v=1;v<t.length;v++)u+=t[v]/Math.pow(1+r,v);return u}function Rt(t,r,u,v,N){if(v=v||0,N=N||0,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N)))return f;let q;if(t===0)q=(u+v)/r;else{const X=Math.pow(1+t,r);q=N===1?(v*t/(X-1)+u*t/(1-1/X))/(1+t):v*t/(X-1)+u*t/(1-1/X)}return-q}const Ar={errors:U,symbols:fn};c.ABS=function(t){return(t=z(t))instanceof Error?t:Math.abs(t)},c.ACCRINT=function(t,r,u,v,N,q,X){return t=Zt(t),r=Zt(r),u=Zt(u),Jt(t)&&Jt(r)&&Jt(u)?v<=0||N<=0||[1,2,4].indexOf(q)===-1||[0,1,2,3,4].indexOf(X)===-1||u<=t?b:(N=N||0)*v*qt(t,u,X=X||0):f},c.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},c.ACOS=function(t){if((t=z(t))instanceof Error)return t;let r=Math.acos(t);return isNaN(r)&&(r=b),r},c.ACOSH=function(t){if((t=z(t))instanceof Error)return t;let r=Math.log(t+Math.sqrt(t*t-1));return isNaN(r)&&(r=b),r},c.ACOT=function(t){return(t=z(t))instanceof Error?t:Math.atan(1/t)},c.ACOTH=function(t){if((t=z(t))instanceof Error)return t;let r=.5*Math.log((t+1)/(t-1));return isNaN(r)&&(r=b),r},c.AGGREGATE=function(t,r,u,v){if(se(t=z(t),z(t)))return f;switch(t){case 1:return l(u);case 2:return Y(u);case 3:return J(u);case 4:return Z(u);case 5:return ae(u);case 6:return Ut(u);case 7:return dt.S(u);case 8:return dt.P(u);case 9:return It(u);case 10:return Ae.S(u);case 11:return Ae.P(u);case 12:return K(u);case 13:return A.SNGL(u);case 14:return ze(u,v);case 15:return it(u,v);case 16:return re.INC(u,v);case 17:return Ge.INC(u,v);case 18:return re.EXC(u,v);case 19:return Ge.EXC(u,v)}},c.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},c.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},c.AND=function(){const t=R(arguments);let r=f;for(let u=0;u<t.length;u++){if(t[u]instanceof Error)return t[u];t[u]!==void 0&&t[u]!==null&&typeof t[u]!="string"&&(r===f&&(r=!0),t[u]||(r=!1))}return r},c.ARABIC=function(t){if(t==null)return 0;if(t instanceof Error)return t;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return f;let r=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,u=>{r+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[u]}),r},c.ASC=function(){throw new Error("ASC is not implemented")},c.ASIN=function(t){if((t=z(t))instanceof Error)return t;let r=Math.asin(t);return isNaN(r)&&(r=b),r},c.ASINH=function(t){return(t=z(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},c.ATAN=function(t){return(t=z(t))instanceof Error?t:Math.atan(t)},c.ATAN2=function(t,r){return ye(t=z(t),r=z(r))||Math.atan2(t,r)},c.ATANH=function(t){if((t=z(t))instanceof Error)return t;let r=Math.log((1+t)/(1-t))/2;return isNaN(r)&&(r=b),r},c.AVEDEV=function(){const t=R(arguments).filter(Ie);if(t.length===0)return b;const r=Le(t);return r instanceof Error?r:g.sum(g(r).subtract(g.mean(r)).abs()[0])/r.length},c.AVERAGE=l,c.AVERAGEA=_,c.AVERAGEIF=function(t,r,u){if(arguments.length<=1)return T;if(u=Le(R(u=u||t).filter(Ie)),t=R(t),u instanceof Error)return u;let v=0,N=0;const q=r===void 0||r==="*",X=q?null:ve(r+"");for(let ue=0;ue<t.length;ue++){const je=t[ue];if(q)N+=u[ue],v++;else{const ke=[ce(je,te)].concat(X);Ce(ke)&&(N+=u[ue],v++)}}return N/v},c.AVERAGEIFS=function(){const t=B(arguments),r=(t.length-1)/2,u=R(t[0]);let v=0,N=0;for(let X=0;X<u.length;X++){let ue=!1;for(let je=0;je<r;je++){const ke=t[2*je+1][X],$e=t[2*je+2];let ot=!1;if($e===void 0||$e==="*")ot=!0;else{const et=ve($e+""),lt=[ce(ke,te)].concat(et);ot=Ce(lt)}if(!ot){ue=!1;break}ue=!0}ue&&(N+=u[X],v++)}const q=N/v;return isNaN(q)?0:q},c.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},c.BASE=function(t,r,u){const v=ye(t=z(t),r=z(r),u=z(u));if(v)return v;if(r===0)return b;const N=t.toString(r);return new Array(Math.max(u+1-N.length,0)).join("0")+N},c.BESSELI=function(t,r){return se(t=z(t),r=z(r))?f:D.besseli(t,r)},c.BESSELJ=function(t,r){return se(t=z(t),r=z(r))?f:D.besselj(t,r)},c.BESSELK=function(t,r){return se(t=z(t),r=z(r))?f:D.besselk(t,r)},c.BESSELY=function(t,r){return se(t=z(t),r=z(r))?f:D.bessely(t,r)},c.BETA=G,c.BETADIST=jn,c.BETAINV=yn,c.BIN2DEC=function(t){if(!Yt(t))return b;const r=parseInt(t,2),u=t.toString();return u.length===10&&u.substring(0,1)==="1"?parseInt(u.substring(1),2)-512:r},c.BIN2HEX=function(t,r){if(!Yt(t))return b;const u=t.toString();if(u.length===10&&u.substring(0,1)==="1")return(0xfffffffe00+parseInt(u.substring(1),2)).toString(16);const v=parseInt(t,2).toString(16);return r===void 0?v:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=v.length?Ct("0",r-v.length)+v:b},c.BIN2OCT=function(t,r){if(!Yt(t))return b;const u=t.toString();if(u.length===10&&u.substring(0,1)==="1")return(1073741312+parseInt(u.substring(1),2)).toString(8);const v=parseInt(t,2).toString(8);return r===void 0?v:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=v.length?Ct("0",r-v.length)+v:b},c.BINOM=ne,c.BINOMDIST=xn,c.BITAND=function(t,r){return se(t=z(t),r=z(r))?f:t<0||r<0||Math.floor(t)!==t||Math.floor(r)!==r||t>0xffffffffffff||r>0xffffffffffff?b:t&r},c.BITLSHIFT=function(t,r){return se(t=z(t),r=z(r))?f:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(r)>53?b:r>=0?t<<r:t>>-r},c.BITOR=function(t,r){return se(t=z(t),r=z(r))?f:t<0||r<0||Math.floor(t)!==t||Math.floor(r)!==r||t>0xffffffffffff||r>0xffffffffffff?b:t|r},c.BITRSHIFT=function(t,r){return se(t=z(t),r=z(r))?f:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(r)>53?b:r>=0?t>>r:t<<-r},c.BITXOR=function(t,r){return se(t=z(t),r=z(r))?f:t<0||r<0||Math.floor(t)!==t||Math.floor(r)!==r||t>0xffffffffffff||r>0xffffffffffff?b:t^r},c.CEILING=mt,c.CEILINGMATH=wn,c.CEILINGPRECISE=Cn,c.CELL=function(){throw new Error("CELL is not implemented")},c.CHAR=rn,c.CHIDIST=En,c.CHIDISTRT=An,c.CHIINV=Mn,c.CHIINVRT=Tn,c.CHISQ=k,c.CHITEST=Ln,c.CHOOSE=function(){if(arguments.length<2)return T;const t=arguments[0];return t<1||t>254||arguments.length<t+1?f:arguments[t]},c.CLEAN=function(t){return se(t)?t:(t=t||"").replace(/[\0-\x1F]/g,"")},c.CODE=on,c.COLUMN=function(t,r){return arguments.length!==2?T:r<0?b:t instanceof Array&&typeof r=="number"?t.length!==0?g.col(t,r):void 0:f},c.COLUMNS=function(t){return arguments.length!==1?T:t instanceof Array?t.length===0?0:g.cols(t):f},c.COMBIN=jt,c.COMBINA=function(t,r){return ye(t=z(t),r=z(r))||(t<r?b:t===0&&r===0?1:jt(t+r-1,t-1))},c.COMPLEX=xt,c.CONCAT=mn,c.CONCATENATE=sn,c.CONFIDENCE=S,c.CONVERT=function(t,r,u){if((t=z(t))instanceof Error)return t;const v=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],N={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},q={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let X,ue=null,je=null,ke=r,$e=u,ot=1,et=1;for(let lt=0;lt<v.length;lt++)X=v[lt][2]===null?[]:v[lt][2],(v[lt][1]===ke||X.indexOf(ke)>=0)&&(ue=v[lt]),(v[lt][1]===$e||X.indexOf($e)>=0)&&(je=v[lt]);if(ue===null){const lt=N[r.substring(0,2)];let pt=q[r.substring(0,1)];r.substring(0,2)==="da"&&(pt=["dekao",10,"da"]),lt?(ot=lt[2],ke=r.substring(2)):pt&&(ot=pt[1],ke=r.substring(pt[2].length));for(let gt=0;gt<v.length;gt++)X=v[gt][2]===null?[]:v[gt][2],(v[gt][1]===ke||X.indexOf(ke)>=0)&&(ue=v[gt])}if(je===null){const lt=N[u.substring(0,2)];let pt=q[u.substring(0,1)];u.substring(0,2)==="da"&&(pt=["dekao",10,"da"]),lt?(et=lt[2],$e=u.substring(2)):pt&&(et=pt[1],$e=u.substring(pt[2].length));for(let gt=0;gt<v.length;gt++)X=v[gt][2]===null?[]:v[gt][2],(v[gt][1]===$e||X.indexOf($e)>=0)&&(je=v[gt])}return ue===null||je===null||ue[3]!==je[3]?T:t*ue[6]*ot/(je[6]*et)},c.CORREL=function(t,r){return se(t=Le(R(t)),r=Le(R(r)))?f:g.corrcoeff(t,r)},c.COS=function(t){return(t=z(t))instanceof Error?t:Math.cos(t)},c.COSH=function(t){return(t=z(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},c.COT=function(t){return(t=z(t))instanceof Error?t:t===0?m:1/Math.tan(t)},c.COTH=function(t){if((t=z(t))instanceof Error)return t;if(t===0)return m;const r=Math.exp(2*t);return(r+1)/(r-1)},c.COUNT=Y,c.COUNTA=J,c.COUNTBLANK=ie,c.COUNTIF=function(t,r){if(t=R(t),r===void 0||r==="*")return t.length;let u=0;const v=ve(r+"");for(let N=0;N<t.length;N++){const q=[ce(t[N],te)].concat(v);Ce(q)&&u++}return u},c.COUNTIFS=function(){const t=B(arguments),r=new Array(R(t[0]).length);for(let v=0;v<r.length;v++)r[v]=!0;for(let v=0;v<t.length;v+=2){const N=R(t[v]),q=t[v+1];if(q!==void 0&&q!=="*"){const X=ve(q+"");for(let ue=0;ue<N.length;ue++){const je=[ce(N[ue],te)].concat(X);r[ue]=r[ue]&&Ce(je)}}}let u=0;for(let v=0;v<r.length;v++)r[v]&&u++;return u},c.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},c.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},c.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},c.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},c.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},c.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},c.COVAR=In,c.COVARIANCE=xe,c.COVARIANCEP=Sn,c.COVARIANCES=Nn,c.CRITBINOM=On,c.CSC=function(t){return(t=z(t))instanceof Error?t:t===0?m:1/Math.sin(t)},c.CSCH=function(t){return(t=z(t))instanceof Error?t:t===0?m:2/(Math.exp(t)-Math.exp(-t))},c.CUMIPMT=function(t,r,u,v,N,q){if(se(t=z(t),r=z(r),u=z(u)))return f;if(t<=0||r<=0||u<=0||v<1||N<1||v>N||q!==0&&q!==1)return b;const X=Rt(t,r,u,0,q);let ue=0;v===1&&(q===0&&(ue=-u),v++);for(let je=v;je<=N;je++)ue+=q===1?Ot(t,je-2,X,u,1)-X:Ot(t,je-1,X,u,0);return ue*=t,ue},c.CUMPRINC=function(t,r,u,v,N,q){if(se(t=z(t),r=z(r),u=z(u)))return f;if(t<=0||r<=0||u<=0||v<1||N<1||v>N||q!==0&&q!==1)return b;const X=Rt(t,r,u,0,q);let ue=0;v===1&&(ue=q===0?X+u*t:X,v++);for(let je=v;je<=N;je++)ue+=q>0?X-(Ot(t,je-2,X,u,1)-X)*t:X-Ot(t,je-1,X,u,0)*t;return ue},c.DATE=function(t,r,u){let v;return se(t=z(t),r=z(r),u=z(u))?v=f:(v=new Date(t,r-1,u),v.getFullYear()<0&&(v=b)),v},c.DATEDIF=Dt,c.DATEVALUE=function(t){if(typeof t!="string")return f;const r=Date.parse(t);return isNaN(r)?f:new Date(t)},c.DAVERAGE=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);let q=0;return I(v,X=>{q+=N[X]}),v.length===0?m:q/v.length},c.DAY=function(t){const r=Xe(t);return r instanceof Error?r:r.getDate()},c.DAYS=St,c.DAYS360=Mt,c.DB=function(t,r,u,v,N){if(N=N===void 0?12:N,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N)))return f;if(t<0||r<0||u<0||v<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(N)===-1||v>u)return b;if(r>=t)return 0;const q=(1-Math.pow(r/t,1/u)).toFixed(3),X=t*q*N/12;let ue=X,je=0;const ke=v===u?u-1:v;for(let $e=2;$e<=ke;$e++)je=(t-ue)*q,ue+=je;return v===1?X:v===u?(t-ue)*q:je},c.DBCS=function(){throw new Error("DBCS is not implemented")},c.DCOUNT=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);const q=[];return I(v,X=>{q.push(N[X])}),Y(q)},c.DCOUNTA=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);const q=[];return I(v,X=>{q.push(N[X])}),J(q)},c.DDB=function(t,r,u,v,N){if(N=N===void 0?2:N,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N)))return f;if(t<0||r<0||u<0||v<0||N<=0||v>u)return b;if(r>=t)return 0;let q=0,X=0;for(let ue=1;ue<=v;ue++)X=Math.min(N/u*(t-q),t-r-q),q+=X;return X},c.DEC2BIN=function(t,r){if((t=z(t))instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return b;if(t<0)return"1"+Ct("0",9-(512+t).toString(2).length)+(512+t).toString(2);const u=parseInt(t,10).toString(2);return r===void 0?u:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=u.length?Ct("0",r-u.length)+u:b},c.DEC2HEX=function(t,r){if((t=z(t))instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return b;if(t<0)return(1099511627776+t).toString(16);const u=parseInt(t,10).toString(16);return r===void 0?u:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=u.length?Ct("0",r-u.length)+u:b},c.DEC2OCT=function(t,r){if((t=z(t))instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return b;if(t<0)return(1073741824+t).toString(8);const u=parseInt(t,10).toString(8);return r===void 0?u:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=u.length?Ct("0",r-u.length)+u:b},c.DECIMAL=function(t,r){return arguments.length<1?f:ye(t=z(t),r=z(r))||(r===0?b:parseInt(t,r))},c.DEGREES=function(t){return(t=z(t))instanceof Error?t:180*t/Math.PI},c.DELTA=function(t,r){return r=r===void 0?0:r,se(t=z(t),r=z(r))?f:t===r?1:0},c.DEVSQ=function(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=g.mean(t);let u=0;for(let v=0;v<t.length;v++)u+=Math.pow(t[v]-r,2);return u},c.DGET=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];return N=oe(typeof r=="string"?t[Ee(t,r)]:t[r]),v.length===0?f:v.length>1?b:N[v[0]]},c.DISC=function(t,r,u,v,N){if(se(t=Xe(t),r=Xe(r),u=z(u),v=z(v),N=(N=z(N))||0))return f;if(u<=0||v<=0)return b;if(t>=r)return f;let q,X;switch(N){case 0:q=360,X=Mt(t,r,!1);break;case 1:case 3:q=365,X=Dt(t,r,"D");break;case 2:q=360,X=Dt(t,r,"D");break;case 4:q=360,X=Mt(t,r,!0);break;default:return b}return(v-u)/v*q/X},c.DMAX=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);let q=N[v[0]];return I(v,X=>{q<N[X]&&(q=N[X])}),q},c.DMIN=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);let q=N[v[0]];return I(v,X=>{q>N[X]&&(q=N[X])}),q},c.DOLLAR=function(t,r=2){if(t=z(t),isNaN(t))return f;const u={style:"currency",currency:"USD",minimumFractionDigits:r>=0?r:0,maximumFractionDigits:r>=0?r:0},v=(t=At(t,r)).toLocaleString("en-US",u);return t<0?"$("+v.slice(2)+")":v},c.DOLLARDE=function(t,r){if(se(t=z(t),r=z(r)))return f;if(r<0)return b;if(r>=0&&r<1)return m;r=parseInt(r,10);let u=parseInt(t,10);u+=t%1*Math.pow(10,Math.ceil(Math.log(r)/Math.LN10))/r;const v=Math.pow(10,Math.ceil(Math.log(r)/Math.LN2)+1);return u=Math.round(u*v)/v,u},c.DOLLARFR=function(t,r){if(se(t=z(t),r=z(r)))return f;if(r<0)return b;if(r>=0&&r<1)return m;r=parseInt(r,10);let u=parseInt(t,10);return u+=t%1*Math.pow(10,-Math.ceil(Math.log(r)/Math.LN10))*r,u},c.DPRODUCT=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const ue=Ee(t,r);N=oe(t[ue])}else N=oe(t[r]);let q=[];I(v,ue=>{q.push(N[ue])}),q=$t(q);let X=1;return I(q,ue=>{X*=ue}),X},c.DSTDEV=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);let q=[];return I(v,X=>{q.push(N[X])}),q=$t(q),dt.S(q)},c.DSTDEVP=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);let q=[];return I(v,X=>{q.push(N[X])}),q=$t(q),dt.P(q)},c.DSUM=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);const q=[];return I(v,X=>{q.push(N[X])}),It(q)},c.DURATION=function(){throw new Error("DURATION is not implemented")},c.DVAR=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);const q=[];return I(v,X=>{q.push(N[X])}),Ae.S(q)},c.DVARP=function(t,r,u){if(isNaN(r)&&typeof r!="string")return f;const v=Et(t,u);let N=[];if(typeof r=="string"){const X=Ee(t,r);N=oe(t[X])}else N=oe(t[r]);const q=[];return I(v,X=>{q.push(N[X])}),Ae.P(q)},c.EDATE=function(t,r){return(t=Xe(t))instanceof Error?t:isNaN(r)?f:(r=parseInt(r,10),t.setMonth(t.getMonth()+r),t)},c.EFFECT=function(t,r){return se(t=z(t),r=z(r))?f:t<=0||r<1?b:(r=parseInt(r,10),Math.pow(1+t/r,r)-1)},c.EOMONTH=function(t,r){return(t=Xe(t))instanceof Error?t:isNaN(r)?f:(r=parseInt(r,10),new Date(t.getFullYear(),t.getMonth()+r+1,0))},c.ERF=Wt,c.ERFC=Kt,c.ERFCPRECISE=Dn,c.ERFPRECISE=Rn,c.ERROR=Se,c.EVEN=function(t){return(t=z(t))instanceof Error?t:mt(t,-2,-1)},c.EXACT=function(t,r){return arguments.length!==2?T:ye(t,r)||(t=Qe(t))===Qe(r)},c.EXP=function(t){return arguments.length<1?T:arguments.length>1?O:(t=z(t))instanceof Error?t:t=Math.exp(t)},c.EXPON=ge,c.EXPONDIST=_n,c.F=fe,c.FACT=st,c.FACTDOUBLE=function t(r){if((r=z(r))instanceof Error)return r;const u=Math.floor(r);return u<=0?1:u*t(u-2)},c.FALSE=function(){return!1},c.FDIST=Fn,c.FDISTRT=kn,c.FIND=function(t,r,u){if(arguments.length<2)return T;t=Qe(t),u=u===void 0?0:u;const v=(r=Qe(r)).indexOf(t,u-1);return v===-1?f:v+1},c.FINV=Hn,c.FINVRT=Pn,c.FISHER=function(t){return(t=z(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},c.FISHERINV=function(t){if((t=z(t))instanceof Error)return t;const r=Math.exp(2*t);return(r-1)/(r+1)},c.FIXED=an,c.FLOOR=Lt,c.FLOORMATH=Bn,c.FLOORPRECISE=Vn,c.FORECAST=Re,c.FREQUENCY=function(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;const u=t.length,v=r.length,N=[];for(let q=0;q<=v;q++){N[q]=0;for(let X=0;X<u;X++)q===0?t[X]<=r[0]&&(N[0]+=1):q<v?t[X]>r[q-1]&&t[X]<=r[q]&&(N[q]+=1):q===v&&t[X]>r[v-1]&&(N[v]+=1)}return N},c.FTEST=Un,c.FV=Ot,c.FVSCHEDULE=function(t,r){if(se(t=z(t),r=Le(R(r))))return f;const u=r.length;let v=t;for(let N=0;N<u;N++)v*=1+r[N];return v},c.GAMMA=We,c.GAMMADIST=zn,c.GAMMAINV=qn,c.GAMMALN=Je,c.GAMMALNPRECISE=Yn,c.GAUSS=function(t){return(t=z(t))instanceof Error?t:g.normal.cdf(t,0,1)-.5},c.GCD=function(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=t.length,u=t[0];let v=u<0?-u:u;for(let N=1;N<r;N++){const q=t[N];let X=q<0?-q:q;for(;v&&X;)v>X?v%=X:X%=v;v+=X}return v},c.GEOMEAN=function(){const t=Le(R(arguments));return t instanceof Error?t:g.geomean(t)},c.GESTEP=function(t,r){return se(r=r||0,t=z(t))?t:t>=r?1:0},c.GROWTH=function(t,r,u,v){if((t=Le(t))instanceof Error)return t;let N;if(r===void 0)for(r=[],N=1;N<=t.length;N++)r.push(N);if(u===void 0)for(u=[],N=1;N<=t.length;N++)u.push(N);if(se(r=Le(r),u=Le(u)))return f;v===void 0&&(v=!0);const q=t.length;let X,ue,je=0,ke=0,$e=0,ot=0;for(N=0;N<q;N++){const lt=r[N],pt=Math.log(t[N]);je+=lt,ke+=pt,$e+=lt*pt,ot+=lt*lt}je/=q,ke/=q,$e/=q,ot/=q,v?(X=($e-je*ke)/(ot-je*je),ue=ke-X*je):(X=$e/ot,ue=0);const et=[];for(N=0;N<u.length;N++)et.push(Math.exp(ue+X*u[N]));return et},c.HARMEAN=function(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=t.length;let u=0;for(let v=0;v<r;v++)u+=1/t[v];return r/u},c.HEX2BIN=function(t,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return b;const u=!(t.length!==10||t.substring(0,1).toLowerCase()!=="f"),v=u?parseInt(t,16)-1099511627776:parseInt(t,16);if(v<-512||v>511)return b;if(u)return"1"+Ct("0",9-(512+v).toString(2).length)+(512+v).toString(2);const N=v.toString(2);return r===void 0?N:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=N.length?Ct("0",r-N.length)+N:b},c.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return b;const r=parseInt(t,16);return r>=549755813888?r-1099511627776:r},c.HEX2OCT=function(t,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return b;const u=parseInt(t,16);if(u>536870911&&u<0xffe0000000)return b;if(u>=0xffe0000000)return(u-0xffc0000000).toString(8);const v=u.toString(8);return r===void 0?v:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=v.length?Ct("0",r-v.length)+v:b},c.HLOOKUP=function(t,r,u,v){return d(t,be(r),u,v)},c.HOUR=function(t){return(t=Xe(t))instanceof Error?t:t.getHours()},c.HYPGEOM=Me,c.HYPGEOMDIST=Wn,c.IF=function(t,r,u){return t instanceof Error?t:((r=!(arguments.length>=2)||r)==null&&(r=0),(u=arguments.length===3&&u)==null&&(u=0),t?r:u)},c.IFERROR=function(t,r){return Pe(t)?r:t},c.IFNA=function(t,r){return t===T?r:t},c.IFS=function(){for(let t=0;t<arguments.length/2;t++)if(arguments[2*t])return arguments[2*t+1];return T},c.IMABS=Xt,c.IMAGINARY=bt,c.IMARGUMENT=Gt,c.IMCONJUGATE=function(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",u!==0?xt(r,-u,v):t},c.IMCOS=Bt,c.IMCOSH=ln,c.IMCOT=function(t){return se(vt(t),bt(t))?f:Nt(Bt(t),Vt(t))},c.IMCSC=function(t){return t===!0||t===!1?f:se(vt(t),bt(t))?b:Nt("1",Vt(t))},c.IMCSCH=function(t){return t===!0||t===!1?f:se(vt(t),bt(t))?b:Nt("1",cn(t))},c.IMDIV=Nt,c.IMEXP=function(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);v=v==="i"||v==="j"?v:"i";const N=Math.exp(r);return xt(N*Math.cos(u),N*Math.sin(u),v)},c.IMLN=function(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.log(Math.sqrt(r*r+u*u)),Math.atan(u/r),v)},c.IMLOG10=function(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.log(Math.sqrt(r*r+u*u))/Math.log(10),Math.atan(u/r)/Math.log(10),v)},c.IMLOG2=function(t){const r=vt(t),u=bt(t);if(se(r,u))return f;let v=t.substring(t.length-1);return v=v==="i"||v==="j"?v:"i",xt(Math.log(Math.sqrt(r*r+u*u))/Math.log(2),Math.atan(u/r)/Math.log(2),v)},c.IMPOWER=function(t,r){if(se(r=z(r),vt(t),bt(t)))return f;let u=t.substring(t.length-1);u=u==="i"||u==="j"?u:"i";const v=Math.pow(Xt(t),r),N=Gt(t);return xt(v*Math.cos(r*N),v*Math.sin(r*N),u)},c.IMPRODUCT=function(){let t=arguments[0];if(!arguments.length)return f;for(let r=1;r<arguments.length;r++){const u=vt(t),v=bt(t),N=vt(arguments[r]),q=bt(arguments[r]);if(se(u,v,N,q))return f;t=xt(u*N-v*q,u*q+v*N)}return t},c.IMREAL=vt,c.IMSEC=function(t){return t===!0||t===!1||se(vt(t),bt(t))?f:Nt("1",Bt(t))},c.IMSECH=function(t){return se(vt(t),bt(t))?f:Nt("1",ln(t))},c.IMSIN=Vt,c.IMSINH=cn,c.IMSQRT=function(t){if(se(vt(t),bt(t)))return f;let r=t.substring(t.length-1);r=r==="i"||r==="j"?r:"i";const u=Math.sqrt(Xt(t)),v=Gt(t);return xt(u*Math.cos(v/2),u*Math.sin(v/2),r)},c.IMSUB=function(t,r){const u=vt(t),v=bt(t),N=vt(r),q=bt(r);if(se(u,v,N,q))return f;const X=t.substring(t.length-1),ue=r.substring(r.length-1);let je="i";return(X==="j"||ue==="j")&&(je="j"),xt(u-N,v-q,je)},c.IMSUM=function(){if(!arguments.length)return f;const t=R(arguments);let r=t[0];for(let u=1;u<t.length;u++){const v=vt(r),N=bt(r),q=vt(t[u]),X=bt(t[u]);if(se(v,N,q,X))return f;r=xt(v+q,N+X)}return r},c.IMTAN=function(t){return t===!0||t===!1||se(vt(t),bt(t))?f:Nt(Vt(t),Bt(t))},c.INDEX=function(t,r,u){const v=ye(t,r,u);if(v)return v;if(!Array.isArray(t))return f;const N=t.length>0&&!Array.isArray(t[0]);return N&&!u?(u=r,r=1):(u=u||1,r=r||1),u<0||r<0?f:N&&r===1&&u<=t.length?t[u-1]:r<=t.length&&u<=t[r-1].length?t[r-1][u-1]:j},c.INFO=function(){throw new Error("INFO is not implemented")},c.INT=function(t){return(t=z(t))instanceof Error?t:Math.floor(t)},c.INTERCEPT=function(t,r){return se(t=Le(t),r=Le(r))?f:t.length!==r.length?T:Re(0,t,r)},c.INTRATE=function(){throw new Error("INTRATE is not implemented")},c.IPMT=un,c.IRR=function(t,r){if(r=r||0,se(t=Le(R(t)),r=z(r)))return f;const u=(et,lt,pt)=>{const gt=pt+1;let wt=et[0];for(let yt=1;yt<et.length;yt++)wt+=et[yt]/Math.pow(gt,(lt[yt]-lt[0])/365);return wt},v=(et,lt,pt)=>{const gt=pt+1;let wt=0;for(let yt=1;yt<et.length;yt++){const Tt=(lt[yt]-lt[0])/365;wt-=Tt*et[yt]/Math.pow(gt,Tt+1)}return wt},N=[];let q=!1,X=!1;for(let et=0;et<t.length;et++)N[et]=et===0?0:N[et-1]+365,t[et]>0&&(q=!0),t[et]<0&&(X=!0);if(!q||!X)return b;let ue,je,ke,$e=r=r===void 0?.1:r,ot=!0;do ke=u(t,N,$e),ue=$e-ke/v(t,N,$e),je=Math.abs(ue-$e),$e=ue,ot=je>1e-10&&Math.abs(ke)>1e-10;while(ot);return $e},c.ISBLANK=function(t){return t===null},c.ISERR=Be,c.ISERROR=Pe,c.ISEVEN=function(t){return!(1&Math.floor(Math.abs(t)))},c.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},c.ISLOGICAL=Ve,c.ISNA=function(t){return t===T},c.ISNONTEXT=function(t){return typeof t!="string"},c.ISNUMBER=Ue,c.ISO=dn,c.ISODD=function(t){return!!(1&Math.floor(Math.abs(t)))},c.ISOWEEKNUM=tn,c.ISPMT=function(t,r,u,v){return se(t=z(t),r=z(r),u=z(u),v=z(v))?f:v*t*(r/u-1)},c.ISREF=function(){throw new Error("ISREF is not implemented")},c.ISTEXT=E,c.KURT=function(){const t=Le(R(arguments));if(t instanceof Error)return t;const r=g.mean(t),u=t.length;let v=0;for(let N=0;N<u;N++)v+=Math.pow(t[N]-r,4);return v/=Math.pow(g.stdev(t,!0),4),u*(u+1)/((u-1)*(u-2)*(u-3))*v-3*(u-1)*(u-1)/((u-2)*(u-3))},c.LARGE=ze,c.LCM=function(){const t=Le(R(arguments));if(t instanceof Error)return t;for(var r,u,v,N,q=1;(v=t.pop())!==void 0;){if(v===0)return 0;for(;v>1;){if(v%2){for(r=3,u=Math.floor(Math.sqrt(v));r<=u&&v%r;r+=2);N=r<=u?r:v}else N=2;for(v/=N,q*=N,r=t.length;r;t[--r]%N==0&&(t[r]/=N)==1&&t.splice(r,1));}}return q},c.LEFT=function(t,r){return ye(t,r)||(t=Qe(t),(r=z(r=r===void 0?1:r))instanceof Error||typeof t!="string"?f:t.substring(0,r))},c.LEN=function(t){return arguments.length===0?O:t instanceof Error?t:Array.isArray(t)?f:Qe(t).length},c.LINEST=pe,c.LN=function(t){return(t=z(t))instanceof Error?t:t===0?b:Math.log(t)},c.LOG=function(t,r){return ye(t=z(t),r=z(r))||(t===0||r===0?b:Math.log(t)/Math.log(r))},c.LOG10=function(t){return(t=z(t))instanceof Error?t:t===0?b:Math.log(t)/Math.log(10)},c.LOGEST=function(t,r){if(se(t=Le(R(t)),r=Le(R(r)))||t.length!==r.length)return f;for(let v=0;v<t.length;v++)t[v]=Math.log(t[v]);const u=pe(t,r);return u[0]=Math.round(1e6*Math.exp(u[0]))/1e6,u[1]=Math.round(1e6*Math.exp(u[1]))/1e6,u},c.LOGINV=Kn,c.LOGNORM=He,c.LOGNORMDIST=Xn,c.LOGNORMINV=Gn,c.LOOKUP=function(t,r,u){r=R(r),u=u?R(u):r;const v=typeof t=="number";let N=T;for(let q=0;q<r.length;q++){if(r[q]===t)return u[q];if(v&&r[q]<=t||typeof r[q]=="string"&&r[q].localeCompare(t)<0)N=u[q];else if(v&&r[q]>t)return N}return N},c.LOWER=function(t){return arguments.length!==1?f:se(t=Qe(t))?t:t.toLowerCase()},c.MATCH=function(t,r,u){if(!t||!r||(arguments.length===2&&(u=1),!((r=R(r))instanceof Array))||u!==-1&&u!==0&&u!==1)return T;let v,N;for(let q=0;q<r.length;q++)if(u===1){if(r[q]===t)return q+1;r[q]<t&&(N?r[q]>N&&(v=q+1,N=r[q]):(v=q+1,N=r[q]))}else if(u===0){if(typeof t=="string"&&typeof r[q]=="string"){const X=t.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+X+"$").test(r[q].toLowerCase()))return q+1}else if(r[q]===t)return q+1}else if(u===-1){if(r[q]===t)return q+1;r[q]>t&&(N?r[q]<N&&(v=q+1,N=r[q]):(v=q+1,N=r[q]))}return v||T},c.MAX=Z,c.MAXA=function(){const t=R(arguments),r=ye.apply(void 0,t);if(r)return r;let u=P(t);return u=u.map(v=>v??0),u.length===0?0:Math.max.apply(Math,u)},c.MDURATION=function(){throw new Error("MDURATION is not implemented")},c.MEDIAN=K,c.MID=function(t,r,u){if(r==null)return f;if(se(r=z(r),u=z(u))||typeof t!="string")return u;const v=r-1,N=v+u;return t.substring(v,N)},c.MIN=ae,c.MINA=function(){const t=R(arguments),r=ye.apply(void 0,t);if(r)return r;let u=P(t);return u=u.map(v=>v??0),u.length===0?0:Math.min.apply(Math,u)},c.MINUTE=function(t){return(t=Xe(t))instanceof Error?t:t.getMinutes()},c.MIRR=function(t,r,u){if(se(t=Le(R(t)),r=z(r),u=z(u)))return f;const v=t.length,N=[],q=[];for(let je=0;je<v;je++)t[je]<0?N.push(t[je]):q.push(t[je]);const X=-Qt(u,q)*Math.pow(1+u,v-1),ue=Qt(r,N)*(1+r);return Math.pow(X/ue,1/(v-1))-1},c.MMULT=function(t,r){return!Array.isArray(t)||!Array.isArray(r)||t.some(u=>!u.length)||r.some(u=>!u.length)||Q(t).some(u=>typeof u!="number")||Q(r).some(u=>typeof u!="number")||t[0].length!==r.length?f:Array(t.length).fill(0).map(()=>Array(r[0].length).fill(0)).map((u,v)=>u.map((N,q)=>t[v].reduce((X,ue,je)=>X+ue*r[je][q],0)))},c.MOD=function(t,r){const u=ye(t=z(t),r=z(r));if(u)return u;if(r===0)return m;let v=Math.abs(t%r);return v=t<0?r-v:v,r>0?v:-v},c.MODE=A,c.MODEMULT=$n,c.MODESNGL=Jn,c.MONTH=function(t){return(t=Xe(t))instanceof Error?t:t.getMonth()+1},c.MROUND=function(t,r){return ye(t=z(t),r=z(r))||(t*r==0?0:t*r<0?b:Math.round(t/r)*r)},c.MULTINOMIAL=function(){const t=Le(R(arguments));if(t instanceof Error)return t;let r=0,u=1;for(let v=0;v<t.length;v++)r+=t[v],u*=st(t[v]);return st(r)/u},c.MUNIT=function(t){return arguments.length>1?T:!(t=parseInt(t))||t<=0?f:Array(t).fill(0).map(()=>Array(t).fill(0)).map((r,u)=>(r[u]=1,r))},c.N=function(t){return Ue(t)?t:t instanceof Date?t.getTime():t===!0?1:t===!1?0:Pe(t)?t:0},c.NA=function(){return T},c.NEGBINOM=W,c.NEGBINOMDIST=Zn,c.NETWORKDAYS=kt,c.NETWORKDAYSINTL=Qn,c.NOMINAL=function(t,r){return se(t=z(t),r=z(r))?f:t<=0||r<1?b:(r=parseInt(r,10),(Math.pow(t+1,1/r)-1)*r)},c.NORM=ee,c.NORMDIST=er,c.NORMINV=tr,c.NORMSDIST=nr,c.NORMSINV=rr,c.NOT=function(t){return typeof t=="string"?f:t instanceof Error?t:!t},c.NOW=function(){return new Date},c.NPER=function(t,r,u,v,N){if(N=N===void 0?0:N,v=v===void 0?0:v,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N)))return f;if(t===0)return-(u+v)/r;{const q=r*(1+t*N)-v*t,X=u*t+r*(1+t*N);return Math.log(q/X)/Math.log(1+t)}},c.NPV=Qt,c.NUMBERVALUE=function(t,r,u){return typeof(t=Ie(t)?t:"")=="number"?t:typeof t!="string"?T:(r=r===void 0?".":r,u=u===void 0?",":u,Number(t.replace(r,".").replace(u,"")))},c.OCT2BIN=function(t,r){if(!/^[0-7]{1,10}$/.test(t))return b;const u=!(t.length!==10||t.substring(0,1)!=="7"),v=u?parseInt(t,8)-1073741824:parseInt(t,8);if(v<-512||v>511)return b;if(u)return"1"+Ct("0",9-(512+v).toString(2).length)+(512+v).toString(2);const N=v.toString(2);return r===void 0?N:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=N.length?Ct("0",r-N.length)+N:b},c.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return b;const r=parseInt(t,8);return r>=536870912?r-1073741824:r},c.OCT2HEX=function(t,r){if(!/^[0-7]{1,10}$/.test(t))return b;const u=parseInt(t,8);if(u>=536870912)return"ff"+(u+3221225472).toString(16);const v=u.toString(16);return r===void 0?v:isNaN(r)?f:r<0?b:(r=Math.floor(r))>=v.length?Ct("0",r-v.length)+v:b},c.ODD=function(t){if((t=z(t))instanceof Error)return t;let r=Math.ceil(Math.abs(t));return r=1&r?r:r+1,t>=0?r:-r},c.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},c.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},c.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},c.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},c.OR=function(){const t=R(arguments);let r=f;for(let u=0;u<t.length;u++){if(t[u]instanceof Error)return t[u];t[u]!==void 0&&t[u]!==null&&typeof t[u]!="string"&&(r===f&&(r=!1),t[u]&&(r=!0))}return r},c.PDURATION=function(t,r,u){return se(t=z(t),r=z(r),u=z(u))?f:t<=0?b:(Math.log(u)-Math.log(r))/Math.log(1+t)},c.PEARSON=me,c.PERCENTILE=re,c.PERCENTILEEXC=or,c.PERCENTILEINC=ir,c.PERCENTRANK=he,c.PERCENTRANKEXC=sr,c.PERCENTRANKINC=ar,c.PERMUT=function(t,r){return se(t=z(t),r=z(r))?f:st(t)/st(t-r)},c.PERMUTATIONA=function(t,r){return se(t=z(t),r=z(r))?f:Math.pow(t,r)},c.PHI=function(t){return(t=z(t))instanceof Error?f:Math.exp(-.5*t*t)/2.5066282746310002},c.PI=function(){return Math.PI},c.PMT=Rt,c.POISSON=Te,c.POISSONDIST=lr,c.POWER=en,c.PPMT=function(t,r,u,v,N,q){return N=N||0,q=q||0,se(t=z(t),u=z(u),v=z(v),N=z(N),q=z(q))?f:Rt(t,u,v,N,q)-un(t,r,u,v,N,q)},c.PRICE=function(){throw new Error("PRICE is not implemented")},c.PRICEDISC=function(t,r,u,v,N){if(se(t=Xe(t),r=Xe(r),u=z(u),v=z(v),N=(N=z(N))||0))return f;if(u<=0||v<=0)return b;if(t>=r)return f;let q,X;switch(N){case 0:q=360,X=Mt(t,r,!1);break;case 1:case 3:q=365,X=Dt(t,r,"D");break;case 2:q=360,X=Dt(t,r,"D");break;case 4:q=360,X=Mt(t,r,!0);break;default:return b}return v-u*v*X/q},c.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},c.PROB=function(t,r,u,v){if(u===void 0)return 0;if(v=v===void 0?u:v,se(t=Le(R(t)),r=Le(R(r)),u=z(u),v=z(v)))return f;if(u===v)return t.indexOf(u)>=0?r[t.indexOf(u)]:0;const N=t.sort((ue,je)=>ue-je),q=N.length;let X=0;for(let ue=0;ue<q;ue++)N[ue]>=u&&N[ue]<=v&&(X+=r[t.indexOf(N[ue])]);return X},c.PRODUCT=Ut,c.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},c.PROPER=function(t){return se(t)?t:isNaN(t)&&typeof t=="number"?f:(t=Qe(t)).replace(/\w\S*/g,r=>r.charAt(0).toUpperCase()+r.substr(1).toLowerCase())},c.PV=function(t,r,u,v,N){return v=v||0,N=N||0,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N))?f:t===0?-u*r-v:((1-Math.pow(1+t,r))/t*u*(1+t*N)-v)/Math.pow(1+t,r)},c.QUARTILE=Ge,c.QUARTILEEXC=cr,c.QUARTILEINC=ur,c.QUOTIENT=function(t,r){return ye(t=z(t),r=z(r))||parseInt(t/r,10)},c.RADIANS=function(t){return(t=z(t))instanceof Error?t:t*Math.PI/180},c.RAND=function(){return Math.random()},c.RANDBETWEEN=function(t,r){return ye(t=z(t),r=z(r))||t+Math.ceil((r-t+1)*Math.random())-1},c.RANK=De,c.RANKAVG=dr,c.RANKEQ=fr,c.RATE=function(t,r,u,v,N,q){if(q=q===void 0?.01:q,v=v===void 0?0:v,N=N===void 0?0:N,se(t=z(t),r=z(r),u=z(u),v=z(v),N=z(N),q=z(q)))return f;const X=1e-10;let ue=q;N=N?1:0;for(let je=0;je<20;je++){if(ue<=-1)return b;let ke,$e,ot;if(Math.abs(ue)<X?ke=u*(1+t*ue)+r*(1+ue*N)*t+v:($e=Math.pow(1+ue,t),ke=u*$e+r*(1/ue+N)*($e-1)+v),Math.abs(ke)<X)return ue;if(Math.abs(ue)<X)ot=u*t+r*N*t;else{$e=Math.pow(1+ue,t);const et=t*Math.pow(1+ue,t-1);ot=u*et+r*(1/ue+N)*et+r*(-1/(ue*ue))*($e-1)}ue-=ke/ot}return ue},c.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},c.REPLACE=function(t,r,u,v){return se(r=z(r),u=z(u))||typeof t!="string"||typeof v!="string"?f:t.substr(0,r-1)+v+t.substr(r-1+u)},c.REPT=Ct,c.RIGHT=function(t,r){return ye(t,r)||(t=Qe(t),(r=z(r=r===void 0?1:r))instanceof Error?r:t.substring(t.length-r))},c.ROMAN=function(t){if((t=z(t))instanceof Error)return t;const r=String(t).split(""),u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let v="",N=3;for(;N--;)v=(u[+r.pop()+10*N]||"")+v;return new Array(+r.join("")+1).join("M")+v},c.ROUND=At,c.ROUNDDOWN=function(t,r){return ye(t=z(t),r=z(r))||(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,r))/Math.pow(10,r)},c.ROUNDUP=function(t,r){return ye(t=z(t),r=z(r))||(t>0?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,r))/Math.pow(10,r)},c.ROW=function(t,r){return arguments.length!==2?T:r<0?b:t instanceof Array&&typeof r=="number"?t.length!==0?g.row(t,r):void 0:f},c.ROWS=function(t){return arguments.length!==1?T:t instanceof Array?t.length===0?0:g.rows(t):f},c.RRI=function(t,r,u){return se(t=z(t),r=z(r),u=z(u))?f:t===0||r===0?b:Math.pow(u/r,1/t)-1},c.RSQ=function(t,r){return se(t=Le(R(t)),r=Le(R(r)))?f:Math.pow(me(t,r),2)},c.SEARCH=function(t,r,u){let v;return typeof t!="string"||typeof r!="string"?f:(u=u===void 0?0:u,v=r.toLowerCase().indexOf(t.toLowerCase(),u-1)+1,v===0?f:v)},c.SEC=function(t){return(t=z(t))instanceof Error?t:1/Math.cos(t)},c.SECH=function(t){return(t=z(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},c.SECOND=function(t){return(t=Xe(t))instanceof Error?t:t.getSeconds()},c.SERIESSUM=function(t,r,u,v){if(se(t=z(t),r=z(r),u=z(u),v=Le(v)))return f;let N=v[0]*Math.pow(t,r);for(let q=1;q<v.length;q++)N+=v[q]*Math.pow(t,r+q*u);return N},c.SHEET=function(){throw new Error("SHEET is not implemented")},c.SHEETS=function(){throw new Error("SHEETS is not implemented")},c.SIGN=function(t){return(t=z(t))instanceof Error?t:t<0?-1:t===0?0:1},c.SIN=function(t){return(t=z(t))instanceof Error?t:Math.sin(t)},c.SINH=function(t){return(t=z(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},c.SKEW=Ze,c.SKEWP=pr,c.SLN=function(t,r,u){return se(t=z(t),r=z(r),u=z(u))?f:u===0?b:(t-r)/u},c.SLOPE=function(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;const u=g.mean(r),v=g.mean(t),N=r.length;let q=0,X=0;for(let ue=0;ue<N;ue++)q+=(r[ue]-u)*(t[ue]-v),X+=Math.pow(r[ue]-u,2);return q/X},c.SMALL=it,c.SORT=function(t,r=1,u=1,v=!1){if(!t||!Array.isArray(t))return T;if(t.length===0)return 0;if(!(r=z(r))||r<1||(u=z(u))!==1&&u!==-1)return f;if(typeof(v=_e(v))!="boolean")return C;const N=ue=>ue.sort((je,ke)=>(je=Qe(je[r-1]),ke=Qe(ke[r-1]),u===1?je<ke?-1*u:u:je>ke?u:-1*u)),q=V(t),X=v?be(q):q;return r>=1&&r<=X[0].length?v?be(N(X)):N(X):f},c.SQRT=function(t){return(t=z(t))instanceof Error?t:t<0?b:Math.sqrt(t)},c.SQRTPI=function(t){return(t=z(t))instanceof Error?t:Math.sqrt(t*Math.PI)},c.STANDARDIZE=function(t,r,u){return se(t=z(t),r=z(r),u=z(u))?f:(t-r)/u},c.STDEV=dt,c.STDEVA=function(){const t=Ne.apply(this,arguments);return Math.sqrt(t)},c.STDEVP=hr,c.STDEVPA=function(){const t=nt.apply(this,arguments);let r=Math.sqrt(t);return isNaN(r)&&(r=b),r},c.STDEVS=gr,c.STEYX=function(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;const u=g.mean(r),v=g.mean(t),N=r.length;let q=0,X=0,ue=0;for(let je=0;je<N;je++)q+=Math.pow(t[je]-v,2),X+=(r[je]-u)*(t[je]-v),ue+=Math.pow(r[je]-u,2);return Math.sqrt((q-X*X/ue)/(N-2))},c.SUBSTITUTE=function(t,r,u,v){if(arguments.length<3)return T;if(t&&r){if(v===void 0)return t.split(r).join(u);{if(v=Math.floor(Number(v)),Number.isNaN(v)||v<=0)return f;let N=0,q=0;for(;N>-1&&t.indexOf(r,N)>-1;)if(N=t.indexOf(r,N+1),q++,N>-1&&q===v)return t.substring(0,N)+u+t.substring(N+r.length);return t}}return t},c.SUBTOTAL=function(t,r){if((t=z(t))instanceof Error)return t;switch(t){case 1:case 101:return l(r);case 2:case 102:return Y(r);case 3:case 103:return J(r);case 4:case 104:return Z(r);case 5:case 105:return ae(r);case 6:case 106:return Ut(r);case 7:case 107:return dt.S(r);case 8:case 108:return dt.P(r);case 9:case 109:return It(r);case 10:case 110:return Ae.S(r);case 11:case 111:return Ae.P(r)}},c.SUM=It,c.SUMIF=function(t,r,u){if(t=R(t),u=u?R(u):t,t instanceof Error)return t;if(r==null||r instanceof Error)return 0;let v=0;const N=r==="*",q=N?null:ve(r+"");for(let X=0;X<t.length;X++){const ue=t[X],je=u[X];if(N)v+=ue;else{const ke=[ce(ue,te)].concat(q);v+=Ce(ke)?je:0}}return v},c.SUMIFS=function(){const t=B(arguments),r=Le(R(t.shift()));if(r instanceof Error)return r;const u=t,v=u.length/2;for(let q=0;q<v;q++)u[2*q]=R(u[2*q]);let N=0;for(let q=0;q<r.length;q++){let X=!1;for(let ue=0;ue<v;ue++){const je=u[2*ue][q],ke=u[2*ue+1];let $e=!1;if(ke===void 0||ke==="*")$e=!0;else{const ot=ve(ke+""),et=[ce(je,te)].concat(ot);$e=Ce(et)}if(!$e){X=!1;break}X=!0}X&&(N+=r[q])}return N},c.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return f;const t=arguments.length+1;let r,u,v,N,q=0;for(let X=0;X<arguments[0].length;X++)if(arguments[0][X]instanceof Array)for(let ue=0;ue<arguments[0][X].length;ue++){for(r=1,u=1;u<t;u++){const je=arguments[u-1][X][ue];if(je instanceof Error)return je;if(N=z(je),N instanceof Error)return N;r*=N}q+=r}else{for(r=1,u=1;u<t;u++){const ue=arguments[u-1][X];if(ue instanceof Error)return ue;if(v=z(ue),v instanceof Error)return v;r*=v}q+=r}return q},c.SUMSQ=function(){const t=Le(R(arguments));if(t instanceof Error)return t;let r=0;const u=t.length;for(let v=0;v<u;v++)r+=Ue(t[v])?t[v]*t[v]:0;return r},c.SUMX2MY2=function(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;let u=0;for(let v=0;v<t.length;v++)u+=t[v]*t[v]-r[v]*r[v];return u},c.SUMX2PY2=function(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;let u=0;t=Le(R(t)),r=Le(R(r));for(let v=0;v<t.length;v++)u+=t[v]*t[v]+r[v]*r[v];return u},c.SUMXMY2=function(t,r){if(se(t=Le(R(t)),r=Le(R(r))))return f;let u=0;t=R(t),r=R(r);for(let v=0;v<t.length;v++)u+=Math.pow(t[v]-r[v],2);return u},c.SWITCH=function(){let t;if(arguments.length>0){const r=arguments[0],u=arguments.length-1,v=Math.floor(u/2);let N=!1;const q=u%2!=0,X=u%2==0?null:arguments[arguments.length-1];if(v){for(let ue=0;ue<v;ue++)if(r===arguments[2*ue+1]){t=arguments[2*ue+2],N=!0;break}}N||(t=q?X:T)}else t=f;return t},c.SYD=function(t,r,u,v){return se(t=z(t),r=z(r),u=z(u),v=z(v))?f:u===0||v<1||v>u?b:(t-r)*(u-(v=parseInt(v,10))+1)*2/(u*(u+1))},c.T=function(t){return t instanceof Error||typeof t=="string"?t:""},c.TAN=function(t){return(t=z(t))instanceof Error?t:Math.tan(t)},c.TANH=function(t){if((t=z(t))instanceof Error)return t;const r=Math.exp(2*t);return(r-1)/(r+1)},c.TBILLEQ=function(t,r,u){return se(t=Xe(t),r=Xe(r),u=z(u))?f:u<=0||t>r||r-t>31536e6?b:365*u/(360-u*Mt(t,r,!1))},c.TBILLPRICE=function(t,r,u){return se(t=Xe(t),r=Xe(r),u=z(u))?f:u<=0||t>r||r-t>31536e6?b:100*(1-u*Mt(t,r,!1)/360)},c.TBILLYIELD=function(t,r,u){return se(t=Xe(t),r=Xe(r),u=z(u))?f:u<=0||t>r||r-t>31536e6?b:360*(100-u)/(u*Mt(t,r,!1))},c.TDIST=mr,c.TDISTRT=br,c.TEXT=function(t,r){if(t===void 0||t instanceof Error||r instanceof Error)return T;if(r==null)return"";if(typeof r=="number")return String(r);if(typeof r!="string")return f;const u=r.startsWith("$")?"$":"",v=r.endsWith("%");return v&&(t*=100),t=(t=an(t,(r=r.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!r.includes(","))).startsWith("-")?"-"+u+(t=t.replace("-","")):u+t,v&&(t+="%"),t},c.TEXTJOIN=function(t,r,...u){if(typeof r!="boolean"&&(r=_e(r)),arguments.length<3)return T;t=t??"";let v=R(u),N=r?v.filter(q=>q):v;if(Array.isArray(t)){t=R(t);let q=N.map(ue=>[ue]),X=0;for(let ue=0;ue<q.length-1;ue++)q[ue].push(t[X]),X++,X===t.length&&(X=0);return N=R(q),N.join("")}return N.join(t)},c.TIME=function(t,r,u){return se(t=z(t),r=z(r),u=z(u))?f:t<0||r<0||u<0?b:(3600*t+60*r+u)/86400},c.TIMEVALUE=function(t){return(t=Xe(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},c.TINV=vr,c.TODAY=function(){return Ft(new Date)},c.TRANSPOSE=function(t){return t?be(V(t)):T},c.TREND=function(t,r,u){if(se(t=Le(R(t)),r=Le(R(r)),u=Le(R(u))))return f;const v=pe(t,r),N=v[0],q=v[1],X=[];return u.forEach(ue=>{X.push(N*ue+q)}),X},c.TRIM=function(t){return(t=Qe(t))instanceof Error?t:t.replace(/\s+/g," ").trim()},c.TRIMMEAN=function(t,r){if(se(t=Le(R(t)),r=z(r)))return f;const u=Lt(t.length*r,2)/2;return g.mean((N=(N=u)||1,(v=oe(t.sort((q,X)=>q-X),u))&&typeof v.slice=="function"?v.slice(0,v.length-N):v));var v,N},c.TRUE=function(){return!0},c.TRUNC=function(t,r){return ye(t=z(t),r=z(r))||(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,r))/Math.pow(10,r)},c.TTEST=jr,c.TYPE=function(t){return Ue(t)?1:E(t)?2:Ve(t)?4:Pe(t)?16:Array.isArray(t)?64:void 0},c.UNICHAR=bn,c.UNICODE=vn,c.UNIQUE=M,c.UPPER=function(t){return(t=Qe(t))instanceof Error?t:t.toUpperCase()},c.VALUE=function(t){const r=ye(t);if(r)return r;if(typeof t=="number")return t;if(Ie(t)||(t=""),typeof t!="string")return f;const u=/(%)$/.test(t)||/^(%)/.test(t);if((t=(t=(t=t.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let v=Number(t);return isNaN(v)?f:(v=v||0,u&&(v*=.01),v)},c.VAR=Ae,c.VARA=Ne,c.VARP=yr,c.VARPA=nt,c.VARS=xr,c.VDB=function(){throw new Error("VDB is not implemented")},c.VLOOKUP=d,c.WEEKDAY=function(t,r){if((t=Xe(t))instanceof Error)return t;r===void 0&&(r=1);const u=t.getDay();return gn[r][u]},c.WEEKNUM=function(t,r){if((t=Xe(t))instanceof Error)return t;if(r===void 0&&(r=1),r===21)return tn(t);const u=hn[r];let v=new Date(t.getFullYear(),0,1);const N=v.getDay()<u?1:0;return v-=24*Math.abs(v.getDay()-u)*60*60*1e3,Math.floor((t-v)/864e5/7+1)+N},c.WEIBULL=ht,c.WEIBULLDIST=wr,c.WORKDAY=Ht,c.WORKDAYINTL=Cr,c.XIRR=function(t,r,u){if(se(t=Le(R(t)),r=at(R(r)),u=z(u)))return f;const v=(et,lt,pt)=>{const gt=pt+1;let wt=et[0];for(let yt=1;yt<et.length;yt++)wt+=et[yt]/Math.pow(gt,St(lt[yt],lt[0])/365);return wt},N=(et,lt,pt)=>{const gt=pt+1;let wt=0;for(let yt=1;yt<et.length;yt++){const Tt=St(lt[yt],lt[0])/365;wt-=Tt*et[yt]/Math.pow(gt,Tt+1)}return wt};let q=!1,X=!1;for(let et=0;et<t.length;et++)t[et]>0&&(q=!0),t[et]<0&&(X=!0);if(!q||!X)return b;let ue,je,ke,$e=u=u||.1,ot=!0;do ke=v(t,r,$e),ue=$e-ke/N(t,r,$e),je=Math.abs(ue-$e),$e=ue,ot=je>1e-10&&Math.abs(ke)>1e-10;while(ot);return $e},c.XNPV=function(t,r,u){if(se(t=z(t),r=Le(R(r)),u=at(R(u))))return f;let v=0;for(let N=0;N<r.length;N++)v+=r[N]/Math.pow(1+t,St(u[N],u[0])/365);return v},c.XOR=function(){const t=R(arguments);let r=f;for(let u=0;u<t.length;u++){if(t[u]instanceof Error)return t[u];t[u]!==void 0&&t[u]!==null&&typeof t[u]!="string"&&(r===f&&(r=0),t[u]&&r++)}return r===f?r:!!(1&Math.floor(Math.abs(r)))},c.YEAR=function(t){return(t=Xe(t))instanceof Error?t:t.getFullYear()},c.YEARFRAC=qt,c.YIELD=function(){throw new Error("YIELD is not implemented")},c.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},c.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},c.Z=ut,c.ZTEST=Er,c.utils=Ar}},s={};function h(L){var c=s[L];if(c!==void 0)return c.exports;var a=s[L]={exports:{}};return o[L].call(a.exports,a,a.exports,h),a.exports}h.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var w=h(960);n=w}(),n)},138:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(243);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(e){var n=(""+e)[0];return n=="="||n=="#"},getMask=function(e){if(e.format||e.mask||e.locale){var n={};return e.mask?n.mask=e.mask:e.format?n.mask=e.format:(n.locale=e.locale,n.options=e.options),e.decimal&&(n.options||(n.options={}),n.options={decimal:e.decimal}),n}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){e==null&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,e==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var n=obj.options.onevent.apply(this,arguments);typeof obj.options[e]=="function"&&(n=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if(e=="onafterchanges"&&obj.options.persistance){var o=obj.options.persistance==1?obj.options.url:obj.options.persistance,s=obj.prepareJson(arguments[2]);obj.save(o,s)}return n},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var n=Object.keys(obj.options.data[0]);n.length>e&&(e=n.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var o=[],s=0;s<e;s++)obj.options.colHeaders[s]||(obj.options.colHeaders[s]=""),obj.options.colWidths[s]||(obj.options.colWidths[s]=obj.options.defaultColWidth),obj.options.colAlignments[s]||(obj.options.colAlignments[s]=obj.options.defaultColAlign),obj.options.columns[s]?obj.options.columns[s].type||(obj.options.columns[s].type="text"):obj.options.columns[s]={type:"text"},obj.options.columns[s].name||(obj.options.columns[s].name=n&&n[s]?n[s]:s),obj.options.columns[s].source||(obj.options.columns[s].source=[]),obj.options.columns[s].options||(obj.options.columns[s].options=[]),obj.options.columns[s].editor||(obj.options.columns[s].editor=null),obj.options.columns[s].allowEmpty||(obj.options.columns[s].allowEmpty=!1),obj.options.columns[s].title||(obj.options.columns[s].title=obj.options.colHeaders[s]?obj.options.colHeaders[s]:""),obj.options.columns[s].width||(obj.options.columns[s].width=obj.options.colWidths[s]?obj.options.colWidths[s]:obj.options.defaultColWidth),obj.options.columns[s].align||(obj.options.columns[s].align=obj.options.colAlignments[s]?obj.options.colAlignments[s]:"center"),obj.options.columns[s].type=="autocomplete"||obj.options.columns[s].type=="dropdown"?obj.options.columns[s].url&&o.push({url:obj.options.columns[s].url,index:s,method:"GET",dataType:"json",success:function(h){for(var w=0;w<h.length;w++)obj.options.columns[this.index].source.push(h[w])}}):obj.options.columns[s].type=="calendar"&&(obj.options.columns[s].options.format||(obj.options.columns[s].options.format="DD/MM/YYYY"));o.length?jSuites.ajax(o,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(b){obj.scrollControls(b)},obj.content.onwheel=function(b){obj.wheelControls(b)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),n=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(n),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var o=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var s=0;s<obj.options.paginationOptions.length;s++){var h=document.createElement("option");h.value=obj.options.paginationOptions[s],h.innerHTML=obj.options.paginationOptions[s],obj.paginationDropdown.appendChild(h)}obj.paginationDropdown.value=obj.options.pagination,o.appendChild(document.createTextNode(obj.options.text.show)),o.appendChild(obj.paginationDropdown),o.appendChild(document.createTextNode(obj.options.text.entries))}var w,L=document.createElement("div");if(L.classList.add("jexcel_filter"),L.appendChild(o),L.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(w=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(w),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var c=0;c<obj.options.nestedHeaders.length;c++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[c]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(w=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(w),s=0;s<obj.options.columns.length;s++)obj.createCellHeader(s),obj.headerContainer.appendChild(obj.headers[s]),obj.colgroupContainer.appendChild(obj.colgroup[s]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var a=document.createElement("td");for(obj.filter.appendChild(a),s=0;s<obj.options.columns.length;s++)(a=document.createElement("td")).innerHTML="&nbsp;",a.setAttribute("data-x",s),a.className="jexcel_column_filter",obj.options.columns[s].type=="hidden"&&(a.style.display="none"),obj.filter.appendChild(a);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var g=document.createElement("a");g.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage<"u"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var D=document.createElement("img");D.src="//bossanova.uk/jspreadsheet/logo.png",g.appendChild(D)}}catch{}var H=document.createElement("span");H.innerHTML="Jspreadsheet CE",g.appendChild(H),obj.ads.appendChild(g),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var m=document.createElement("div"),f=document.createElement("div");if(obj.pagination.appendChild(m),obj.pagination.appendChild(f),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(L),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var j=Object.keys(obj.options.classes);for(s=0;s<j.length;s++){var C=jexcel.getIdFromColumnName(j[s],!0);obj.records[C[1]][C[0]].classList.add(obj.options.classes[j[s]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&(typeof e=="string"&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var n=0;n<obj.options.data.length;n++){for(var o=[],s=0;s<obj.options.columns.length;s++)o[s]=obj.options.data[n][obj.options.columns[s].name];e.push(o)}obj.options.data=e}n=0,s=0;var h=obj.options.columns.length,w=obj.options.data.length,L=obj.options.minDimensions[0],c=obj.options.minDimensions[1],a=L>h?L:h,g=c>w?c:w;for(n=0;n<g;n++)for(s=0;s<a;s++)obj.options.data[n]==null&&(obj.options.data[n]=[]),obj.options.data[n][s]==null&&(obj.options.data[n][s]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var D=0,H=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,D=obj.options.pagination*obj.pageNumber,H=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<H&&(H=obj.options.data.length)):(D=0,H=obj.options.data.length);for(n=0;n<obj.options.data.length;n++){var m=obj.createRow(n,obj.options.data[n]);n>=D&&n<H&&obj.tbody.appendChild(m)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var f=Object.keys(obj.options.mergeCells);for(s=0;s<f.length;s++){var j=obj.options.mergeCells[f[s]];obj.setMerge(f[s],j[0],j[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,n){for(var o=[],s=0,h=0,w=n==1||obj.options.copyCompatibility==0,L=obj.options.columns.length,c=obj.options.data.length,a=0;a<c;a++){s=0;for(var g=0;g<L;g++)e&&!obj.records[a][g].classList.contains("highlight")||(o[h]||(o[h]=[]),o[h][s]=w?obj.options.data[a][g]:obj.records[a][g].innerHTML,s++);s>0&&h++}return o},obj.getJsonRow=function(e){for(var n=obj.options.data[e],o=obj.options.columns.length,s={},h=0;h<o;h++)obj.options.columns[h].name||(obj.options.columns[h].name=h),s[obj.options.columns[h].name]=n[h];return s},obj.getJson=function(e){for(var n=[],o=obj.options.columns.length,s=obj.options.data.length,h=0;h<s;h++){for(var w=null,L=0;L<o;L++)e&&!obj.records[h][L].classList.contains("highlight")||(w==null&&(w={}),obj.options.columns[L].name||(obj.options.columns[L].name=L),w[obj.options.columns[L].name]=obj.options.data[h][L]);w!=null&&n.push(w)}return n},obj.prepareJson=function(e){for(var n=[],o=0;o<e.length;o++){var s=e[o].x,h=e[o].y,w=obj.options.columns[s].name?obj.options.columns[s].name:s;n[h]||(n[h]={row:h,data:{}}),n[h].data[w]=e[o].newValue}return n.filter(function(L){return L!=null})},obj.save=function(e,n){var o=obj.dispatch("onbeforesave",el,obj,n);if(o)n=o;else if(o===!1)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(n)},success:function(s){obj.dispatch("onsave",el,obj,n)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,n){for(var o=0;o<obj.headers.length;o++){var s=jexcel.getColumnNameFromId([o,e]);n[o]!=null&&obj.setValue(s,n[o])}},obj.getColumnData=function(e){for(var n=[],o=0;o<obj.options.data.length;o++)n.push(obj.options.data[o][e]);return n},obj.setColumnData=function(e,n){for(var o=0;o<obj.rows.length;o++){var s=jexcel.getColumnNameFromId([e,o]);n[o]!=null&&obj.setValue(s,n[o])}},obj.createRow=function(e,n){obj.records[e]||(obj.records[e]=[]),n||(n=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var o=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(o=obj.options.rows[e].title)),o||(o=parseInt(e+1));var s=document.createElement("td");s.innerHTML=o,s.setAttribute("data-y",e),s.className="jexcel_row",obj.rows[e].appendChild(s);for(var h=0;h<obj.options.columns.length;h++)obj.records[e][h]=obj.createCell(h,e,n[h]),obj.rows[e].appendChild(obj.records[e][h]);return obj.rows[e]},obj.parseValue=function(e,n,o,s){(""+o).substr(0,1)=="="&&obj.options.parseFormulas==1&&(o=obj.executeFormula(o,e,n));var h=obj.options.columns[e];if(h&&!isFormula(o)){var w=null;if(w=getMask(h)){o&&o==Number(o)&&(o=Number(o));var L=jSuites.mask.render(o,w,!0);if(s&&w.mask){var c=w.mask.split(";");c[1]&&(c[1].match(new RegExp("\\[Red\\]","gi"))&&(o<0?s.classList.add("red"):s.classList.remove("red")),c[1].match(new RegExp("\\(","gi"))&&o<0&&(L="("+L+")"))}L&&(o=L)}}return o};var validDate=function(e){return(e=""+e).substr(4,1)=="-"&&e.substr(7,1)=="-"||(e=e.split("-"))[0].length==4&&e[0]==Number(e[0])&&e[1].length==2&&e[1]==Number(e[1])};obj.createCell=function(e,n,o){var s=document.createElement("td");if(s.setAttribute("data-x",e),s.setAttribute("data-y",n),(""+o).substr(0,1)=="="&&obj.options.secureFormulas==1){var h=secureFormula(o);h!=o&&(o=h)}if(obj.options.columns[e].editor)obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?s.innerHTML=o:s.textContent=o,typeof obj.options.columns[e].editor.createCell=="function"&&(s=obj.options.columns[e].editor.createCell(s));else if(obj.options.columns[e].type=="hidden")s.style.display="none",s.textContent=o;else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){var w=document.createElement("input");w.type=obj.options.columns[e].type,w.name="c"+e,w.checked=o==1||o==1||o=="true",w.onclick=function(){obj.setValue(s,this.checked)},obj.options.columns[e].readOnly!=1&&obj.options.editable!=0||w.setAttribute("disabled","disabled"),s.appendChild(w),obj.options.data[n][e]=w.checked}else if(obj.options.columns[e].type=="calendar"){var L=null;if(!validDate(o)){var c=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);c&&(L=c)}s.textContent=jSuites.calendar.getDateString(L||o,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")s.classList.add("jexcel_dropdown"),s.textContent=obj.getDropDownValue(e,o);else if(obj.options.columns[e].type=="color")if(obj.options.columns[e].render=="square"){var a=document.createElement("div");a.className="color",a.style.backgroundColor=o,s.appendChild(a)}else s.style.color=o,s.textContent=o;else if(obj.options.columns[e].type=="image"){if(o&&o.substr(0,10)=="data:image"){var g=document.createElement("img");g.src=o,s.appendChild(g)}}else obj.options.columns[e].type=="html"||obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?s.innerHTML=stripScript(obj.parseValue(e,n,o,s)):s.textContent=obj.parseValue(e,n,o,s);obj.options.columns[e].readOnly==1&&(s.className="readonly");var D=obj.options.columns[e].align?obj.options.columns[e].align:"center";return s.style.textAlign=D,obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||s.innerHTML.length>200)&&(s.style.whiteSpace="pre-wrap"),e>0&&this.options.textOverflow==1&&(o||s.innerHTML?obj.records[n][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(s.style.overflow="hidden")),s},obj.createCellHeader=function(e){var n=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,o=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=o,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",n),obj.options.columns[e].type=="hidden"&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,n,o){obj.options.nestedHeaders[n][e].title&&(obj.options.nestedHeaders[n][e].title=o,obj.options.nestedHeaders[n].element.children[e+1].textContent=o)},obj.createNestedHeader=function(e){var n=document.createElement("tr");n.classList.add("jexcel_nested");var o=document.createElement("td");n.appendChild(o),e.element=n;for(var s=0,h=0;h<e.length;h++){e[h].colspan||(e[h].colspan=1),e[h].align||(e[h].align="center"),e[h].title||(e[h].title=""),e[h].id||(e[h].id="");for(var w=e[h].colspan,L=[],c=0;c<w;c++)obj.options.columns[s]&&obj.options.columns[s].type=="hidden"&&w++,L.push(s),s++;(o=document.createElement("td")).setAttribute("data-column",L.join(",")),o.setAttribute("colspan",e[h].colspan),o.setAttribute("align",e[h].align),o.setAttribute("id",e[h].id),o.textContent=e[h].title,n.appendChild(o)}return n},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var n=0;n<e.length;n++)if(e[n].type=="i")(w=document.createElement("i")).classList.add("jexcel_toolbar_item"),w.classList.add("material-icons"),w.setAttribute("data-k",e[n].k),w.setAttribute("data-v",e[n].v),w.setAttribute("id",e[n].id),e[n].tooltip&&w.setAttribute("title",e[n].tooltip),e[n].onclick&&(e[n].onclick,1)?w.onclick=function(L){var c=L;return function(){e[c].onclick(el,obj,this)}}(n):w.onclick=function(){var L=this.getAttribute("data-k"),c=this.getAttribute("data-v");obj.setStyle(obj.highlighted,L,c)},w.textContent=e[n].content,obj.toolbar.appendChild(w);else if(e[n].type=="select"){var o=!1;(w=document.createElement("select")).classList.add("jexcel_toolbar_item"),w.setAttribute("data-k",e[n].k),e[n].tooltip&&w.setAttribute("title",e[n].tooltip),e[n].onchange&&(e[n].onchange,1)?(w.onchange=e[n].onchange,o=!0):w.onchange=function(){var L=this.getAttribute("data-k");obj.setStyle(obj.highlighted,L,this.value)};for(var s=0;s<e[n].v.length;s++){var h=document.createElement("option");h.value=e[n].v[s],h.textContent=e[n].v[s],e[n].selectedValue&&h.value===e[n].selectedValue&&(h.selected=!0),w.appendChild(h)}o&&w.dispatchEvent(new Event("change")),obj.toolbar.appendChild(w)}else if(e[n].type=="color"){var w;(w=document.createElement("i")).classList.add("jexcel_toolbar_item"),w.classList.add("material-icons"),w.setAttribute("data-k",e[n].k),w.setAttribute("data-v",""),e[n].tooltip&&w.setAttribute("title",e[n].tooltip),obj.toolbar.appendChild(w),w.textContent=e[n].content,jSuites.color(w,{onchange:function(L,c){var a=L.getAttribute("data-k");obj.setStyle(obj.highlighted,a,c)}})}},obj.setMerge=function(e,n,o,s){var h=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var w=parseInt(obj.highlighted[0].getAttribute("data-x")),L=parseInt(obj.highlighted[0].getAttribute("data-y")),c=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([w,L]),n=c-w+1,o=a-L+1}var g=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[g[1]][g[0]].getAttribute("data-merged")&&(h=obj.options.text.cellAlreadyMerged);else if((!n||n<2)&&(!o||o<2))h=obj.options.text.invalidMergeProperties;else for(var D=g[1];D<g[1]+o;D++)for(var H=g[0];H<g[0]+n;H++)jexcel.getColumnNameFromId([H,D]),obj.records[D][H].getAttribute("data-merged")&&(h=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(h)alert(h);else{n>1?obj.records[g[1]][g[0]].setAttribute("colspan",n):n=1,o>1?obj.records[g[1]][g[0]].setAttribute("rowspan",o):o=1,obj.options.mergeCells[e]=[n,o,[]],obj.records[g[1]][g[0]].setAttribute("data-merged","true"),obj.records[g[1]][g[0]].style.overflow="hidden";for(var m=[],f=g[1];f<g[1]+o;f++)for(var j=g[0];j<g[0]+n;j++)g[0]==j&&g[1]==f||(m.push(obj.options.data[f][j]),obj.updateCell(j,f,"",!0),obj.options.mergeCells[e][2].push(obj.records[f][j]),obj.records[f][j].style.display="none",obj.records[f][j]=obj.records[g[1]][g[0]]);obj.updateSelection(obj.records[g[1]][g[0]]),s||(obj.setHistory({action:"setMerge",column:e,colspan:n,rowspan:o,data:m}),obj.dispatch("onmerge",el,e,n,o))}},obj.getMerge=function(e){var n={};if(e)n=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var o=Object.keys(obj.options.mergeCells),s=0;s<o.length;s++)n[o[s]]=[obj.options.mergeCells[o[s]][0],obj.options.mergeCells[o[s]][1]]}return n},obj.removeMerge=function(e,n,o){if(obj.options.mergeCells[e]){var s=jexcel.getIdFromColumnName(e,!0);obj.records[s[1]][s[0]].removeAttribute("colspan"),obj.records[s[1]][s[0]].removeAttribute("rowspan"),obj.records[s[1]][s[0]].removeAttribute("data-merged");for(var h=obj.options.mergeCells[e],w=0,L=0;L<h[1];L++)for(var c=0;c<h[0];c++)(L>0||c>0)&&(obj.records[s[1]+L][s[0]+c]=h[2][w],obj.records[s[1]+L][s[0]+c].style.display="",n&&n[w]&&obj.updateCell(s[0]+c,s[1]+L,n[w]),w++);obj.updateSelection(obj.records[s[1]][s[0]],obj.records[s[1]+L-1][s[0]+c-1]),o||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var n=Object.keys(obj.options.mergeCells),o=0;o<n.length;o++)obj.removeMerge(n[o],null,e)}},obj.isColMerged=function(e,n){var o=[];if(obj.options.mergeCells)for(var s=Object.keys(obj.options.mergeCells),h=0;h<s.length;h++){var w=jexcel.getIdFromColumnName(s[h],!0),L=obj.options.mergeCells[s[h]][0],c=w[0],a=w[0]+(L>1?L-1:0);n==null?c<=e&&a>=e&&o.push(s[h]):n?c<e&&a>=e&&o.push(s[h]):c<=e&&a>e&&o.push(s[h])}return o},obj.isRowMerged=function(e,n){var o=[];if(obj.options.mergeCells)for(var s=Object.keys(obj.options.mergeCells),h=0;h<s.length;h++){var w=jexcel.getIdFromColumnName(s[h],!0),L=obj.options.mergeCells[s[h]][1],c=w[1],a=w[1]+(L>1?L-1:0);n==null?c<=e&&a>=e&&o.push(s[h]):n?c<e&&a>=e&&o.push(s[h]):c<=e&&a>e&&o.push(s[h])}return o},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var n=[];if(obj.options.columns[e].type=="checkbox")n.push({id:"true",name:"True"}),n.push({id:"false",name:"False"});else{for(var o=[],s=!1,h=0;h<obj.options.data.length;h++){var w=obj.options.data[h][e],L=obj.records[h][e].innerHTML;w&&L?o[w]=L:s=!0}var c=Object.keys(o);for(n=[],h=0;h<c.length;h++)n.push({id:c[h],name:o[c[h]]});s&&n.push({value:"",id:"",name:"(Blanks)"})}var a=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(a),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var g={data:n,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[e]!==void 0?obj.filters[e]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(D){obj.resetFilters(),obj.filters[e]=D.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=D.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(a,g)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var n=0;n<obj.filter.children.length;n++)obj.filters[n]&&(e=n);var o=function(w,L,c){for(var a=0;a<w.length;a++){var g=""+obj.options.data[c][L],D=""+obj.records[c][L].innerHTML;if(w[a]==g||w[a]==D)return!0}return!1},s=obj.filters[e];obj.results=[];for(var h=0;h<obj.options.data.length;h++)o(s,e,h)&&obj.results.push(h);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,n,o){var s=e.getAttribute("data-y"),h=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,h,s),h>0&&(obj.records[s][h-1].style.overflow="hidden");var w=function(O){var F=e.getBoundingClientRect(),U=document.createElement(O);return U.style.width=F.width+"px",U.style.height=F.height-2+"px",U.style.minHeight=F.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(U),obj.dispatch("oncreateeditor",el,e,h,s,U),U};if(e.classList.contains("readonly")!=1){if(obj.edition=[obj.records[s][h],obj.records[s][h].innerHTML,h,s],obj.options.columns[h].editor)obj.options.columns[h].editor.openEditor(e,el,n,o);else if(obj.options.columns[h].type!="hidden")if(obj.options.columns[h].type=="checkbox"||obj.options.columns[h].type=="radio"){var L=!e.children[0].checked;obj.setValue(e,L),obj.edition=null}else if(obj.options.columns[h].type=="dropdown"||obj.options.columns[h].type=="autocomplete"){if(L=obj.options.data[s][h],obj.options.columns[h].multiple&&!Array.isArray(L)&&(L=L.split(";")),typeof obj.options.columns[h].filter=="function")var c=obj.options.columns[h].filter(el,e,h,s,obj.options.columns[h].source);else c=obj.options.columns[h].source;for(var a=[],g=0;g<c.length;g++)a.push(c[g]);var D=w("div"),H={data:a,multiple:!!obj.options.columns[h].multiple,autocomplete:!(!obj.options.columns[h].autocomplete&&obj.options.columns[h].type!="autocomplete"),opened:!0,value:L,width:"100%",height:D.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[h].options&&obj.options.columns[h].options.type&&(H.type=obj.options.columns[h].options.type),jSuites.dropdown(D,H)}else if(obj.options.columns[h].type=="calendar"||obj.options.columns[h].type=="color")L=obj.options.data[s][h],(D=w("input")).value=L,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[h].options.position=!0),obj.options.columns[h].options.value=obj.options.data[s][h],obj.options.columns[h].options.opened=!0,obj.options.columns[h].options.onclose=function(O,F){obj.closeEditor(e,!0)},obj.options.columns[h].type=="color"?jSuites.color(D,obj.options.columns[h].options):jSuites.calendar(D,obj.options.columns[h].options),D.focus();else if(obj.options.columns[h].type=="html"){L=obj.options.data[s][h],(D=w("div")).style.position="relative",(j=document.createElement("div")).classList.add("jexcel_richtext"),D.appendChild(j),jSuites.editor(j,{focus:!0,value:L});var m=e.getBoundingClientRect(),f=j.getBoundingClientRect();window.innerHeight<m.bottom+f.height?j.style.top=m.top-(f.height+2)+"px":j.style.top=m.top+"px"}else if(obj.options.columns[h].type=="image"){var j,C=e.children[0];(D=w("div")).style.position="relative",(j=document.createElement("div")).classList.add("jclose"),C&&C.src&&j.appendChild(C),D.appendChild(j),jSuites.image(j,obj.options.imageOptions),m=e.getBoundingClientRect(),f=j.getBoundingClientRect(),window.innerHeight<m.bottom+f.height?j.style.top=m.top-(f.height+2)+"px":j.style.top=m.top+"px"}else{L=n==1?"":obj.options.data[s][h],obj.options.columns[h].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[h].wordWrap!=1?D=w("input"):D=w("textarea"),D.focus(),D.value=L,H=obj.options.columns[h];var b=null;if(!isFormula(L)&&(b=getMask(H))){if(!H.disabledMaskOnEdition)if(H.mask){var T=H.mask.split(";");D.setAttribute("data-mask",T[0])}else H.locale&&D.setAttribute("data-locale",H.locale);b.input=D,D.mask=b,jSuites.mask.render(L,b,!1)}D.onblur=function(){obj.closeEditor(e,!0)},D.scrollLeft=D.scrollWidth}}},obj.closeEditor=function(e,n){var o=parseInt(e.getAttribute("data-x")),s=parseInt(e.getAttribute("data-y"));if(n==1){if(obj.options.columns[o].editor)var h=obj.options.columns[o].editor.closeEditor(e,n);else if(!(obj.options.columns[o].type=="checkbox"||obj.options.columns[o].type=="radio"||obj.options.columns[o].type=="hidden"))if(obj.options.columns[o].type=="dropdown"||obj.options.columns[o].type=="autocomplete")h=e.children[0].dropdown.close(!0);else if(obj.options.columns[o].type=="calendar")h=e.children[0].calendar.close(!0);else if(obj.options.columns[o].type=="color")h=e.children[0].color.close(!0);else if(obj.options.columns[o].type=="html")h=e.children[0].children[0].editor.getData();else if(obj.options.columns[o].type=="image"){var w=e.children[0].children[0].children[0];h=w&&w.tagName=="IMG"?w.src:""}else if(obj.options.columns[o].type=="numeric")(""+(h=e.children[0].value)).substr(0,1)!="="&&h==""&&(h=obj.options.columns[o].allowEmpty?"":0),e.children[0].onblur=null;else{h=e.children[0].value,e.children[0].onblur=null;var L,c=obj.options.columns[o];if((L=getMask(c))&&h!==""&&!isFormula(h)&&typeof h!="number"){var a=jSuites.mask.extract(h,L,!0);a&&a.value!==""&&(h=a.value)}}obj.options.data[s][o]==h?e.innerHTML=obj.edition[1]:obj.setValue(e,h)}else obj.options.columns[o].editor?obj.options.columns[o].editor.closeEditor(e,n):obj.options.columns[o].type=="dropdown"||obj.options.columns[o].type=="autocomplete"?e.children[0].dropdown.close(!0):obj.options.columns[o].type=="calendar"?e.children[0].calendar.close(!0):obj.options.columns[o].type=="color"?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,o,s,h,n),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var n=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];return obj.records[o][n]},obj.getColumnOptions=function(e,n){var o=obj.options.columns[e];return o||(o={type:"text"}),o},obj.getCellFromCoords=function(e,n){return obj.records[n][e]},obj.getLabel=function(e){var n=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];return obj.records[o][n].innerHTML},obj.getLabelFromCoords=function(e,n){return obj.records[n][e].innerHTML},obj.getValue=function(e,n){if(typeof e=="object")var o=e.getAttribute("data-x"),s=e.getAttribute("data-y");else o=(e=jexcel.getIdFromColumnName(e,!0))[0],s=e[1];var h=null;return o!=null&&s!=null&&(obj.records[s]&&obj.records[s][o]&&(n||obj.options.copyCompatibility==1)?h=obj.records[s][o].innerHTML:obj.options.data[s]&&obj.options.data[s][o]!="undefined"&&(h=obj.options.data[s][o])),h},obj.getValueFromCoords=function(e,n,o){var s=null;return e!=null&&n!=null&&(obj.records[n]&&obj.records[n][e]&&o||obj.options.copyCompatibility==1?s=obj.records[n][e].innerHTML:obj.options.data[n]&&obj.options.data[n][e]!="undefined"&&(s=obj.options.data[n][e])),s},obj.setValue=function(e,n,o){var s=[];if(typeof e=="string"){var h=(a=jexcel.getIdFromColumnName(e,!0))[0],w=a[1];s.push(obj.updateCell(h,w,n,o)),obj.updateFormulaChain(h,w,s)}else if(h=null,w=null,e&&e.getAttribute&&(h=e.getAttribute("data-x"),w=e.getAttribute("data-y")),h!=null&&w!=null)s.push(obj.updateCell(h,w,n,o)),obj.updateFormulaChain(h,w,s);else{var L=Object.keys(e);if(L.length>0)for(var c=0;c<L.length;c++){var a;typeof e[c]=="string"?(h=(a=jexcel.getIdFromColumnName(e[c],!0))[0],w=a[1]):e[c].x!=null&&e[c].y!=null?(h=e[c].x,w=e[c].y,e[c].newValue!=null?n=e[c].newValue:e[c].value!=null&&(n=e[c].value)):(h=e[c].getAttribute("data-x"),w=e[c].getAttribute("data-y")),h!=null&&w!=null&&(s.push(obj.updateCell(h,w,n,o)),obj.updateFormulaChain(h,w,s))}}obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.setValueFromCoords=function(e,n,o,s){var h=[];h.push(obj.updateCell(e,n,o,s)),obj.updateFormulaChain(e,n,h),obj.setHistory({action:"setValue",records:h,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,h)},obj.setCheckRadioValue=function(){for(var e=[],n=Object.keys(obj.highlighted),o=0;o<n.length;o++){var s=obj.highlighted[o].getAttribute("data-x"),h=obj.highlighted[o].getAttribute("data-y");obj.options.columns[s].type!="checkbox"&&obj.options.columns[s].type!="radio"||e.push(obj.updateCell(s,h,!obj.options.data[h][s]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var n=new Option;n.innerHTML=e;var o=null;for(e=n.getElementsByTagName("script");o=e[0];)o.parentNode.removeChild(o);return n.innerHTML};obj.updateCell=function(e,n,o,s){if(obj.records[n][e].classList.contains("readonly")!=1||s){var h;(""+o).substr(0,1)=="="&&obj.options.secureFormulas==1&&(h=secureFormula(o))!=o&&(o=h),(h=obj.dispatch("onbeforechange",el,obj.records[n][e],e,n,o))!=null&&(o=h),obj.options.columns[e].editor&&typeof obj.options.columns[e].editor.updateCell=="function"&&(o=obj.options.columns[e].editor.updateCell(obj.records[n][e],o,s)),D={x:e,y:n,col:e,row:n,newValue:o,oldValue:obj.options.data[n][e]};let H=obj.options.columns[e].editor;if(H)obj.options.data[n][e]=o,typeof H.setValue=="function"&&H.setValue(obj.records[n][e],o);else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){if(obj.options.columns[e].type=="radio")for(var w=0;w<obj.options.data.length;w++)obj.options.data[w][e]=!1;obj.records[n][e].children[0].checked=o==1||o==1||o=="true"||o=="TRUE",obj.options.data[n][e]=obj.records[n][e].children[0].checked}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")obj.options.data[n][e]=o,obj.records[n][e].textContent=obj.getDropDownValue(e,o);else if(obj.options.columns[e].type=="calendar"){var L=null;if(!validDate(o)){var c=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);c&&(L=c)}obj.options.data[n][e]=o,obj.records[n][e].textContent=jSuites.calendar.getDateString(L||o,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="color")if(obj.options.data[n][e]=o,obj.options.columns[e].render=="square"){var a=document.createElement("div");a.className="color",a.style.backgroundColor=o,obj.records[n][e].textContent="",obj.records[n][e].appendChild(a)}else obj.records[n][e].style.color=o,obj.records[n][e].textContent=o;else if(obj.options.columns[e].type=="image"){if(o=""+o,obj.options.data[n][e]=o,obj.records[n][e].innerHTML="",o&&o.substr(0,10)=="data:image"){var g=document.createElement("img");g.src=o,obj.records[n][e].appendChild(g)}}else obj.options.data[n][e]=o,obj.options.columns[e].type=="html"?obj.records[n][e].innerHTML=stripScript(obj.parseValue(e,n,o)):obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?obj.records[n][e].innerHTML=stripScript(obj.parseValue(e,n,o,obj.records[n][e])):obj.records[n][e].textContent=obj.parseValue(e,n,o,obj.records[n][e]),obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||obj.records[n][e].innerHTML.length>200)?obj.records[n][e].style.whiteSpace="pre-wrap":obj.records[n][e].style.whiteSpace="";e>0&&(obj.records[n][e-1].style.overflow=o?"hidden":""),obj.dispatch("onchange",el,obj.records[n]&&obj.records[n][e]?obj.records[n][e]:null,e,n,o,D.oldValue)}else var D={x:e,y:n,col:e,row:n};return D},obj.copyData=function(e,n){var o=obj.getData(!0,!0),s=obj.selectedContainer,h=parseInt(e.getAttribute("data-x")),w=parseInt(e.getAttribute("data-y")),L=parseInt(n.getAttribute("data-x")),c=parseInt(n.getAttribute("data-y")),a=[],g=!1;if(s[0]==h){if(w<s[1])var D=w-s[1];else D=1;var H=0}else H=h<s[0]?h-s[0]:1,D=0;for(var m=0,f=0,j=w;j<=c;j++)if(!obj.rows[j]||obj.rows[j].style.display!="none"){o[f]==null&&(f=0),m=0,s[0]!=h&&(H=h<s[0]?h-s[0]:1);for(var C=h;C<=L;C++){if(obj.records[j][C]&&!obj.records[j][C].classList.contains("readonly")&&obj.records[j][C].style.display!="none"&&g==0){if(!obj.selection.length&&obj.options.data[j][C]!=""){g=!0;continue}(o[f]==null||o[f][m]==null)&&(m=0);var b=o[f][m];if(b&&!o[1]&&obj.options.autoIncrement==1){if(obj.options.columns[C].type=="text"||obj.options.columns[C].type=="number")if((""+b).substr(0,1)=="="){var T=b.match(/([A-Z]+[0-9]+)/g);if(T){for(var O=[],F=0;F<T.length;F++){var U=jexcel.getIdFromColumnName(T[F],1);U[0]+=H,U[1]+=D,U[1]<0&&(U[1]=0);var B=jexcel.getColumnNameFromId([U[0],U[1]]);B!=T[F]&&(O[T[F]]=B)}O&&(b=obj.updateFormula(b,O))}}else b==Number(b)&&(b=Number(b)+D);else if(obj.options.columns[C].type=="calendar"){var I=new Date(b);I.setDate(I.getDate()+D),b=I.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(I.getMonth()+1))+"-"+jexcel.doubleDigitFormat(I.getDate())+" 00:00:00"}}a.push(obj.updateCell(C,j,b)),obj.updateFormulaChain(C,j,a)}m++,s[0]!=h&&H++}f++,D++}obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,a)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,n,o){if(e==1){if(obj.selectedCell&&(n>=obj.selectedCell[1]&&n<=obj.selectedCell[3]||o>=obj.selectedCell[1]&&o<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(n>=obj.selectedCell[0]&&n<=obj.selectedCell[2]||o>=obj.selectedCell[0]&&o<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){g=1;for(var n=0;n<obj.highlighted.length;n++){obj.highlighted[n].classList.remove("highlight"),obj.highlighted[n].classList.remove("highlight-left"),obj.highlighted[n].classList.remove("highlight-right"),obj.highlighted[n].classList.remove("highlight-top"),obj.highlighted[n].classList.remove("highlight-bottom"),obj.highlighted[n].classList.remove("highlight-selected");var o=parseInt(obj.highlighted[n].getAttribute("data-x")),s=parseInt(obj.highlighted[n].getAttribute("data-y"));if(obj.highlighted[n].getAttribute("data-merged"))var h=parseInt(obj.highlighted[n].getAttribute("colspan")),w=parseInt(obj.highlighted[n].getAttribute("rowspan")),L=h>0?o+(h-1):o,c=w>0?s+(w-1):s;else L=o,c=s;for(var a=o;a<=L;a++)obj.headers[a]&&obj.headers[a].classList.remove("selected");for(a=s;a<=c;a++)obj.rows[a]&&obj.rows[a].classList.remove("selected")}}else var g=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",e==1&&g==1&&obj.dispatch("onblur",el),g},obj.updateSelection=function(e,n,o){var s=e.getAttribute("data-x"),h=e.getAttribute("data-y");if(n)var w=n.getAttribute("data-x"),L=n.getAttribute("data-y");else w=s,L=h;obj.updateSelectionFromCoords(s,h,w,L,o)},obj.updateSelectionFromCoords=function(e,n,o,s,h){var w=obj.resetSelection();if(n==null&&(n=0,s=obj.rows.length-1),o==null&&(o=e),s==null&&(s=n),e>=obj.headers.length&&(e=obj.headers.length-1),n>=obj.rows.length&&(n=obj.rows.length-1),o>=obj.headers.length&&(o=obj.headers.length-1),s>=obj.rows.length&&(s=obj.rows.length-1),obj.selectedCell=[e,n,o,s],e!=null){if(obj.records[n][e]&&obj.records[n][e].classList.add("highlight-selected"),parseInt(e)<parseInt(o))var L=parseInt(e),c=parseInt(o);else L=parseInt(o),c=parseInt(e);if(parseInt(n)<parseInt(s))var a=parseInt(n),g=parseInt(s);else a=parseInt(s),g=parseInt(n);for(var D=L;D<=c;D++)for(var H=a;H<=g;H++)if(obj.records[H][D]&&obj.records[H][D].getAttribute("data-merged")){var m=parseInt(obj.records[H][D].getAttribute("data-x")),f=parseInt(obj.records[H][D].getAttribute("data-y")),j=parseInt(obj.records[H][D].getAttribute("colspan")),C=parseInt(obj.records[H][D].getAttribute("rowspan"));j>1&&(m<L&&(L=m),m+j>c&&(c=m+j-1)),C&&(f<a&&(a=f),f+C>g&&(g=f+C-1))}var b=null,T=null,O=null,F=null;for(H=a;H<=g;H++)obj.rows[H].style.display!="none"&&(O==null&&(O=H),F=H);for(D=L;D<=c;D++){for(H=a;H<=g;H++)obj.rows[H].style.display!="none"&&obj.records[H][D].style.display!="none"&&(obj.records[H][D].classList.add("highlight"),obj.highlighted.push(obj.records[H][D]));obj.options.columns[D].type!="hidden"&&(b==null&&(b=D),T=D)}for(b||(b=0),T||(T=0),D=b;D<=T;D++)obj.options.columns[D].type!="hidden"&&(obj.records[O]&&obj.records[O][D]&&obj.records[O][D].classList.add("highlight-top"),obj.records[F]&&obj.records[F][D]&&obj.records[F][D].classList.add("highlight-bottom"),obj.headers[D].classList.add("selected"));for(H=O;H<=F;H++)obj.rows[H]&&obj.rows[H].style.display!="none"&&(obj.records[H][b].classList.add("highlight-left"),obj.records[H][T].classList.add("highlight-right"),obj.rows[H].classList.add("selected"));obj.selectedContainer=[b,O,T,F]}w==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,b,O,T,F,h),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,n){obj.removeCopySelection();var o=obj.selectedContainer[0],s=obj.selectedContainer[1],h=obj.selectedContainer[2],w=obj.selectedContainer[3];if(e!=null&&n!=null){if(e-h>0)var L=parseInt(h)+1,c=parseInt(e);else L=parseInt(e),c=parseInt(o)-1;if(n-w>0)var a=parseInt(w)+1,g=parseInt(n);else a=parseInt(n),g=parseInt(s)-1;c-L<=g-a?(L=parseInt(o),c=parseInt(h)):(a=parseInt(s),g=parseInt(w));for(var D=a;D<=g;D++)for(var H=L;H<=c;H++)obj.records[D][H]&&obj.rows[D].style.display!="none"&&obj.records[D][H].style.display!="none"&&(obj.records[D][H].classList.add("selection"),obj.records[a][H].classList.add("selection-top"),obj.records[g][H].classList.add("selection-bottom"),obj.records[D][L].classList.add("selection-left"),obj.records[D][c].classList.add("selection-right"),obj.selection.push(obj.records[D][H]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],n=e.getAttribute("data-x"),o=obj.content.getBoundingClientRect(),s=o.left,h=o.top,w=e.getBoundingClientRect(),L=w.left,c=w.top,a=w.width,g=w.height,D=L-s+obj.content.scrollLeft+a-4,H=c-h+obj.content.scrollTop+g-4;if(obj.corner.style.top=H+"px",obj.corner.style.left=D+"px",obj.options.freezeColumns){var m=obj.getFreezeWidth();n>obj.options.freezeColumns-1&&L-s+a<m?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var n=obj.content.getBoundingClientRect(),o=n.left,s=n.top,h=n.width,w=n.height,L=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),c=L.left,a=L.top,g=L.width,D=L.height;if(e==0||e==1)var H=c-o+obj.content.scrollLeft,m=a-s+obj.content.scrollTop-2;else H=c-o+obj.content.scrollLeft+g,m=a-s+obj.content.scrollTop+D;m>obj.content.scrollTop+30&&m<obj.content.scrollTop+w||(m<obj.content.scrollTop+30?obj.content.scrollTop=m-D:obj.content.scrollTop=m-(w-2));var f=obj.getFreezeWidth();H>obj.content.scrollLeft+f&&H<obj.content.scrollLeft+h||(H<obj.content.scrollLeft+30?(obj.content.scrollLeft=H,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):H<obj.content.scrollLeft+f?obj.content.scrollLeft=H-f-1:obj.content.scrollLeft=H-(h-20))},obj.getWidth=function(e){if(e===void 0)for(var n=[],o=0;o<obj.headers.length;o++)n.push(obj.options.columns[o].width);else typeof e=="object"&&(e=e.getAttribute("data-x")),n=obj.colgroup[e].getAttribute("width");return n},obj.setWidth=function(e,n,o){if(n){if(Array.isArray(e)){o||(o=[]);for(var s=0;s<e.length;s++){o[s]||(o[s]=obj.colgroup[e[s]].getAttribute("width"));var h=Array.isArray(n)&&n[s]?n[s]:n;obj.colgroup[e[s]].setAttribute("width",h),obj.options.columns[e[s]].width=h}}else o||(o=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",n),obj.options.columns[e].width=n;obj.setHistory({action:"setWidth",column:e,oldValue:o,newValue:n}),obj.dispatch("onresizecolumn",el,e,n,o),obj.updateCornerPosition()}},obj.setHeight=function(e,n,o){n>0&&(typeof e=="object"&&(e=e.getAttribute("data-y")),o||(o=obj.rows[e].getAttribute("height"))||(o=obj.rows[e].getBoundingClientRect().height),n=parseInt(n),obj.rows[e].style.height=n+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=n,obj.setHistory({action:"setHeight",row:e,oldValue:o,newValue:n}),obj.dispatch("onresizerow",el,e,n,o),obj.updateCornerPosition())},obj.getHeight=function(e){if(e===void 0)for(var n=[],o=0;o<obj.rows.length;o++){var s=obj.rows[o].style.height;s&&(n[o]=s)}else typeof e=="object"&&(e=$(e).getAttribute("data-y")),n=obj.rows[e].style.height;return n},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var n=0;n<obj.options.footers.length;n++){if(obj.tfoot.children[n])var o=obj.tfoot.children[n];else{o=document.createElement("tr");var s=document.createElement("td");o.appendChild(s),obj.tfoot.appendChild(o)}for(var h=0;h<obj.headers.length;h++){if(obj.options.footers[n][h]||(obj.options.footers[n][h]=""),obj.tfoot.children[n].children[h+1])s=obj.tfoot.children[n].children[h+1];else{s=document.createElement("td"),o.appendChild(s);var w=obj.options.columns[h].align?obj.options.columns[h].align:"center";s.style.textAlign=w}s.textContent=obj.parseValue(+obj.records.length+h,n,obj.options.footers[n][h]),s.style.display=obj.colgroup[h].style.display}}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,n){if(obj.headers[e]){var o=obj.headers[e].textContent;n||(n=prompt(obj.options.text.columnName,o)),n&&(obj.headers[e].textContent=n,obj.headers[e].setAttribute("title",n),obj.options.columns[e].title=n),obj.setHistory({action:"setHeader",column:e,oldValue:o,newValue:n}),obj.dispatch("onchangeheader",el,e,o,n)}},obj.getHeaders=function(e){for(var n=[],o=0;o<obj.headers.length;o++)n.push(obj.getHeader(o));return e?n:n.join(obj.options.csvDelimiter)},obj.getMeta=function(e,n){return e?n?obj.options.meta[e]&&obj.options.meta[e][n]?obj.options.meta[e][n]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,n,o){if(obj.options.meta||(obj.options.meta={}),n&&o)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][n]=o;else for(var s=Object.keys(e),h=0;h<s.length;h++){obj.options.meta[s[h]]||(obj.options.meta[s[h]]={});for(var w=Object.keys(e[s[h]]),L=0;L<w.length;L++)obj.options.meta[s[h]][w[L]]=e[s[h]][w[L]]}obj.dispatch("onchangemeta",el,e,n,o)},obj.updateMeta=function(e){if(obj.options.meta){for(var n={},o=Object.keys(obj.options.meta),s=0;s<o.length;s++)e[o[s]]?n[e[o[s]]]=obj.options.meta[o[s]]:n[o[s]]=obj.options.meta[o[s]];obj.options.meta=n}},obj.getStyle=function(e,n){if(e)return e=jexcel.getIdFromColumnName(e,!0),n?obj.records[e[1]][e[0]].style[n]:obj.records[e[1]][e[0]].getAttribute("style");for(var o={},s=obj.options.data[0].length,h=obj.options.data.length,w=0;w<h;w++)for(var L=0;L<s;L++){var c=n?obj.records[w][L].style[n]:obj.records[w][L].getAttribute("style");c&&(o[jexcel.getColumnNameFromId([L,w])]=c)}return o},obj.resetStyle=function(e,n){for(var o=Object.keys(e),s=0;s<o.length;s++){var h=jexcel.getIdFromColumnName(o[s],!0);obj.records[h[1]]&&obj.records[h[1]][h[0]]&&obj.records[h[1]][h[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,n)},obj.setStyle=function(e,n,o,s,h){var w={},L={},c=function(b,T,O){var F=jexcel.getIdFromColumnName(b,!0);if(obj.records[F[1]]&&obj.records[F[1]][F[0]]&&(obj.records[F[1]][F[0]].classList.contains("readonly")==0||s)){var U=obj.records[F[1]][F[0]].style[T];U!=O||s?obj.records[F[1]][F[0]].style[T]=O:(O="",obj.records[F[1]][F[0]].style[T]=""),L[b]||(L[b]=[]),w[b]||(w[b]=[]),L[b].push([T+":"+U]),w[b].push([T+":"+O])}};if(n&&o)if(typeof e=="string")c(e,n,o);else for(var a=[],g=0;g<e.length;g++){var D=e[g].getAttribute("data-x"),H=e[g].getAttribute("data-y"),m=jexcel.getColumnNameFromId([D,H]);a[m]||(c(m,n,o),a[m]=!0)}else{var f=Object.keys(e);for(g=0;g<f.length;g++){var j=e[f[g]];typeof j=="string"&&(j=j.split(";"));for(var C=0;C<j.length;C++)typeof j[C]=="string"&&(j[C]=j[C].split(":")),j[C][0].trim()&&c(f[g],j[C][0].trim(),j[C][1])}}for(f=Object.keys(L),g=0;g<f.length;g++)L[f[g]]=L[f[g]].join(";");for(f=Object.keys(w),g=0;g<f.length;g++)w[f[g]]=w[f[g]].join(";");h||obj.setHistory({action:"setStyle",oldValue:L,newValue:w}),obj.dispatch("onchangestyle",el,e,n,o)},obj.getComments=function(e,n){if(e)return typeof e=="string"&&(e=jexcel.getIdFromColumnName(e,!0)),n?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var o={},s=0;s<obj.options.data.length;s++)for(var h=0;h<obj.options.columns.length;h++){var w=obj.records[s][h].getAttribute("title");w&&(o[e=jexcel.getColumnNameFromId([h,s])]=w)}return o},obj.setComments=function(e,n,o){if(typeof e=="string")var s=jexcel.getIdFromColumnName(e,!0);else s=e;var h=obj.records[s[1]][s[0]].getAttribute("title"),w=[h,o=obj.records[s[1]][s[0]].getAttribute("data-author")];obj.records[s[1]][s[0]].setAttribute("title",n||""),obj.records[s[1]][s[0]].setAttribute("data-author",o||""),n?obj.records[s[1]][s[0]].classList.add("jexcel_comments"):obj.records[s[1]][s[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[n,o],oldValue:w}),obj.dispatch("oncomments",el,n,h,s,s[0],s[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,n){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}n=n==null?obj.headers[e].classList.contains("arrow-down")?1:0:n?1:0;var o=[];if(obj.options.columns[e].type=="number"||obj.options.columns[e].type=="numeric"||obj.options.columns[e].type=="percentage"||obj.options.columns[e].type=="autonumber"||obj.options.columns[e].type=="color")for(var s=0;s<obj.options.data.length;s++)o[s]=[s,Number(obj.options.data[s][e])];else if(obj.options.columns[e].type=="calendar"||obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio")for(s=0;s<obj.options.data.length;s++)o[s]=[s,obj.options.data[s][e]];else for(s=0;s<obj.options.data.length;s++)o[s]=[s,obj.records[s][e].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(w){return function(L,c){var a=L[1],g=c[1];return w?a===""&&g!==""?1:a!==""&&g===""||a>g?-1:a<g?1:0:a===""&&g!==""?1:a!==""&&g===""?-1:a>g?1:a<g?-1:0}}),o=o.sort(obj.options.sorting(n));var h=[];for(s=0;s<o.length;s++)h[s]=o[s][0];return obj.setHistory({action:"orderBy",rows:h,column:e,order:n}),obj.updateOrderArrow(e,n),obj.updateOrder(h),obj.dispatch("onsort",el,e,n),!0}},obj.updateOrderArrow=function(e,n){for(var o=0;o<obj.headers.length;o++)obj.headers[o].classList.remove("arrow-up"),obj.headers[o].classList.remove("arrow-down");n?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var n=[],o=0;o<e.length;o++)n[o]=obj.options.data[e[o]];for(obj.options.data=n,n=[],o=0;o<e.length;o++)n[o]=obj.records[e[o]];for(obj.records=n,n=[],o=0;o<e.length;o++)n[o]=obj.rows[e[o]];if(obj.rows=n,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(o=0;o<obj.rows.length;o++)obj.tbody.appendChild(obj.rows[o])},obj.moveRow=function(e,n,o){if(Object.keys(obj.options.mergeCells).length>0){if(e>n)var s=1;else s=0;if(obj.isRowMerged(e).length||obj.isRowMerged(n,s).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}o||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[n])>=0?e>n?obj.tbody.insertBefore(obj.rows[e],obj.rows[n]):obj.tbody.insertBefore(obj.rows[e],obj.rows[n].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(n,0,obj.rows.splice(e,1)[0]),obj.records.splice(n,0,obj.records.splice(e,1)[0]),obj.options.data.splice(n,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:n}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,n)},obj.insertRow=function(e,n,o){if(obj.options.allowInsertRow==1){var s=[];if(e>0)var h=e;else h=1,e&&(s=e);o=!!o;var w=obj.options.data.length-1;if((n==null||n>=parseInt(w)||n<0)&&(n=w),obj.dispatch("onbeforeinsertrow",el,n,h,o)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(n,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var L=o?n:n+1,c=obj.records.splice(L),a=obj.options.data.splice(L),g=obj.rows.splice(L),D=[],H=[],m=[],f=L;f<h+L;f++){obj.options.data[f]=[];for(var j=0;j<obj.options.columns.length;j++)obj.options.data[f][j]=s[j]?s[j]:"";var C=obj.createRow(f,obj.options.data[f]);g[0]?Array.prototype.indexOf.call(obj.tbody.children,g[0])>=0&&obj.tbody.insertBefore(C,g[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[n])>=0&&obj.tbody.appendChild(C),D.push(obj.records[f]),H.push(obj.options.data[f]),m.push(C)}Array.prototype.push.apply(obj.records,c),Array.prototype.push.apply(obj.options.data,a),Array.prototype.push.apply(obj.rows,g),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:n,numOfRows:h,insertBefore:o,rowRecords:D,rowData:H,rowNode:m}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,n,h,D,o)}},obj.deleteRow=function(e,n){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(e==null){var o=obj.getSelectedRows();o[0]?(e=parseInt(o[0].getAttribute("data-y")),n=o.length):(e=obj.options.data.length-1,n=1)}var s=obj.options.data.length-1;if((e==null||e>s||e<0)&&(e=s),n||(n=1),e+n>=obj.options.data.length&&(n=obj.options.data.length-e),obj.dispatch("onbeforedeleterow",el,e,n)===!1)return!1;if(parseInt(e)>-1){var h=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var w=e;w<e+n;w++)obj.isRowMerged(w,!1).length&&(h=!0);if(h){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&s+1===n&&(n--,console.error("Jspreadsheet: It is not possible to delete the last row")),w=e;w<e+n;w++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[w])>=0&&(obj.rows[w].className="",obj.rows[w].parentNode.removeChild(obj.rows[w]));var L=obj.records.splice(e,n),c=obj.options.data.splice(e,n),a=obj.rows.splice(e,n);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+n-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:n,insertBefore:1,rowRecords:L,rowData:c,rowNode:a}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,n,L)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,n){if(Object.keys(obj.options.mergeCells).length>0){if(e>n)var o=1;else o=0;if(obj.isColMerged(e).length||obj.isColMerged(n,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(n=parseInt(n))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[n]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[n]);for(var s=0;s<obj.rows.length;s++)obj.rows[s].insertBefore(obj.records[s][e],obj.records[s][n])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[n].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[n].nextSibling),s=0;s<obj.rows.length;s++)obj.rows[s].insertBefore(obj.records[s][e],obj.records[s][n].nextSibling);for(obj.options.columns.splice(n,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(n,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(n,0,obj.colgroup.splice(e,1)[0]),s=0;s<obj.rows.length;s++)obj.options.data[s].splice(n,0,obj.options.data[s].splice(e,1)[0]),obj.records[s].splice(n,0,obj.records[s].splice(e,1)[0]);if(obj.options.footers)for(s=0;s<obj.options.footers.length;s++)obj.options.footers[s].splice(n,0,obj.options.footers[s].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:n}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,n)},obj.insertColumn=function(e,n,o,s){if(obj.options.allowInsertColumn==1){var h=[];if(e>0)var w=e;else w=1,e&&(h=e);o=!!o;var L=obj.options.columns.length-1;if((n==null||n>=parseInt(L)||n<0)&&(n=L),obj.dispatch("onbeforeinsertcolumn",el,n,w,o)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(n,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}s||(s=[]);for(var c=0;c<w;c++)s[c]||(s[c]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var a=o?n:n+1;obj.options.columns=jexcel.injectArray(obj.options.columns,a,s);for(var g=obj.headers.splice(a),D=obj.colgroup.splice(a),H=[],m=[],f=[],j=[],C=[],b=a;b<w+a;b++)obj.createCellHeader(b),obj.headerContainer.insertBefore(obj.headers[b],obj.headerContainer.children[b+1]),obj.colgroupContainer.insertBefore(obj.colgroup[b],obj.colgroupContainer.children[b+1]),H.push(obj.headers[b]),m.push(obj.colgroup[b]);if(obj.options.footers)for(var T=0;T<obj.options.footers.length;T++){for(C[T]=[],c=0;c<w;c++)C[T].push("");obj.options.footers[T].splice(a,0,C[T])}for(var O=0;O<obj.options.data.length;O++){var F=obj.options.data[O].splice(a),U=obj.records[O].splice(a);for(j[O]=[],f[O]=[],b=a;b<w+a;b++){var B=h[O]?h[O]:"";obj.options.data[O][b]=B;var I=obj.createCell(b,O,obj.options.data[O][b]);obj.records[O][b]=I,obj.rows[O]&&obj.rows[O].insertBefore(I,obj.rows[O].children[b+1]),j[O].push(B),f[O].push(I)}Array.prototype.push.apply(obj.options.data[O],F),Array.prototype.push.apply(obj.records[O],U)}if(Array.prototype.push.apply(obj.headers,g),Array.prototype.push.apply(obj.colgroup,D),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(T=0;T<obj.options.nestedHeaders.length;T++){var P=parseInt(obj.options.nestedHeaders[T][obj.options.nestedHeaders[T].length-1].colspan)+w;obj.options.nestedHeaders[T][obj.options.nestedHeaders[T].length-1].colspan=P,obj.thead.children[T].children[obj.thead.children[T].children.length-1].setAttribute("colspan",P);var V=obj.thead.children[T].children[obj.thead.children[T].children.length-1].getAttribute("data-column");for(V=V.split(","),b=a;b<w+a;b++)V.push(b);obj.thead.children[T].children[obj.thead.children[T].children.length-1].setAttribute("data-column",V)}else P=parseInt(obj.options.nestedHeaders[0].colspan)+w,obj.options.nestedHeaders[0].colspan=P,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",P);obj.setHistory({action:"insertColumn",columnNumber:n,numOfColumns:w,insertBefore:o,columns:s,headers:H,colgroup:m,records:f,footers:C,data:j}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,n,w,f,o)}},obj.deleteColumn=function(e,n){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(e==null){var o=obj.getSelectedColumns(!0);o.length?(e=parseInt(o[0]),n=parseInt(o.length)):(e=obj.headers.length-1,n=1)}var s=obj.options.data[0].length-1;if((e==null||e>s||e<0)&&(e=s),n||(n=1),n>obj.options.data[0].length-e&&(n=obj.options.data[0].length-e),obj.dispatch("onbeforedeletecolumn",el,e,n)===!1)return!1;if(parseInt(e)>-1){var h=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var w=e;w<e+n;w++)obj.isColMerged(w,!1).length&&(h=!0);if(h){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var L=obj.options.columns.splice(e,n);for(w=e;w<e+n;w++)obj.colgroup[w].className="",obj.headers[w].className="",obj.colgroup[w].parentNode.removeChild(obj.colgroup[w]),obj.headers[w].parentNode.removeChild(obj.headers[w]);for(var c=obj.headers.splice(e,n),a=obj.colgroup.splice(e,n),g=[],D=[],H=[],m=0;m<obj.options.data.length;m++)for(w=e;w<e+n;w++)obj.records[m][w].className="",obj.records[m][w].parentNode.removeChild(obj.records[m][w]);for(m=0;m<obj.options.data.length;m++)D[m]=obj.options.data[m].splice(e,n),g[m]=obj.records[m].splice(e,n);if(obj.options.footers)for(m=0;m<obj.options.footers.length;m++)H[m]=obj.options.footers[m].splice(e,n);if(obj.conditionalSelectionUpdate(0,e,e+n-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var f=0;f<obj.options.nestedHeaders.length;f++){var j=parseInt(obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan)-n;obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan=j,obj.thead.children[f].children[obj.thead.children[f].children.length-1].setAttribute("colspan",j)}else j=parseInt(obj.options.nestedHeaders[0].colspan)-n,obj.options.nestedHeaders[0].colspan=j,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",j);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:n,insertBefore:1,columns:L,headers:c,colgroup:a,records:g,footers:H,data:D}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,n,g)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var n=[],o=0;o<obj.rows.length;o++)obj.rows[o].classList.contains("selected")&&(e?n.push(o):n.push(obj.rows[o]));return n},obj.getSelectedColumns=function(){for(var e=[],n=0;n<obj.headers.length;n++)obj.headers[n].classList.contains("selected")&&e.push(n);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(w=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var n=0;n<obj.rows.length;n++)obj.rows[n]&&(L=obj.rows[n].getAttribute("data-y"))!=n&&(obj.rows[n].setAttribute("data-y",n),obj.rows[n].children[0].setAttribute("data-y",n),obj.rows[n].children[0].innerHTML=n+1);var o=[],s=[],h=function(f,j,C,b){if(f!=C&&obj.records[b][C].setAttribute("data-x",C),j!=b&&obj.records[b][C].setAttribute("data-y",b),f!=C||j!=b){var T=jexcel.getColumnNameFromId([f,j]),O=jexcel.getColumnNameFromId([C,b]);o[T]=O}};for(n=0;n<obj.records.length;n++)for(e=0;e<obj.records[0].length;e++)if(obj.records[n][e]){var w=obj.records[n][e].getAttribute("data-x"),L=obj.records[n][e].getAttribute("data-y");if(obj.records[n][e].getAttribute("data-merged")){var c=jexcel.getColumnNameFromId([w,L]),a=jexcel.getColumnNameFromId([e,n]);if(s[c]==null)if(c==a)s[c]=!1;else{var g=parseInt(e-w),D=parseInt(n-L);s[c]=[a,g,D]}}else h(w,L,e,n)}var H=Object.keys(s);if(H.length){for(e=0;e<H.length;e++)if(s[H[e]]){var m=jexcel.getIdFromColumnName(H[e],!0);for(h(w=m[0],L=m[1],w+s[H[e]][1],L+s[H[e]][2]),c=H[e],a=s[H[e]][0],n=0;n<obj.options.mergeCells[c][2].length;n++)w=parseInt(obj.options.mergeCells[c][2][n].getAttribute("data-x")),L=parseInt(obj.options.mergeCells[c][2][n].getAttribute("data-y")),obj.options.mergeCells[c][2][n].setAttribute("data-x",w+s[H[e]][1]),obj.options.mergeCells[c][2][n].setAttribute("data-y",L+s[H[e]][2]);obj.options.mergeCells[a]=obj.options.mergeCells[c],delete obj.options.mergeCells[c]}}obj.updateFormulas(o),obj.updateMeta(o),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,n=obj.rows.length-1;n>=0;n--){for(var o=!1,s=0;s<obj.headers.length;s++)obj.options.data[n][s]&&(o=!0);if(o)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var h=0;for(s=obj.headers.length-1;s>=0;s--){for(o=!1,n=0;n<obj.rows.length;n++)obj.options.data[n][s]&&(o=!0);if(o)break;h++}obj.options.minSpareCols-h>0&&obj.insertColumn(obj.options.minSpareCols-h)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),n=0;n<obj.rows.length;n++)for(s=0;s<obj.headers.length;s++)obj.options.updateTable(el,obj.records[n][s],s,n,obj.options.data[n][s],obj.records[n][s].textContent,jexcel.getColumnNameFromId([s,n]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,n){(e=obj.getCell(e))&&(n?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var n=0;n<obj.options.data.length;n++)obj.records[n][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var n=0;n<obj.options.data.length;n++)obj.records[n][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,n,o){var s=jexcel.getColumnNameFromId([e,n]);if(obj.formula[s]&&obj.formula[s].length>0)if(chainLoopProtection[s])obj.records[n][e].innerHTML="#ERROR",obj.formula[s]="";else{chainLoopProtection[s]=!0;for(var h=0;h<obj.formula[s].length;h++){var w=jexcel.getIdFromColumnName(obj.formula[s][h],!0),L=""+obj.options.data[w[1]][w[0]];L.substr(0,1)=="="?o.push(obj.updateCell(w[0],w[1],L,!0)):Object.keys(obj.formula)[h]=null,obj.updateFormulaChain(w[0],w[1],o)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var n=0;n<obj.options.data.length;n++)for(var o=0;o<obj.options.data[0].length;o++)if((c=""+obj.options.data[n][o]).substr(0,1)=="="){var s=obj.updateFormula(c,e);s!=c&&(obj.options.data[n][o]=s)}var h=[],w=Object.keys(obj.formula);for(n=0;n<w.length;n++){var L=w[n],c=obj.formula[L];for(e[L]&&(L=e[L]),h[L]=[],o=0;o<c.length;o++){var a=c[o];e[a]&&(a=e[a]),h[L].push(a)}}obj.formula=h},obj.updateFormula=function(e,n){for(var o=/[A-Z]/,s=/[0-9]/,h="",w=null,L=null,c="",a=0;a<e.length;a++)o.exec(e[a])?(w=1,L=0,c+=e[a]):s.exec(e[a])?(L=w?1:0,c+=e[a]):(w&&L&&(c=n[c]?n[c]:c),h+=c,h+=e[a],w=0,L=0,c="");return c&&(w&&L&&(c=n[c]?n[c]:c),h+=c),h};var secureFormula=function(e){for(var n="",o=0,s=0;s<e.length;s++)e[s]=='"'&&(o=o==0?1:0),n+=o==1?e[s]:e[s].toUpperCase();return n};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var n=0;n<e.length;n++){var o=[],s=e[n].split(":"),h=jexcel.getIdFromColumnName(s[0],!0),w=jexcel.getIdFromColumnName(s[1],!0);if(h[0]<=w[0])var L=h[0],c=w[0];else L=w[0],c=h[0];if(h[1]<=w[1])var a=h[1],g=w[1];else a=w[1],g=h[1];for(var D=a;D<=g;D++)for(var H=L;H<=c;H++)o.push(jexcel.getColumnNameFromId([H,D]));expression=expression.replace(e[n],o.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,n){var o=n&&obj.options.columns[n].decimal?obj.options.columns[n].decimal:".",s=""+e;return(s=s.split(o))[0]=s[0].match(/[+-]?[0-9]/g),s[0]&&(s[0]=s[0].join("")),s[1]&&(s[1]=s[1].match(/[0-9]*/g).join("")),s[0]&&Number.isInteger(Number(s[0]))?s[1]?e=+(s[0]+"."+s[1]):e=+(s[0]+".00"):e=null,e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,n){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,n?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,n?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-o<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var s=obj.whichPage(obj.selectedCell[3]);s!=obj.pageNumber&&obj.page(s)}obj.updateScroll(1)},obj.up.visible=function(e,n){if(e==0)var o=parseInt(obj.selectedCell[0]),s=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),s=parseInt(obj.selectedCell[3]);if(n==0){for(var h=0;h<s;h++)if(obj.records[h][o].style.display!="none"&&obj.rows[h].style.display!="none"){s=h;break}}else s=obj.up.get(o,s);e==0?(obj.selectedCell[0]=o,obj.selectedCell[1]=s):(obj.selectedCell[2]=o,obj.selectedCell[3]=s)},obj.up.get=function(e,n){e=parseInt(e);for(var o=(n=parseInt(n))-1;o>=0;o--)if(obj.records[o][e].style.display!="none"&&obj.rows[o].style.display!="none"){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[n][e])continue;n=o;break}return n},obj.down=function(e,n){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,n?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,n?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(3)},obj.down.visible=function(e,n){if(e==0)var o=parseInt(obj.selectedCell[0]),s=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),s=parseInt(obj.selectedCell[3]);if(n==0){for(var h=obj.rows.length-1;h>s;h--)if(obj.records[h][o].style.display!="none"&&obj.rows[h].style.display!="none"){s=h;break}}else s=obj.down.get(o,s);e==0?(obj.selectedCell[0]=o,obj.selectedCell[1]=s):(obj.selectedCell[2]=o,obj.selectedCell[3]=s)},obj.down.get=function(e,n){e=parseInt(e);for(var o=(n=parseInt(n))+1;o<obj.rows.length;o++)if(obj.records[o][e].style.display!="none"&&obj.rows[o].style.display!="none"){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[n][e])continue;n=o;break}return n},obj.right=function(e,n){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,n?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,n?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,n){if(e==0)var o=parseInt(obj.selectedCell[0]),s=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),s=parseInt(obj.selectedCell[3]);if(n==0){for(var h=obj.headers.length-1;h>o;h--)if(obj.records[s][h].style.display!="none"){o=h;break}}else o=obj.right.get(o,s);e==0?(obj.selectedCell[0]=o,obj.selectedCell[1]=s):(obj.selectedCell[2]=o,obj.selectedCell[3]=s)},obj.right.get=function(e,n){e=parseInt(e),n=parseInt(n);for(var o=e+1;o<obj.headers.length;o++)if(obj.records[n][o].style.display!="none"){if(obj.records[n][o].getAttribute("data-merged")&&obj.records[n][o]==obj.records[n][e])continue;e=o;break}return e},obj.left=function(e,n){e?obj.selectedCell[2]>0&&obj.left.visible(1,n?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,n?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,n){if(e==0)var o=parseInt(obj.selectedCell[0]),s=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),s=parseInt(obj.selectedCell[3]);if(n==0){for(var h=0;h<o;h++)if(obj.records[s][h].style.display!="none"){o=h;break}}else o=obj.left.get(o,s);e==0?(obj.selectedCell[0]=o,obj.selectedCell[1]=s):(obj.selectedCell[2]=o,obj.selectedCell[3]=s)},obj.left.get=function(e,n){e=parseInt(e),n=parseInt(n);for(var o=e-1;o>=0;o--)if(obj.records[n][o].style.display!="none"){if(obj.records[n][o].getAttribute("data-merged")&&obj.records[n][o]==obj.records[n][e])continue;e=o;break}return e},obj.first=function(e,n){if(e?n?obj.selectedCell[3]=0:obj.left.visible(1,0):(n?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,n){if(e?n?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(n?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var o=100;e!=null&&e!=-1||(e=Math.ceil(n.length/o)-1);var s=e*o,h=e*o+o;h>n.length&&(h=n.length),(s=h-100)<0&&(s=0);for(var w=s;w<h;w++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[w]):obj.tbody.appendChild(obj.rows[n[w]]),obj.tbody.children.length>o&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var n=0;if(e.length>100){var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(o=e.indexOf(o)),o>0)for(var s=0;s<30;s++)(o-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[o],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[o]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),n=1))}return n},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var n=0;if(e.length>100){var o=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(o=e.indexOf(o)),o<obj.rows.length-1)for(var s=0;s<=30;s++)o<e.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[o]):obj.tbody.appendChild(obj.rows[e[o]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),n=1)),o+=1}return n},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,n=parseInt(obj.selectedCell[3]/100),o=parseInt(obj.rows.length/100);if(e!=n&&n<=o&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(n),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var n=function(s){obj.results.indexOf(s)==-1&&obj.results.push(s)},o=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");o=new RegExp(o,"i"),obj.options.data.forEach(function(s,h){if(function(g,D,H){for(var m=0;m<g.length;m++)if((""+g[m]).toLowerCase().search(D)>=0||(""+obj.records[H][m].innerHTML).toLowerCase().search(D)>=0)return!0;return!1}(s,o,h)){var w=obj.isRowMerged(h);if(w.length)for(var L=0;L<w.length;L++)for(var c=jexcel.getIdFromColumnName(w[L],!0),a=0;a<obj.options.mergeCells[w[L]][1];a++)n(c[1]+a);else n(h)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,n=0;for(e=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var o=0;o<obj.rows.length;o++)!obj.results||obj.results.indexOf(o)>-1?(n<e&&(obj.tbody.appendChild(obj.rows[o]),n++),obj.rows[o].style.display=""):obj.rows[o].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var n=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)o=obj.rows;else var o=obj.results;var s=parseInt(obj.options.pagination);e!=null&&e!=-1||(e=Math.ceil(o.length/s)-1),obj.pageNumber=e;var h=e*s,w=e*s+s;for(w>o.length&&(w=o.length),h<0&&(h=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var L=h;L<w;L++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[L]):obj.tbody.appendChild(obj.rows[o[L]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,n)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows.length;else var e=obj.results.length;if(e){var n=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var o=1,s=n<10?n:10;else n-obj.pageNumber<5?(s=n,(o=n-9)<1&&(o=1)):(o=obj.pageNumber-4,s=obj.pageNumber+5);o>1&&((w=document.createElement("div")).className="jexcel_page",w.innerHTML="<",w.title=1,obj.pagination.children[1].appendChild(w));for(var h=o;h<=s;h++){var w;(w=document.createElement("div")).className="jexcel_page",w.innerHTML=h,obj.pagination.children[1].appendChild(w),obj.pageNumber==h-1&&w.classList.add("jexcel_page_selected")}s<n&&((w=document.createElement("div")).className="jexcel_page",w.innerHTML=">",w.title=n,obj.pagination.children[1].appendChild(w)),obj.pagination.children[0].innerHTML=function(L){var c=Array.prototype.slice.call(arguments,1);return L.replace(/{(\d+)}/g,function(a,g){return c[g]!==void 0?c[g]:a})}(obj.options.text.showingPage,obj.pageNumber+1,n)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(obj.options.allowExport==0)console.error("Export not allowed");else{var n="";n+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var o=new Blob(["\uFEFF"+n],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,obj.options.csvFileName+".csv");else{var s=document.createElement("a"),h=URL.createObjectURL(o);s.href=h,s.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(s),s.click(),s.parentNode.removeChild(s)}}},obj.setHistory=function(e){if(obj.ignoreHistory!=1){var n=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,n+1),obj.history[n]=e}},obj.copy=function(e,n,o,s,h){n||(n="	");for(var w=new RegExp(n,"ig"),L=[],c=[],a=[],g=[],D=[],H=obj.options.data[0].length,m=obj.options.data.length,f="",j=!1,C="",b="",T=0,O=0,F=0,U=0,B=!0,I=0;I<m;I++)for(var P=0;P<H;P++)e&&!obj.records[I][P].classList.contains("highlight")||(F<=P&&(F=P),U<=I&&(U=I));if(H===F+1&&m===U+1&&(B=!1),h&&obj.options.includeHeadersOnDownload==1||!h&&obj.options.includeHeadersOnCopy==1&&!B||s){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(f=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],I=0;I<f.length;I++){var V=[];for(P=0;P<f[I].length;P++){var R=parseInt(f[I][P].colspan);V.push(f[I][P].title);for(var Q=0;Q<R-1;Q++)V.push("")}b+=V.join(n)+`\r
`}j=!0}for(obj.style=[],I=0;I<m;I++){for(c=[],a=[],P=0;P<H;P++)if(!e||obj.records[I][P].classList.contains("highlight")){j==1&&L.push(obj.headers[P].textContent);var de=obj.options.data[I][P];if(de.match&&(de.match(w)||de.match(/,/g)||de.match(/\n/)||de.match(/\"/))&&(de='"'+(de=de.replace(new RegExp('"',"g"),'""'))+'"'),c.push(de),obj.options.columns[P].type=="checkbox"||obj.options.columns[P].type=="radio")var oe=de;else(oe=obj.options.stripHTMLOnCopy==1?obj.records[I][P].textContent:obj.records[I][P].innerHTML).match&&(oe.match(w)||oe.match(/,/g)||oe.match(/\n/)||oe.match(/\"/))&&(oe='"'+(oe=oe.replace(new RegExp('"',"g"),'""'))+'"');a.push(oe),f=(f=obj.records[I][P].getAttribute("style")).replace("display: none;",""),obj.style.push(f||"")}c.length&&(j&&(T=c.length,g.push(L.join(n))),g.push(c.join(n))),a.length&&(O++,j&&(D.push(L.join(n)),j=!1),D.push(a.join(n)))}H==T&&m==O&&(C=b);var be=C+g.join(`\r
`),Ee=C+D.join(`\r
`);if(o||(obj.options.copyCompatibility==1?obj.textarea.value=Ee:obj.textarea.value=be,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Ee:obj.data=be,obj.hashString=obj.hash(obj.data),!o){if(obj.removeCopyingSelection(),obj.highlighted)for(P=0;P<obj.highlighted.length;P++)obj.highlighted[P].classList.add("copying"),obj.highlighted[P].classList.contains("highlight-left")&&obj.highlighted[P].classList.add("copying-left"),obj.highlighted[P].classList.contains("highlight-right")&&obj.highlighted[P].classList.add("copying-right"),obj.highlighted[P].classList.contains("highlight-top")&&obj.highlighted[P].classList.add("copying-top"),obj.highlighted[P].classList.contains("highlight-bottom")&&obj.highlighted[P].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?D:g,obj.hashString)}return obj.data},obj.paste=function(e,n,o){var s=obj.dispatch("onbeforepaste",el,o,e,n);if(s===!1)return!1;s&&(o=s);var h=obj.hash(o),w=h==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&h==obj.hashString&&(o=obj.data),o=obj.parseCSV(o,"	"),e!=null&&n!=null&&o){for(var L=0,c=0,a=[],g={},D={},H=0,m=parseInt(e),f=parseInt(n),j=null;j=o[c];){for(L=0,m=parseInt(e);j[L]!=null;){var C=obj.updateCell(m,f,j[L]);if(a.push(C),obj.updateFormulaChain(m,f,a),w&&w[H]){var b=jexcel.getColumnNameFromId([m,f]);g[b]=w[H],D[b]=obj.getStyle(b),obj.records[f][m].setAttribute("style",w[H]),H++}if(j[++L]!=null){if(m>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}m=obj.right.get(m,f)}}if(o[++c]){if(f>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}f=obj.down.get(e,f)}}obj.updateSelectionFromCoords(e,n,m,f),obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell,newStyle:g,oldStyle:D}),obj.updateTable(),obj.dispatch("onpaste",el,o),obj.onafterchanges(el,a)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),n=0;n<e.length;n++)e[n].classList.remove("copying"),e[n].classList.remove("copying-left"),e[n].classList.remove("copying-right"),e[n].classList.remove("copying-top"),e[n].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,n){var o=n.insertBefore?+n.rowNumber:n.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),e==1){for(var s=n.numOfRows,h=o;h<s+o;h++)obj.rows[h].parentNode.removeChild(obj.rows[h]);obj.records.splice(o,s),obj.options.data.splice(o,s),obj.rows.splice(o,s),obj.conditionalSelectionUpdate(1,o,s+o-1)}else{obj.records=jexcel.injectArray(obj.records,o,n.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,o,n.rowData),obj.rows=jexcel.injectArray(obj.rows,o,n.rowNode);var w=0;for(h=o;h<n.numOfRows+o;h++)obj.tbody.insertBefore(n.rowNode[w],obj.tbody.children[h]),w++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,n){var o=n.insertBefore?n.columnNumber:n.columnNumber+1;if(e==1){var s=n.numOfColumns;obj.options.columns.splice(o,s);for(var h=o;h<s+o;h++)obj.headers[h].parentNode.removeChild(obj.headers[h]),obj.colgroup[h].parentNode.removeChild(obj.colgroup[h]);obj.headers.splice(o,s),obj.colgroup.splice(o,s);for(var w=0;w<n.data.length;w++){for(h=o;h<s+o;h++)obj.records[w][h].parentNode.removeChild(obj.records[w][h]);obj.records[w].splice(o,s),obj.options.data[w].splice(o,s)}if(obj.options.footers)for(w=0;w<obj.options.footers.length;w++)obj.options.footers[w].splice(o,s)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,o,n.columns),obj.headers=jexcel.injectArray(obj.headers,o,n.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,o,n.colgroup);var L=0;for(h=o;h<n.numOfColumns+o;h++)obj.headerContainer.insertBefore(n.headers[L],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(n.colgroup[L],obj.colgroupContainer.children[h+1]),L++;for(w=0;w<n.data.length;w++)for(obj.options.data[w]=jexcel.injectArray(obj.options.data[w],o,n.data[w]),obj.records[w]=jexcel.injectArray(obj.records[w],o,n.records[w]),L=0,h=o;h<n.numOfColumns+o;h++)obj.rows[w].insertBefore(n.records[w][L],obj.rows[w].children[h+1]),L++;if(obj.options.footers)for(w=0;w<obj.options.footers.length;w++)obj.options.footers[w]=jexcel.injectArray(obj.options.footers[w],o,n.footers[w])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(w=0;w<obj.options.nestedHeaders.length;w++){if(e==1)var c=parseInt(obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan)-n.numOfColumns;else c=parseInt(obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan)+n.numOfColumns;obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan=c,obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("colspan",c)}else c=e==1?parseInt(obj.options.nestedHeaders[0].colspan)-n.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+n.numOfColumns,obj.options.nestedHeaders[0].colspan=c,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",c);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,n=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var o=[];if(obj.historyIndex>=0){var s=obj.history[obj.historyIndex--];if(s.action=="insertRow")obj.historyProcessRow(1,s);else if(s.action=="deleteRow")obj.historyProcessRow(0,s);else if(s.action=="insertColumn")obj.historyProcessColumn(1,s);else if(s.action=="deleteColumn")obj.historyProcessColumn(0,s);else if(s.action=="moveRow")obj.moveRow(s.newValue,s.oldValue);else if(s.action=="moveColumn")obj.moveColumn(s.newValue,s.oldValue);else if(s.action=="setMerge")obj.removeMerge(s.column,s.data);else if(s.action=="setStyle")obj.setStyle(s.oldValue,null,null,1);else if(s.action=="setWidth")obj.setWidth(s.column,s.oldValue);else if(s.action=="setHeight")obj.setHeight(s.row,s.oldValue);else if(s.action=="setHeader")obj.setHeader(s.column,s.oldValue);else if(s.action=="setComments")obj.setComments(s.column,s.oldValue[0],s.oldValue[1]);else if(s.action=="orderBy"){for(var h=[],w=0;w<s.rows.length;w++)h[s.rows[w]]=w;obj.updateOrderArrow(s.column,s.order?0:1),obj.updateOrder(h)}else if(s.action=="setValue"){for(var L=0;L<s.records.length;L++)o.push({x:s.records[L].x,y:s.records[L].y,newValue:s.records[L].oldValue}),s.oldStyle&&obj.resetStyle(s.oldStyle);obj.setValue(o),s.selection&&obj.updateSelectionFromCoords(s.selection[0],s.selection[1],s.selection[2],s.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=n,obj.dispatch("onundo",el,s)},obj.redo=function(){var e=!!obj.ignoreEvents,n=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var o=obj.history[++obj.historyIndex];if(o.action=="insertRow")obj.historyProcessRow(0,o);else if(o.action=="deleteRow")obj.historyProcessRow(1,o);else if(o.action=="insertColumn")obj.historyProcessColumn(0,o);else if(o.action=="deleteColumn")obj.historyProcessColumn(1,o);else if(o.action=="moveRow")obj.moveRow(o.oldValue,o.newValue);else if(o.action=="moveColumn")obj.moveColumn(o.oldValue,o.newValue);else if(o.action=="setMerge")obj.setMerge(o.column,o.colspan,o.rowspan,1);else if(o.action=="setStyle")obj.setStyle(o.newValue,null,null,1);else if(o.action=="setWidth")obj.setWidth(o.column,o.newValue);else if(o.action=="setHeight")obj.setHeight(o.row,o.newValue);else if(o.action=="setHeader")obj.setHeader(o.column,o.newValue);else if(o.action=="setComments")obj.setComments(o.column,o.newValue[0],o.newValue[1]);else if(o.action=="orderBy")obj.updateOrderArrow(o.column,o.order),obj.updateOrder(o.rows);else if(o.action=="setValue"){obj.setValue(o.records);for(var s=0;s<o.records.length;s++)o.oldStyle&&obj.resetStyle(o.newStyle);o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=n,obj.dispatch("onredo",el,o)},obj.getDropDownValue=function(e,n){var o=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var s=[],h=obj.options.columns[e].source,w=0;w<h.length;w++)typeof h[w]=="object"?s[h[w].id]=h[w].name:s[h[w]]=h[w];var L=Array.isArray(n)?n:(""+n).split(";");for(w=0;w<L.length;w++)typeof L[w]=="object"?o.push(s[L[w].id]):s[L[w]]&&o.push(s[L[w]])}else console.error("Invalid column");return o.length>0?o.join("; "):""},obj.parseCSV=function(e,n){(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)==9&&(e+="\0"),n=n||",";for(var o=[],s=!1,h=0,w=0,L=0;L<e.length;L++){var c=e[L],a=e[L+1];o[h]=o[h]||[],o[h][w]=o[h][w]||"",c=='"'&&s&&a=='"'?(o[h][w]+=c,++L):c!='"'?c!=n||s?c!="\r"||a!=`
`||s?c==`
`&&!s||c=="\r"&&!s?(++h,w=0):o[h][w]+=c:(++h,w=0,++L):++w:s=!s}return o},obj.hash=function(e){var n,o=0;if(e.length===0)return o;for(n=0;n<e.length;n++)o=(o<<5)-o+e.charCodeAt(n),o|=0;return o},obj.onafterchanges=function(e,n){obj.dispatch("onafterchanges",e,n)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var n=obj.parseCSV(e,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&n.length>0)for(var o=n.shift(),s=0;s<o.length;s++)obj.options.columns[s]||(obj.options.columns[s]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[s].title===void 0&&(obj.options.columns[s].title=o[s]);obj.options.data=n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,n,o,s){var h=[];if(o==null)obj.options.allowInsertColumn==1&&h.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(n),1)}}),obj.options.allowInsertColumn==1&&h.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(n),0)}}),obj.options.allowDeleteColumn==1&&h.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(n))}}),obj.options.allowRenameColumn==1&&h.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(n)}}),obj.options.columnSorting==1&&(h.push({type:"line"}),h.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(n,0)}}),h.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(n,1)}}));else if(obj.options.allowInsertRow==1&&(h.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(o),1)}}),h.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(o))}})),obj.options.allowDeleteRow==1&&h.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(o))}}),n&&obj.options.allowComments==1){h.push({type:"line"});var w=obj.records[o][n].getAttribute("title")||"";h.push({title:w?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var L=prompt(obj.options.text.comments,w);L&&obj.setComments([n,o],L)}}),w&&h.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([n,o],"")}})}return h.push({type:"line"}),h.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&h.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(L){L&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],L)})}}),obj.options.allowExport&&h.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&h.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),h},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&e.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var n=0;n<obj.options.freezeColumns;n++)e+=parseInt(obj.options.columns[n].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var n=0;n<obj.options.freezeColumns;n++){n>0&&obj.options.columns[n-1].type!=="hidden"&&(e+=parseInt(obj.options.columns[n-1].width)),obj.headers[n].classList.add("jexcel_freezed"),obj.headers[n].style.left=e+"px";for(var o=0;o<obj.rows.length;o++)if(obj.rows[o]&&obj.records[o][n]){var s=scrollLeft+(n>0?obj.records[o][n-1].style.width:0)-51+"px";obj.records[o][n].classList.add("jexcel_freezed"),obj.records[o][n].style.left=s}}else for(n=0;n<obj.options.freezeColumns;n++)for(obj.headers[n].classList.remove("jexcel_freezed"),obj.headers[n].style.left="",o=0;o<obj.rows.length;o++)obj.records[o][n]&&(obj.records[o][n].classList.remove("jexcel_freezed"),obj.records[o][n].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var n=Object.keys(e),o=0;o<n.length;o++)typeof e[n[o]]=="function"&&(jexcel[n[o]]=e[n[o]],jexcel.license&&typeof e[n[o]].license=="function"&&e[n[o]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(e,n){if(e.jexcel){var o=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",n&&(destroyEvents(o),jexcel=null)}},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(e.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(e.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var n=jexcel.current.edition[0].children[0],o=jexcel.current.edition[0].children[0].value,s=n.selectionStart;o=o.slice(0,s)+`
`+o.slice(s),n.value=o,n.focus(),n.selectionStart=s+1,n.selectionEnd=s+1}else jexcel.current.edition[0].children[0].blur()}else e.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(e.which==37)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==39)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==38)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==40)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==36)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==35)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(e.which==13)e.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(e.which==9)e.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var h=jexcel.current.selectedCell[1],w=jexcel.current.selectedCell[0];jexcel.current.options.columns[w].type!="readonly"&&(e.keyCode==32?(e.preventDefault(),jexcel.current.options.columns[w].type=="checkbox"||jexcel.current.options.columns[w].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[h][w],!0)):e.keyCode==113?jexcel.current.openEditor(jexcel.current.records[h][w],!1):(e.keyCode==8||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[h][w],!0),jexcel.current.options.columns[w].type=="calendar"&&e.preventDefault()))}}else e.which==65?(jexcel.current.selectAll(),e.preventDefault()):e.which==83?(jexcel.current.download(),e.preventDefault()):e.which==89?(jexcel.current.redo(),e.preventDefault()):e.which==90?(jexcel.current.undo(),e.preventDefault()):e.which==67?(jexcel.current.copy(!0),e.preventDefault()):e.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):e.which==86&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var n=e.buttons;else n=e.button?e.button:e.which;var o=jexcel.getElement(e.target);if(o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&n==1){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(o[1]==1){if(f=e.target.getAttribute("data-x")){var s=e.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&s.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:f,width:s.width},jexcel.current.headers[f].classList.add("resizing");for(var h=0;h<jexcel.current.records.length;h++)jexcel.current.records[h][f]&&jexcel.current.records[h][f].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&s.height-e.offsetY<6)if(jexcel.current.isColMerged(f).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:f,destination:f},jexcel.current.headers[f].classList.add("dragging"),h=0;h<jexcel.current.records.length;h++)jexcel.current.records[h][f]&&jexcel.current.records[h][f].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var w=jexcel.current.selectedHeader,L=f;else jexcel.current.selectedHeader==f&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(f)},800)),jexcel.current.selectedHeader=f,w=f,L=f;jexcel.current.updateSelectionFromCoords(w,0,L,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var c=e.target.getAttribute("data-column").split(","),a=parseInt(c[0]),g=parseInt(c[c.length-1]);else a=0,g=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(a,0,g,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(o[1]==2){var D=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))s=e.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&s.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:D,height:s.height},e.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&s.width-e.offsetX<6?jexcel.current.isRowMerged(D).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:D,destination:D},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(w=jexcel.current.selectedRow,L=D):(jexcel.current.selectedRow=D,w=D,L=D),jexcel.current.updateSelectionFromCoords(0,w,jexcel.current.options.data[0].length-1,L));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var H=function(j){var C=j.getAttribute("data-x"),b=j.getAttribute("data-y");return C&&b?[C,b]:j.parentNode?H(j.parentNode):void 0},m=H(e.target);if(m){var f=m[0];D=m[1],jexcel.current.edition&&(jexcel.current.edition[2]==f&&jexcel.current.edition[3]==D||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,D):jexcel.current.updateSelectionFromCoords(f,D)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&(e.target.textContent=="<"?jexcel.current.page(0):e.target.textContent==">"?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var n=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),o=jexcel.current.getSelectedColumns();if(o.length>1){for(var s=[],h=0;h<o.length;h++)s.push(parseInt(jexcel.current.colgroup[o[h]].getAttribute("width")));s[o.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(o,n,s)}else jexcel.current.setWidth(jexcel.current.resizing.column,n,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var w=0;w<jexcel.current.records.length;w++)jexcel.current.records[w][jexcel.current.resizing.column]&&jexcel.current.records[w][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var L=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,L,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var c=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),w=0;w<jexcel.current.rows.length;w++)jexcel.current.records[w][jexcel.current.dragging.column]&&jexcel.current.records[w][jexcel.current.dragging.column].classList.remove("dragging");for(h=0;h<jexcel.current.headers.length;h++)jexcel.current.headers[h].classList.remove("dragging-left"),jexcel.current.headers[h].classList.remove("dragging-right");c&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var a=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<a&&(a-=1)}else a=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,a,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var n=e.buttons;else n=e.button?e.button:e.which;if(n||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var o=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+o>0){var s=jexcel.current.resizing.width+o;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",s),jexcel.current.updateCornerPosition()}}else{var h=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+h>0){var w=jexcel.current.resizing.height+h;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",w),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var L=e.target.getAttribute("data-x");if(L)if(jexcel.current.isColMerged(L).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var c=0;c<jexcel.current.headers.length;c++)jexcel.current.headers[c].classList.remove("dragging-left"),jexcel.current.headers[c].classList.remove("dragging-right");jexcel.current.dragging.column==L?jexcel.current.dragging.destination=parseInt(L):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<L?jexcel.current.dragging.destination=parseInt(L)-1:jexcel.current.dragging.destination=parseInt(L),jexcel.current.headers[L].classList.add("dragging-left")):(jexcel.current.dragging.column<L?jexcel.current.dragging.destination=parseInt(L):jexcel.current.dragging.destination=parseInt(L)+1,jexcel.current.headers[L].classList.add("dragging-right"))}}else{var a=e.target.getAttribute("data-y");if(a)if(jexcel.current.isRowMerged(a).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var g=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=g&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,g),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var D=e.target.getAttribute("data-x"),H=e.target.getAttribute("data-y"),m=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&D&&!H&&m.width-(e.clientX-m.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!D&&H&&m.height-(e.clientY-m.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!D&&H&&m.width-(e.clientX-m.left)<6||e.target&&D&&!H&&m.height-(e.clientY-m.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var n=e.buttons;else n=e.button?e.button:e.which;if(n||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var o=jexcel.getElement(e.target);if(o[0]){if(jexcel.current!=o[0].jexcel&&jexcel.current)return!1;var s=e.target.getAttribute("data-x"),h=e.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(o[1]==1&&jexcel.current.selectedHeader){s=e.target.getAttribute("data-x");var w=jexcel.current.selectedHeader,L=s;jexcel.current.updateSelectionFromCoords(w,0,L,jexcel.current.options.data.length-1)}o[1]==2&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(w=jexcel.current.selectedRow,L=h,jexcel.current.updateSelectionFromCoords(0,w,jexcel.current.options.data[0].length-1,L)):jexcel.current.edition||s&&h&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(s,h):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],s,h)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var n=jexcel.current.highlighted[0].getAttribute("data-x"),o=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,s=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),h=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[o][n],jexcel.current.records[h][s])}}else if(e.target.classList.contains("jexcel_column_filter")){var w=e.target.getAttribute("data-x");jexcel.current.openFilter(w)}else{var L=jexcel.getElement(e.target);if(L[1]==1&&jexcel.current.options.columnSorting==1&&(w=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(w),L[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var c=function(g){if(g.parentNode){var D=g.getAttribute("data-x"),H=g.getAttribute("data-y");return D&&H?g:c(g.parentNode)}},a=c(e.target);a&&a.classList.contains("highlight")&&jexcel.current.openEditor(a)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current){if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var n=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");if(n||o){(n<parseInt(jexcel.current.selectedCell[0])||n>parseInt(jexcel.current.selectedCell[2])||o<parseInt(jexcel.current.selectedCell[1])||o>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(n,o,n,o);var s=jexcel.current.options.contextMenu(jexcel.current,n,o,e);jexcel.current.contextMenu.contextmenu.open(e,s),e.preventDefault()}}}},jexcel.touchStartControls=function(e){var n=jexcel.getElement(e.target);if(n[0]?jexcel.current!=n[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=n[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var o=e.target.getAttribute("data-x"),s=e.target.getAttribute("data-y");o&&s&&(jexcel.current.updateSelectionFromCoords(o,s),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[o].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,n){var o=[];if(e.classList.contains("jexcel_tabs"))h=e.children[0],w=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var s=document.createElement("div"),h=e.appendChild(s),w=(s=document.createElement("div"),e.appendChild(s))}for(var L=[],c=[],a=0;a<n.length;a++){L[a]=document.createElement("div"),L[a].classList.add("jexcel_tab");var g=jexcel(L[a],n[a]);w.appendChild(L[a]),o[a]=e.jexcel.push(g),c[a]=document.createElement("div"),c[a].classList.add("jexcel_tab_link"),c[a].setAttribute("data-spreadsheet",e.jexcel.length-1),c[a].innerHTML=n[a].sheetName,c[a].onclick=function(){for(var H=0;H<h.children.length;H++)h.children[H].classList.remove("selected"),w.children[H].style.display="none";var m=this.getAttribute("data-spreadsheet");w.children[m].style.display="block",h.children[m].classList.add("selected")},h.appendChild(c[a])}for(var D=0;D<h.children.length;D++)h.children[D].classList.remove("selected"),w.children[D].style.display="none";return h.children[h.children.length-1].classList.add("selected"),w.children[h.children.length-1].style.display="block",o},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,n){var o,s=function(h){var w=[];return h.SheetNames.forEach(function(L){var c={rows:[],columns:[],data:[],style:{}};if(c.sheetName=L,(b=h.Sheets[L]["!cols"])&&b.length)for(var a=0;a<b.length;a++)c.columns[a]={},b[a]&&b[a].wpx&&(c.columns[a].width=b[a].wpx+"px");if((b=h.Sheets[L]["!rows"])&&b.length)for(a=0;a<b.length;a++)b[a]&&b[a].hpx&&(c.rows[a]={},c.rows[a].height=b[a].hpx+"px");if((b=h.Sheets[L]["!merges"])&&b.length>0)for(c.mergeCells=[],a=0;a<b.length;a++){var g=b[a].s.c,D=b[a].s.r,H=b[a].e.c,m=b[a].e.r,f=jexcel.getColumnNameFromId([g,D]);c.mergeCells[f]=[H-g+1,m-D+1]}var j=0,C=0,b=Object.keys(h.Sheets[L]);for(a=0;a<b.length;a++)if(b[a].substr(0,1)!="!"){var T=h.Sheets[L][b[a]],O=jexcel.getIdFromColumnName(b[a],!0);c.data[O[1]]||(c.data[O[1]]=[]),c.data[O[1]][O[0]]=T.f?"="+T.f:T.w,j<O[0]&&(j=O[0]),C<O[1]&&(C=O[1]),T.style&&Object.keys(T.style).length>0&&(c.style[b[a]]=T.style),T.s&&T.s.fgColor&&(c.style[b[a]]&&(c.style[b[a]]+=";"),c.style[b[a]]+="background-color:#"+T.s.fgColor.rgb)}for(var F=c.columns,U=0;U<=C;U++)for(a=0;a<=j;a++)c.data[U]||(c.data[U]=[]),c.data[U][a]||F<a&&(c.data[U][a]="");w.push(c)}),w};(o=new XMLHttpRequest).open("GET",e,!0),typeof Uint8Array<"u"?(o.responseType="arraybuffer",o.onload=function(h){var w=o.response,L=new Uint8Array(w),c=XLSX.read(L,{type:"array",cellFormula:!0,cellStyles:!0});n(s(c))}):(o.setRequestHeader("Accept-Charset","x-user-defined"),o.onreadystatechange=function(){if(o.readyState==4&&o.status==200){var h=convertResponseBodyToText(o.responseBody),w=XLSX.read(h,{type:"binary",cellFormula:!0,cellStyles:!0});n(s(w))}}),o.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,n,o){return e.slice(0,n).concat(o).concat(e.slice(n))},jexcel.getColumnName=function(e){var n="";return e>701?(n+=String.fromCharCode(64+parseInt(e/676)),n+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(n+=String.fromCharCode(64+parseInt(e/26))),n+String.fromCharCode(65+e%26)},jexcel.getIdFromColumnName=function(e,n){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var s=0,h=0;h<o[0].length;h++)s+=parseInt(o[0].charCodeAt(h)-64)*Math.pow(26,o[0].length-1-h);--s<0&&(s=0);var w=parseInt(/[0-9]+$/.exec(e));w>0&&w--,e=n==1?[s,w]:s+"-"+w}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var n=0,o=0;return function s(h){h.className&&h.classList.contains("jexcel_container")&&(o=h),h.tagName=="THEAD"?n=1:h.tagName=="TBODY"&&(n=2),h.parentNode&&(o||s(h.parentNode))}(e),[o,n]},jexcel.doubleDigitFormat=function(e){return(e=""+e).length==1&&(e="0"+e),e},jexcel.createFromTable=function(e,n){if(e.tagName=="TABLE"){n||(n={}),n.columns=[],n.data=[];var o=e.querySelectorAll("colgroup > col");if(o.length)for(var s=0;s<o.length;s++){if(!(h=o[s].style.width))var h=o[s].getAttribute("width");h&&(n.columns[s]||(n.columns[s]={}),n.columns[s].width=h)}var w=function(be){var Ee=be.getBoundingClientRect(),ye=Ee.width>50?Ee.width:50;n.columns[s]||(n.columns[s]={}),be.getAttribute("data-celltype")?n.columns[s].type=be.getAttribute("data-celltype"):n.columns[s].type="text",n.columns[s].width=ye+"px",n.columns[s].title=be.innerHTML,n.columns[s].align=be.style.textAlign||"center",(Ee=be.getAttribute("name"))&&(n.columns[s].name=Ee),(Ee=be.getAttribute("id"))&&(n.columns[s].id=Ee),(Ee=be.getAttribute("data-mask"))&&(n.columns[s].mask=Ee)},L=[],c=e.querySelectorAll(":scope > thead > tr");if(c.length){for(var a=0;a<c.length-1;a++){var g=[];for(s=0;s<c[a].children.length;s++){var D={title:c[a].children[s].textContent,colspan:c[a].children[s].getAttribute("colspan")||1};g.push(D)}L.push(g)}for(c=c[c.length-1].children,s=0;s<c.length;s++)w(c[s])}var H=0,m={},f={},j={},C={},b=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(a=0;a<b.length;a++)if(n.data[H]=[],n.parseTableFirstRowAsHeader!=1||c.length||a!=0){for(s=0;s<b[a].children.length;s++){if(T=b[a].children[s].getAttribute("data-formula"))T.substr(0,1)!="="&&(T="="+T);else var T=b[a].children[s].innerHTML;n.data[H].push(T);var O=jexcel.getColumnNameFromId([s,a]),F=b[a].children[s].getAttribute("class");F&&(C[O]=F);var U=parseInt(b[a].children[s].getAttribute("colspan"))||0,B=parseInt(b[a].children[s].getAttribute("rowspan"))||0;(U||B)&&(m[O]=[U||1,B||1]),b[a].children[s].style&&b[a].children[s].style.display=="none"&&(b[a].children[s].style.display="");var I=b[a].children[s].getAttribute("style");I&&(j[O]=I),b[a].children[s].classList.contains("styleBold")&&(j[O]?j[O]+="; font-weight:bold;":j[O]="font-weight:bold;")}b[a].style&&b[a].style.height&&(f[a]={height:b[a].style.height}),H++}else for(s=0;s<b[a].children.length;s++)w(b[a].children[s]);if(Object.keys(L).length>0&&(n.nestedHeaders=L),Object.keys(j).length>0&&(n.style=j),Object.keys(m).length>0&&(n.mergeCells=m),Object.keys(f).length>0&&(n.rows=f),Object.keys(C).length>0&&(n.classes=C),(b=e.querySelectorAll("tfoot tr")).length){var P=[];for(a=0;a<b.length;a++){var V=[];for(s=0;s<b[a].children.length;s++)V.push(b[a].children[s].textContent);P.push(V)}Object.keys(P).length>0&&(n.footers=P)}if(n.parseTableAutoCellType==1){var R=[];for(s=0;s<n.columns.length;s++){var Q=!0,de=!0;for(R[s]=[],a=0;a<n.data.length;a++)T=n.data[a][s],R[s][T]||(R[s][T]=0),R[s][T]++,T.length>25&&(Q=!1),T.length==10&&T.substr(4,1)=="-"&&T.substr(7,1)=="-"||(de=!1);var oe=Object.keys(R[s]).length;de?n.columns[s].type="calendar":Q==1&&oe>1&&oe<=parseInt(.1*n.data.length)&&(n.columns[s].type="dropdown",n.columns[s].source=Object.keys(R[s]))}}return n}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var n=this.config.root;else n=window;var o=0,s=n.getSelection();if(s&&s.rangeCount!==0){var h=s.getRangeAt(0),w=h.cloneRange();w.selectNodeContents(e),w.setEnd(h.endContainer,h.endOffset),o=w.toString().length}return o},invert:function(e){for(var n=[],o=Object.keys(e),s=0;s<o.length;s++)n[e[o[s]]]=o[s];return n},getColumnName:function(e){var n="";return e>701?(n+=String.fromCharCode(64+parseInt(e/676)),n+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(n+=String.fromCharCode(64+parseInt(e/26))),n+String.fromCharCode(65+e%26)},getColumnNameFromCoords:function(e,n){return component.getColumnName(parseInt(e))+(parseInt(n)+1)},getCoordsFromColumnName:function(e){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var o=0,s=0;s<n[0].length;s++)o+=parseInt(n[0].charCodeAt(s)-64)*Math.pow(26,n[0].length-1-s);--o<0&&(o=0);var h=parseInt(/[0-9]+$/.exec(e))||null;return h>0&&h--,[o,h]}},createFromTable:function(){},injectArray:function(e,n,o){return e.slice(0,n).concat(o).concat(e.slice(n))},parseCSV:function(e,n){n=n||",";for(var o=0,s=0,h=[[]],w=0,L=null,c=!1,a=!1,g=0;g<e.length;g++)if(h[s]||(h[s]=[]),h[s][o]||(h[s][o]=""),e[g]!="\r")if(e[g]!=`
`&&e[g]!=n||c!=0&&a!=1&&L){if(e[g]=='"'&&(c=!c),L===null){if((L=c)==1)continue}else if(L===!0&&!a&&e[g]=='"'){e[g+1]=='"'?(c=!0,h[s][o]+=e[g],g++):a=!0;continue}h[s][o]+=e[g]}else{if(L=null,c=!1,a=!1,h[s][o][0]=='"'){var D=h[s][o].trim();D[D.length-1]=='"'&&(h[s][o]=D.substr(1,D.length-2))}e[g]==`
`?(o=0,s++):++o>w&&(w=o)}for(var H=0;H<h.length;H++)for(g=0;g<=w;g++)h[H][g]===void 0&&(h[H][g]="");return h}},component),typeof jQuery<"u"&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(n){var o=e(this).get(0);return o.jexcel?Array.isArray(o.jexcel)?o.jexcel[n][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):o.jexcel[n].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(n!==void 0)return n.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.exports}var __webpack_exports__=__webpack_require__(138);return __webpack_exports__}()})})(dist);var distExports=dist.exports;const jspreadsheet=getDefaultExportFromCjs(distExports),_hoisted_1=createBaseVNode("h2",null,"jSpreadsheet ",-1),_sfc_main$1=defineComponent({__name:"JspreadsheetTest",props:{data:{type:Array,required:!0},columns:{type:Array,required:!0}},setup(e){const n=ref(null),o=ref(null),s=e;return onMounted(()=>{n.value&&(o.value=jspreadsheet(n.value,{data:s.data,columns:s.columns}))}),(h,w)=>(openBlock(),createElementBlock(Fragment,null,[_hoisted_1,createBaseVNode("div",{id:"jss-sample",ref_key:"jssRef",ref:n},null,512)],64))}});var papaparse_min={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,n){(function(o,s){e.exports=s()})(commonjsGlobal,function o(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},h=!s.document&&!!s.postMessage,w=s.IS_PAPA_WORKER||!1,L={},c=0,a={parse:function(V,R){var Q=(R=R||{}).dynamicTyping||!1;if(P(Q)&&(R.dynamicTypingFunction=Q,Q={}),R.dynamicTyping=Q,R.transform=!!P(R.transform)&&R.transform,R.worker&&a.WORKERS_SUPPORTED){var de=function(){if(!a.WORKERS_SUPPORTED)return!1;var be=(ye=s.URL||s.webkitURL||null,se=o.toString(),a.BLOB_URL||(a.BLOB_URL=ye.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",se,")();"],{type:"text/javascript"})))),Ee=new s.Worker(be),ye,se;return Ee.onmessage=O,Ee.id=c++,L[Ee.id]=Ee}();return de.userStep=R.step,de.userChunk=R.chunk,de.userComplete=R.complete,de.userError=R.error,R.step=P(R.step),R.chunk=P(R.chunk),R.complete=P(R.complete),R.error=P(R.error),delete R.worker,void de.postMessage({input:V,config:R,workerId:de.id})}var oe=null;return a.NODE_STREAM_INPUT,typeof V=="string"?(V=function(be){return be.charCodeAt(0)===65279?be.slice(1):be}(V),oe=R.download?new H(R):new f(R)):V.readable===!0&&P(V.read)&&P(V.on)?oe=new j(R):(s.File&&V instanceof File||V instanceof Object)&&(oe=new m(R)),oe.stream(V)},unparse:function(V,R){var Q=!1,de=!0,oe=",",be=`\r
`,Ee='"',ye=Ee+Ee,se=!1,we=null,qe=!1;(function(){if(typeof R=="object"){if(typeof R.delimiter!="string"||a.BAD_DELIMITERS.filter(function(z){return R.delimiter.indexOf(z)!==-1}).length||(oe=R.delimiter),(typeof R.quotes=="boolean"||typeof R.quotes=="function"||Array.isArray(R.quotes))&&(Q=R.quotes),typeof R.skipEmptyLines!="boolean"&&typeof R.skipEmptyLines!="string"||(se=R.skipEmptyLines),typeof R.newline=="string"&&(be=R.newline),typeof R.quoteChar=="string"&&(Ee=R.quoteChar),typeof R.header=="boolean"&&(de=R.header),Array.isArray(R.columns)){if(R.columns.length===0)throw new Error("Option columns is empty");we=R.columns}R.escapeChar!==void 0&&(ye=R.escapeChar+Ee),(typeof R.escapeFormulae=="boolean"||R.escapeFormulae instanceof RegExp)&&(qe=R.escapeFormulae instanceof RegExp?R.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var _e=new RegExp(b(Ee),"g");if(typeof V=="string"&&(V=JSON.parse(V)),Array.isArray(V)){if(!V.length||Array.isArray(V[0]))return Xe(null,V,se);if(typeof V[0]=="object")return Xe(we||Object.keys(V[0]),V,se)}else if(typeof V=="object")return typeof V.data=="string"&&(V.data=JSON.parse(V.data)),Array.isArray(V.data)&&(V.fields||(V.fields=V.meta&&V.meta.fields||we),V.fields||(V.fields=Array.isArray(V.data[0])?V.fields:typeof V.data[0]=="object"?Object.keys(V.data[0]):[]),Array.isArray(V.data[0])||typeof V.data[0]=="object"||(V.data=[V.data])),Xe(V.fields||[],V.data||[],se);throw new Error("Unable to serialize unrecognized input");function Xe(z,Le,Qe){var ft="";typeof z=="string"&&(z=JSON.parse(z)),typeof Le=="string"&&(Le=JSON.parse(Le));var Ie=Array.isArray(z)&&0<z.length,Oe=!Array.isArray(Le[0]);if(Ie&&de){for(var Ye=0;Ye<z.length;Ye++)0<Ye&&(ft+=oe),ft+=at(z[Ye],Ye);0<Le.length&&(ft+=be)}for(var Fe=0;Fe<Le.length;Fe++){var Ke=Ie?z.length:Le[Fe].length,tt=!1,ct=Ie?Object.keys(Le[Fe]).length===0:Le[Fe].length===0;if(Qe&&!Ie&&(tt=Qe==="greedy"?Le[Fe].join("").trim()==="":Le[Fe].length===1&&Le[Fe][0].length===0),Qe==="greedy"&&Ie){for(var te=[],ce=0;ce<Ke;ce++){var ve=Oe?z[ce]:ce;te.push(Le[Fe][ve])}tt=te.join("").trim()===""}if(!tt){for(var Ce=0;Ce<Ke;Ce++){0<Ce&&!ct&&(ft+=oe);var Se=Ie&&Oe?z[Ce]:Ce;ft+=at(Le[Fe][Se],Ce)}Fe<Le.length-1&&(!Qe||0<Ke&&!ct)&&(ft+=be)}}return ft}function at(z,Le){if(z==null)return"";if(z.constructor===Date)return JSON.stringify(z).slice(1,25);var Qe=!1;qe&&typeof z=="string"&&qe.test(z)&&(z="'"+z,Qe=!0);var ft=z.toString().replace(_e,ye);return(Qe=Qe||Q===!0||typeof Q=="function"&&Q(z,Le)||Array.isArray(Q)&&Q[Le]||function(Ie,Oe){for(var Ye=0;Ye<Oe.length;Ye++)if(-1<Ie.indexOf(Oe[Ye]))return!0;return!1}(ft,a.BAD_DELIMITERS)||-1<ft.indexOf(oe)||ft.charAt(0)===" "||ft.charAt(ft.length-1)===" ")?Ee+ft+Ee:ft}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!h&&!!s.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=T,a.ParserHandle=C,a.NetworkStreamer=H,a.FileStreamer=m,a.StringStreamer=f,a.ReadableStreamStreamer=j,s.jQuery){var g=s.jQuery;g.fn.parse=function(V){var R=V.config||{},Q=[];return this.each(function(be){if(!(g(this).prop("tagName").toUpperCase()==="INPUT"&&g(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var Ee=0;Ee<this.files.length;Ee++)Q.push({file:this.files[Ee],inputElem:this,instanceConfig:g.extend({},R)})}),de(),this;function de(){if(Q.length!==0){var be,Ee,ye,se,we=Q[0];if(P(V.before)){var qe=V.before(we.file,we.inputElem);if(typeof qe=="object"){if(qe.action==="abort")return be="AbortError",Ee=we.file,ye=we.inputElem,se=qe.reason,void(P(V.error)&&V.error({name:be},Ee,ye,se));if(qe.action==="skip")return void oe();typeof qe.config=="object"&&(we.instanceConfig=g.extend(we.instanceConfig,qe.config))}else if(qe==="skip")return void oe()}var _e=we.instanceConfig.complete;we.instanceConfig.complete=function(Xe){P(_e)&&_e(Xe,we.file,we.inputElem),oe()},a.parse(we.file,we.instanceConfig)}else P(V.complete)&&V.complete()}function oe(){Q.splice(0,1),de()}}}function D(V){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(R){var Q=B(R);Q.chunkSize=parseInt(Q.chunkSize),R.step||R.chunk||(Q.chunkSize=null),this._handle=new C(Q),(this._handle.streamer=this)._config=Q}).call(this,V),this.parseChunk=function(R,Q){if(this.isFirstChunk&&P(this._config.beforeFirstChunk)){var de=this._config.beforeFirstChunk(R);de!==void 0&&(R=de)}this.isFirstChunk=!1,this._halted=!1;var oe=this._partialLine+R;this._partialLine="";var be=this._handle.parse(oe,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Ee=be.meta.cursor;this._finished||(this._partialLine=oe.substring(Ee-this._baseIndex),this._baseIndex=Ee),be&&be.data&&(this._rowCount+=be.data.length);var ye=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(w)s.postMessage({results:be,workerId:a.WORKER_ID,finished:ye});else if(P(this._config.chunk)&&!Q){if(this._config.chunk(be,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);be=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(be.data),this._completeResults.errors=this._completeResults.errors.concat(be.errors),this._completeResults.meta=be.meta),this._completed||!ye||!P(this._config.complete)||be&&be.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ye||be&&be.meta.paused||this._nextChunk(),be}this._halted=!0},this._sendError=function(R){P(this._config.error)?this._config.error(R):w&&this._config.error&&s.postMessage({workerId:a.WORKER_ID,error:R,finished:!1})}}function H(V){var R;(V=V||{}).chunkSize||(V.chunkSize=a.RemoteChunkSize),D.call(this,V),this._nextChunk=h?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Q){this._input=Q,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(R=new XMLHttpRequest,this._config.withCredentials&&(R.withCredentials=this._config.withCredentials),h||(R.onload=I(this._chunkLoaded,this),R.onerror=I(this._chunkError,this)),R.open(this._config.downloadRequestBody?"POST":"GET",this._input,!h),this._config.downloadRequestHeaders){var Q=this._config.downloadRequestHeaders;for(var de in Q)R.setRequestHeader(de,Q[de])}if(this._config.chunkSize){var oe=this._start+this._config.chunkSize-1;R.setRequestHeader("Range","bytes="+this._start+"-"+oe)}try{R.send(this._config.downloadRequestBody)}catch(be){this._chunkError(be.message)}h&&R.status===0&&this._chunkError()}},this._chunkLoaded=function(){R.readyState===4&&(R.status<200||400<=R.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:R.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(Q){var de=Q.getResponseHeader("Content-Range");return de===null?-1:parseInt(de.substring(de.lastIndexOf("/")+1))}(R),this.parseChunk(R.responseText)))},this._chunkError=function(Q){var de=R.statusText||Q;this._sendError(new Error(de))}}function m(V){var R,Q;(V=V||{}).chunkSize||(V.chunkSize=a.LocalChunkSize),D.call(this,V);var de=typeof FileReader<"u";this.stream=function(oe){this._input=oe,Q=oe.slice||oe.webkitSlice||oe.mozSlice,de?((R=new FileReader).onload=I(this._chunkLoaded,this),R.onerror=I(this._chunkError,this)):R=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var oe=this._input;if(this._config.chunkSize){var be=Math.min(this._start+this._config.chunkSize,this._input.size);oe=Q.call(oe,this._start,be)}var Ee=R.readAsText(oe,this._config.encoding);de||this._chunkLoaded({target:{result:Ee}})},this._chunkLoaded=function(oe){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(oe.target.result)},this._chunkError=function(){this._sendError(R.error)}}function f(V){var R;D.call(this,V=V||{}),this.stream=function(Q){return R=Q,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var Q,de=this._config.chunkSize;return de?(Q=R.substring(0,de),R=R.substring(de)):(Q=R,R=""),this._finished=!R,this.parseChunk(Q)}}}function j(V){D.call(this,V=V||{});var R=[],Q=!0,de=!1;this.pause=function(){D.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){D.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(oe){this._input=oe,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){de&&R.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),R.length?this.parseChunk(R.shift()):Q=!0},this._streamData=I(function(oe){try{R.push(typeof oe=="string"?oe:oe.toString(this._config.encoding)),Q&&(Q=!1,this._checkIsFinished(),this.parseChunk(R.shift()))}catch(be){this._streamError(be)}},this),this._streamError=I(function(oe){this._streamCleanUp(),this._sendError(oe)},this),this._streamEnd=I(function(){this._streamCleanUp(),de=!0,this._streamData("")},this),this._streamCleanUp=I(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function C(V){var R,Q,de,oe=Math.pow(2,53),be=-oe,Ee=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ye=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,se=this,we=0,qe=0,_e=!1,Xe=!1,at=[],z={data:[],errors:[],meta:{}};if(P(V.step)){var Le=V.step;V.step=function(Fe){if(z=Fe,Ie())ft();else{if(ft(),z.data.length===0)return;we+=Fe.data.length,V.preview&&we>V.preview?Q.abort():(z.data=z.data[0],Le(z,se))}}}function Qe(Fe){return V.skipEmptyLines==="greedy"?Fe.join("").trim()==="":Fe.length===1&&Fe[0].length===0}function ft(){return z&&de&&(Ye("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),de=!1),V.skipEmptyLines&&(z.data=z.data.filter(function(Fe){return!Qe(Fe)})),Ie()&&function(){if(!z)return;function Fe(tt,ct){P(V.transformHeader)&&(tt=V.transformHeader(tt,ct)),at.push(tt)}if(Array.isArray(z.data[0])){for(var Ke=0;Ie()&&Ke<z.data.length;Ke++)z.data[Ke].forEach(Fe);z.data.splice(0,1)}else z.data.forEach(Fe)}(),function(){if(!z||!V.header&&!V.dynamicTyping&&!V.transform)return z;function Fe(tt,ct){var te,ce=V.header?{}:[];for(te=0;te<tt.length;te++){var ve=te,Ce=tt[te];V.header&&(ve=te>=at.length?"__parsed_extra":at[te]),V.transform&&(Ce=V.transform(Ce,ve)),Ce=Oe(ve,Ce),ve==="__parsed_extra"?(ce[ve]=ce[ve]||[],ce[ve].push(Ce)):ce[ve]=Ce}return V.header&&(te>at.length?Ye("FieldMismatch","TooManyFields","Too many fields: expected "+at.length+" fields but parsed "+te,qe+ct):te<at.length&&Ye("FieldMismatch","TooFewFields","Too few fields: expected "+at.length+" fields but parsed "+te,qe+ct)),ce}var Ke=1;return!z.data.length||Array.isArray(z.data[0])?(z.data=z.data.map(Fe),Ke=z.data.length):z.data=Fe(z.data,0),V.header&&z.meta&&(z.meta.fields=at),qe+=Ke,z}()}function Ie(){return V.header&&at.length===0}function Oe(Fe,Ke){return tt=Fe,V.dynamicTypingFunction&&V.dynamicTyping[tt]===void 0&&(V.dynamicTyping[tt]=V.dynamicTypingFunction(tt)),(V.dynamicTyping[tt]||V.dynamicTyping)===!0?Ke==="true"||Ke==="TRUE"||Ke!=="false"&&Ke!=="FALSE"&&(function(ct){if(Ee.test(ct)){var te=parseFloat(ct);if(be<te&&te<oe)return!0}return!1}(Ke)?parseFloat(Ke):ye.test(Ke)?new Date(Ke):Ke===""?null:Ke):Ke;var tt}function Ye(Fe,Ke,tt,ct){var te={type:Fe,code:Ke,message:tt};ct!==void 0&&(te.row=ct),z.errors.push(te)}this.parse=function(Fe,Ke,tt){var ct=V.quoteChar||'"';if(V.newline||(V.newline=function(ve,Ce){ve=ve.substring(0,1048576);var Se=new RegExp(b(Ce)+"([^]*?)"+b(Ce),"gm"),Be=(ve=ve.replace(Se,"")).split("\r"),Pe=ve.split(`
`),Ve=1<Pe.length&&Pe[0].length<Be[0].length;if(Be.length===1||Ve)return`
`;for(var Ue=0,E=0;E<Be.length;E++)Be[E][0]===`
`&&Ue++;return Ue>=Be.length/2?`\r
`:"\r"}(Fe,ct)),de=!1,V.delimiter)P(V.delimiter)&&(V.delimiter=V.delimiter(Fe),z.meta.delimiter=V.delimiter);else{var te=function(ve,Ce,Se,Be,Pe){var Ve,Ue,E,M;Pe=Pe||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<Pe.length;d++){var l=Pe[d],_=0,G=0,ne=0;E=void 0;for(var k=new T({comments:Be,delimiter:l,newline:Ce,preview:10}).parse(ve),S=0;S<k.data.length;S++)if(Se&&Qe(k.data[S]))ne++;else{var Y=k.data[S].length;G+=Y,E!==void 0?0<Y&&(_+=Math.abs(Y-E),E=Y):E=Y}0<k.data.length&&(G/=k.data.length-ne),(Ue===void 0||_<=Ue)&&(M===void 0||M<G)&&1.99<G&&(Ue=_,Ve=l,M=G)}return{successful:!!(V.delimiter=Ve),bestDelimiter:Ve}}(Fe,V.newline,V.skipEmptyLines,V.comments,V.delimitersToGuess);te.successful?V.delimiter=te.bestDelimiter:(de=!0,V.delimiter=a.DefaultDelimiter),z.meta.delimiter=V.delimiter}var ce=B(V);return V.preview&&V.header&&ce.preview++,R=Fe,Q=new T(ce),z=Q.parse(R,Ke,tt),ft(),_e?{meta:{paused:!0}}:z||{meta:{paused:!1}}},this.paused=function(){return _e},this.pause=function(){_e=!0,Q.abort(),R=P(V.chunk)?"":R.substring(Q.getCharIndex())},this.resume=function(){se.streamer._halted?(_e=!1,se.streamer.parseChunk(R,!0)):setTimeout(se.resume,3)},this.aborted=function(){return Xe},this.abort=function(){Xe=!0,Q.abort(),z.meta.aborted=!0,P(V.complete)&&V.complete(z),R=""}}function b(V){return V.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T(V){var R,Q=(V=V||{}).delimiter,de=V.newline,oe=V.comments,be=V.step,Ee=V.preview,ye=V.fastMode,se=R=V.quoteChar===void 0||V.quoteChar===null?'"':V.quoteChar;if(V.escapeChar!==void 0&&(se=V.escapeChar),(typeof Q!="string"||-1<a.BAD_DELIMITERS.indexOf(Q))&&(Q=","),oe===Q)throw new Error("Comment character same as delimiter");oe===!0?oe="#":(typeof oe!="string"||-1<a.BAD_DELIMITERS.indexOf(oe))&&(oe=!1),de!==`
`&&de!=="\r"&&de!==`\r
`&&(de=`
`);var we=0,qe=!1;this.parse=function(_e,Xe,at){if(typeof _e!="string")throw new Error("Input must be a string");var z=_e.length,Le=Q.length,Qe=de.length,ft=oe.length,Ie=P(be),Oe=[],Ye=[],Fe=[],Ke=we=0;if(!_e)return J();if(V.header&&!Xe){var tt=_e.split(de)[0].split(Q),ct=[],te={},ce=!1;for(var ve in tt){var Ce=tt[ve];P(V.transformHeader)&&(Ce=V.transformHeader(Ce,ve));var Se=Ce,Be=te[Ce]||0;for(0<Be&&(ce=!0,Se=Ce+"_"+Be),te[Ce]=Be+1;ct.includes(Se);)Se=Se+"_"+Be;ct.push(Se)}if(ce){var Pe=_e.split(de);Pe[0]=ct.join(Q),_e=Pe.join(de)}}if(ye||ye!==!1&&_e.indexOf(R)===-1){for(var Ve=_e.split(de),Ue=0;Ue<Ve.length;Ue++){if(Fe=Ve[Ue],we+=Fe.length,Ue!==Ve.length-1)we+=de.length;else if(at)return J();if(!oe||Fe.substring(0,ft)!==oe){if(Ie){if(Oe=[],ne(Fe.split(Q)),ie(),qe)return J()}else ne(Fe.split(Q));if(Ee&&Ee<=Ue)return Oe=Oe.slice(0,Ee),J(!0)}}return J()}for(var E=_e.indexOf(Q,we),M=_e.indexOf(de,we),d=new RegExp(b(se)+b(R),"g"),l=_e.indexOf(R,we);;)if(_e[we]!==R)if(oe&&Fe.length===0&&_e.substring(we,we+ft)===oe){if(M===-1)return J();we=M+Qe,M=_e.indexOf(de,we),E=_e.indexOf(Q,we)}else if(E!==-1&&(E<M||M===-1))Fe.push(_e.substring(we,E)),we=E+Le,E=_e.indexOf(Q,we);else{if(M===-1)break;if(Fe.push(_e.substring(we,M)),Y(M+Qe),Ie&&(ie(),qe))return J();if(Ee&&Oe.length>=Ee)return J(!0)}else for(l=we,we++;;){if((l=_e.indexOf(R,l+1))===-1)return at||Ye.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Oe.length,index:we}),S();if(l===z-1)return S(_e.substring(we,l).replace(d,R));if(R!==se||_e[l+1]!==se){if(R===se||l===0||_e[l-1]!==se){E!==-1&&E<l+1&&(E=_e.indexOf(Q,l+1)),M!==-1&&M<l+1&&(M=_e.indexOf(de,l+1));var _=k(M===-1?E:Math.min(E,M));if(_e.substr(l+1+_,Le)===Q){Fe.push(_e.substring(we,l).replace(d,R)),_e[we=l+1+_+Le]!==R&&(l=_e.indexOf(R,we)),E=_e.indexOf(Q,we),M=_e.indexOf(de,we);break}var G=k(M);if(_e.substring(l+1+G,l+1+G+Qe)===de){if(Fe.push(_e.substring(we,l).replace(d,R)),Y(l+1+G+Qe),E=_e.indexOf(Q,we),l=_e.indexOf(R,we),Ie&&(ie(),qe))return J();if(Ee&&Oe.length>=Ee)return J(!0);break}Ye.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Oe.length,index:we}),l++}}else l++}return S();function ne(xe){Oe.push(xe),Ke=we}function k(xe){var ge=0;if(xe!==-1){var fe=_e.substring(l+1,xe);fe&&fe.trim()===""&&(ge=fe.length)}return ge}function S(xe){return at||(xe===void 0&&(xe=_e.substring(we)),Fe.push(xe),we=z,ne(Fe),Ie&&ie()),J()}function Y(xe){we=xe,ne(Fe),Fe=[],M=_e.indexOf(de,we)}function J(xe){return{data:Oe,errors:Ye,meta:{delimiter:Q,linebreak:de,aborted:qe,truncated:!!xe,cursor:Ke+(Xe||0)}}}function ie(){be(J()),Oe=[],Ye=[]}},this.abort=function(){qe=!0},this.getCharIndex=function(){return we}}function O(V){var R=V.data,Q=L[R.workerId],de=!1;if(R.error)Q.userError(R.error,R.file);else if(R.results&&R.results.data){var oe={abort:function(){de=!0,F(R.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:U,resume:U};if(P(Q.userStep)){for(var be=0;be<R.results.data.length&&(Q.userStep({data:R.results.data[be],errors:R.results.errors,meta:R.results.meta},oe),!de);be++);delete R.results}else P(Q.userChunk)&&(Q.userChunk(R.results,oe,R.file),delete R.results)}R.finished&&!de&&F(R.workerId,R.results)}function F(V,R){var Q=L[V];P(Q.userComplete)&&Q.userComplete(R),Q.terminate(),delete L[V]}function U(){throw new Error("Not implemented.")}function B(V){if(typeof V!="object"||V===null)return V;var R=Array.isArray(V)?[]:{};for(var Q in V)R[Q]=B(V[Q]);return R}function I(V,R){return function(){V.apply(R,arguments)}}function P(V){return typeof V=="function"}return w&&(s.onmessage=function(V){var R=V.data;if(a.WORKER_ID===void 0&&R&&(a.WORKER_ID=R.workerId),typeof R.input=="string")s.postMessage({workerId:a.WORKER_ID,results:a.parse(R.input,R.config),finished:!0});else if(s.File&&R.input instanceof File||R.input instanceof Object){var Q=a.parse(R.input,R.config);Q&&s.postMessage({workerId:a.WORKER_ID,results:Q,finished:!0})}}),(H.prototype=Object.create(D.prototype)).constructor=H,(m.prototype=Object.create(D.prototype)).constructor=m,(f.prototype=Object.create(f.prototype)).constructor=f,(j.prototype=Object.create(D.prototype)).constructor=j,a})})(papaparse_min);var papaparse_minExports=papaparse_min.exports;const parseCSV=async(e,n="utf-8")=>{const s=await(await fetch(e)).arrayBuffer(),w=new TextDecoder(n).decode(s);return papaparse_minExports.parse(w,{header:!1}).data},csvPath="sample/13TOKYO.CSV",getData=async()=>{let e=[];try{e=await parseCSV(csvPath,"shift-jis")}catch(n){console.error(n)}return e},columns=[{type:"numeric",title:""},{type:"numeric",title:"5"},{type:"numeric",title:"7"},{type:"text",title:""},{type:"text",title:""},{type:"text",title:""},{type:"text",title:""},{type:"text",title:""},{type:"text",title:""},{type:"numeric",title:""},{type:"numeric",title:""},{type:"numeric",title:""},{type:"numeric",title:""},{type:"numeric",title:""},{type:"numeric",title:""}],_sfc_main={__name:"App",setup(e){const n=ref([]),o=ref(columns);return onMounted(async()=>{n.value=await getData()}),(s,h)=>(openBlock(),createBlock(_sfc_main$1,{data:n.value,columns:o.value},null,8,["data","columns"]))}};createApp(_sfc_main).mount("#app");
